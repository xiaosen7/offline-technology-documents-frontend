{"pageProps":{"toc":"[{\"url\":\"#\",\"text\":\"æ¦‚è§ˆ\",\"depth\":2},{\"url\":\"#choosing-between-event-handlers-and-effects\",\"depth\":2,\"text\":\"åœ¨äº‹ä»¶å¤„ç†å‡½æ•°å’Œ Effect ä¸­åšé€‰æ‹© \"},{\"url\":\"#event-handlers-run-in-response-to-specific-interactions\",\"depth\":3,\"text\":\"äº‹ä»¶å¤„ç†å‡½æ•°åªåœ¨å“åº”ç‰¹å®šçš„äº¤äº’æ“ä½œæ—¶è¿è¡Œ \"},{\"url\":\"#effects-run-whenever-synchronization-is-needed\",\"depth\":3,\"text\":\"æ¯å½“éœ€è¦åŒæ­¥ï¼ŒEffect å°±ä¼šè¿è¡Œ \"},{\"url\":\"#reactive-values-and-reactive-logic\",\"depth\":2,\"text\":\"å“åº”å¼å€¼å’Œå“åº”å¼é€»è¾‘ \"},{\"url\":\"#logic-inside-event-handlers-is-not-reactive\",\"depth\":3,\"text\":\"äº‹ä»¶å¤„ç†å‡½æ•°å†…éƒ¨çš„é€»è¾‘æ˜¯éå“åº”å¼çš„ \"},{\"url\":\"#logic-inside-effects-is-reactive\",\"depth\":3,\"text\":\"Effect å†…éƒ¨çš„é€»è¾‘æ˜¯å“åº”å¼çš„ \"},{\"url\":\"#extracting-non-reactive-logic-out-of-effects\",\"depth\":2,\"text\":\"ä» Effect ä¸­æå–éå“åº”å¼é€»è¾‘ \"},{\"url\":\"#declaring-an-effect-event\",\"depth\":3,\"text\":\"å£°æ˜ä¸€ä¸ª Effect Event \"},{\"url\":\"#reading-latest-props-and-state-with-effect-events\",\"depth\":3,\"text\":\"ä½¿ç”¨ Effect Event è¯»å–æœ€æ–°çš„ props å’Œ state \"},{\"url\":\"#limitations-of-effect-events\",\"depth\":3,\"text\":\"Effect Event çš„å±€é™æ€§ \"},{\"url\":\"#recap\",\"depth\":2,\"text\":\"Recap\"},{\"url\":\"#challenges\",\"depth\":2,\"text\":\"Challenges\"}]","content":"[[\"$r\",\"MaxWidth\",\"32\",{\"children\":[[\"$r\",\"Intro\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":\"äº‹ä»¶å¤„ç†å‡½æ•°åªæœ‰åœ¨ä½ å†æ¬¡æ‰§è¡ŒåŒæ ·çš„äº¤äº’æ—¶æ‰ä¼šé‡æ–°è¿è¡Œã€‚Effect å’Œäº‹ä»¶å¤„ç†å‡½æ•°ä¸ä¸€æ ·ï¼Œå®ƒåªæœ‰åœ¨è¯»å–çš„ props æˆ– state å€¼å’Œä¸Šä¸€æ¬¡æ¸²æŸ“ä¸ä¸€æ ·æ—¶æ‰ä¼šé‡æ–°åŒæ­¥ã€‚æœ‰æ—¶ä½ éœ€è¦è¿™ä¸¤ç§è¡Œä¸ºçš„æ··åˆä½“ï¼šå³ä¸€ä¸ª Effect åªåœ¨å“åº”æŸäº›å€¼æ—¶é‡æ–°è¿è¡Œï¼Œä½†æ˜¯åœ¨å…¶ä»–å€¼å˜åŒ–æ—¶ä¸é‡æ–°è¿è¡Œã€‚æœ¬ç« å°†ä¼šæ•™ä½ æ€ä¹ˆå®ç°è¿™ä¸€ç‚¹ã€‚\"}]}],\"\\n\",[\"$r\",\"YouWillLearn\",null,{\"children\":[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"æ€ä¹ˆåœ¨äº‹ä»¶å¤„ç†å‡½æ•°å’Œ Effect ä¹‹é—´åšé€‰æ‹©\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ä¸ºä»€ä¹ˆ Effect æ˜¯å“åº”å¼çš„ï¼Œè€Œäº‹ä»¶å¤„ç†å‡½æ•°ä¸æ˜¯\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"å½“ä½ æƒ³è¦ Effect çš„éƒ¨åˆ†ä»£ç å˜æˆéå“åº”å¼æ—¶è¦åšäº›ä»€ä¹ˆ\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"Effect Event æ˜¯ä»€ä¹ˆï¼Œä»¥åŠæ€ä¹ˆä» Effect ä¸­æå–\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"æ€ä¹ˆä½¿ç”¨ Effect Event è¯»å–æœ€æ–°çš„ props å’Œ state\"}],\"\\n\"]}]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"choosing-between-event-handlers-and-effects\",\"children\":\"åœ¨äº‹ä»¶å¤„ç†å‡½æ•°å’Œ Effect ä¸­åšé€‰æ‹© \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"é¦–å…ˆè®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹äº‹ä»¶å¤„ç†å‡½æ•°å’Œ Effect çš„åŒºåˆ«ã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å‡è®¾ä½ æ­£åœ¨å®ç°ä¸€ä¸ªèŠå¤©å®¤ç»„ä»¶ï¼Œéœ€æ±‚å¦‚ä¸‹ï¼š\"}],\"\\n\",[\"$r\",\"ol\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ç»„ä»¶åº”è¯¥è‡ªåŠ¨è¿æ¥é€‰ä¸­çš„èŠå¤©å®¤ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"æ¯å½“ä½ ç‚¹å‡»â€œSendâ€æŒ‰é’®ï¼Œç»„ä»¶åº”è¯¥åœ¨å½“å‰èŠå¤©ç•Œé¢å‘é€ä¸€æ¡æ¶ˆæ¯ã€‚\"}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å‡è®¾ä½ å·²ç»å®ç°äº†è¿™éƒ¨åˆ†ä»£ç ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰ç¡®å®šåº”è¯¥æ”¾åœ¨å“ªé‡Œã€‚ä½ æ˜¯åº”è¯¥ç”¨äº‹ä»¶å¤„ç†å‡½æ•°è¿˜æ˜¯ Effect å‘¢ï¼Ÿæ¯å½“ä½ éœ€è¦å›ç­”è¿™ä¸ªé—®é¢˜æ—¶ï¼Œè¯·è€ƒè™‘ä¸€ä¸‹ \",[\"$r\",\"a\",null,{\"href\":\"/learn/synchronizing-with-effects#what-are-effects-and-how-are-they-different-from-events\",\"children\":\"ä¸ºä»€ä¹ˆä»£ç éœ€è¦è¿è¡Œ\"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"event-handlers-run-in-response-to-specific-interactions\",\"children\":\"äº‹ä»¶å¤„ç†å‡½æ•°åªåœ¨å“åº”ç‰¹å®šçš„äº¤äº’æ“ä½œæ—¶è¿è¡Œ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä»ç”¨æˆ·è§’åº¦å‡ºå‘ï¼Œå‘é€æ¶ˆæ¯æ˜¯ \",[\"$r\",\"strong\",null,{\"children\":\"å› ä¸º\"}],\" ä»–ç‚¹å‡»äº†ç‰¹å®šçš„â€œSendâ€æŒ‰é’®ã€‚å¦‚æœåœ¨ä»»æ„æ—¶é—´æˆ–è€…å› ä¸ºå…¶ä»–åŸå› å‘é€æ¶ˆæ¯ï¼Œç”¨æˆ·ä¼šè§‰å¾—éå¸¸æ··ä¹±ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå‘é€æ¶ˆæ¯åº”è¯¥ä½¿ç”¨äº‹ä»¶å¤„ç†å‡½æ•°ã€‚äº‹ä»¶å¤„ç†å‡½æ•°æ˜¯è®©ä½ å¤„ç†ç‰¹å®šçš„äº¤äº’æ“ä½œçš„ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{4-6}\",\"children\":\"function ChatRoom({ roomId }) {\\n  const [message, setMessage] = useState('');\\n  // ...\\n  function handleSendClick() {\\n    sendMessage(message);\\n  }\\n  // ...\\n  return (\\n    <>\\n      <input value={message} onChange={e => setMessage(e.target.value)} />\\n      <button onClick={handleSendClick}>Send</button>;\\n    </>\\n  );\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å€ŸåŠ©äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œä½ å¯ä»¥ç¡®ä¿ \",[\"$r\",\"code\",null,{\"children\":\"sendMessage(message)\"}],\" \",[\"$r\",\"strong\",null,{\"children\":\"åª\"}],\" åœ¨ç”¨æˆ·ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™è¿è¡Œã€‚\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"effects-run-whenever-synchronization-is-needed\",\"children\":\"æ¯å½“éœ€è¦åŒæ­¥ï¼ŒEffect å°±ä¼šè¿è¡Œ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å›æƒ³ä¸€ä¸‹ï¼Œä½ è¿˜éœ€è¦è®©ç»„ä»¶å’ŒèŠå¤©å®¤ä¿æŒè¿æ¥ã€‚ä»£ç æ”¾å“ªé‡Œå‘¢ï¼Ÿ\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¿è¡Œè¿™ä¸ªä»£ç çš„ \",[\"$r\",\"strong\",null,{\"children\":\"åŸå› \"}],\" ä¸æ˜¯ç‰¹å®šçš„äº¤äº’æ“ä½œã€‚ç”¨æˆ·ä¸ºä»€ä¹ˆæˆ–æ€ä¹ˆå¯¼èˆªåˆ°èŠå¤©å®¤å±å¹•çš„éƒ½ä¸é‡è¦ã€‚æ—¢ç„¶ç”¨æˆ·æ­£åœ¨çœ‹å®ƒå¹¶ä¸”èƒ½å¤Ÿå’Œå®ƒäº¤äº’ï¼Œç»„ä»¶å°±è¦å’Œé€‰ä¸­çš„èŠå¤©æœåŠ¡å™¨ä¿æŒè¿æ¥ã€‚å³ä½¿èŠå¤©å®¤ç»„ä»¶æ˜¾ç¤ºçš„æ˜¯åº”ç”¨çš„åˆå§‹å±å¹•ï¼Œç”¨æˆ·æ ¹æœ¬è¿˜æ²¡æœ‰æ‰§è¡Œä»»ä½•äº¤äº’ï¼Œä»ç„¶åº”è¯¥éœ€è¦ä¿æŒè¿æ¥ã€‚è¿™å°±æ˜¯è¿™é‡Œç”¨ Effect çš„åŸå› ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{3-9}\",\"children\":\"function ChatRoom({ roomId }) {\\n  // ...\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.connect();\\n    return () => {\\n      connection.disconnect();\\n    };\\n  }, [roomId]);\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"æ— è®º\"}],\" ç”¨æˆ·æ˜¯å¦æ‰§è¡ŒæŒ‡å®šäº¤äº’æ“ä½œï¼Œè¿™æ®µä»£ç éƒ½å¯ä»¥ä¿è¯å½“å‰é€‰ä¸­çš„èŠå¤©å®¤æœåŠ¡å™¨ä¸€ç›´æœ‰ä¸€ä¸ªæ´»è·ƒè¿æ¥ã€‚ç”¨æˆ·æ˜¯å¦åªå¯åŠ¨äº†åº”ç”¨ï¼Œæˆ–é€‰ä¸­äº†ä¸åŒçš„èŠå¤©å®¤ï¼Œåˆæˆ–è€…å¯¼èˆªåˆ°å¦ä¸€ä¸ªå±å¹•åè¿”å›ï¼ŒEffect éƒ½å¯ä»¥ç¡®ä¿ç»„ä»¶å’Œå½“å‰é€‰ä¸­çš„èŠå¤©å®¤ä¿æŒåŒæ­¥ï¼Œå¹¶åœ¨å¿…è¦æ—¶ \",[\"$r\",\"a\",null,{\"href\":\"/learn/lifecycle-of-reactive-effects#why-synchronization-may-need-to-happen-more-than-once\",\"children\":\"é‡æ–°è¿æ¥\"}],\"ã€‚\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { createConnection, sendMessage } from './chat.js';\\n\\nconst serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId }) {\\n  const [message, setMessage] = useState('');\\n\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId]);\\n\\n  function handleSendClick() {\\n    sendMessage(message);\\n  }\\n\\n  return (\\n    <>\\n      <h1>Welcome to the {roomId} room!</h1>\\n      <input value={message} onChange={e => setMessage(e.target.value)} />\\n      <button onClick={handleSendClick}>Send</button>\\n    </>\\n  );\\n}\\n\\nexport default function App() {\\n  const [roomId, setRoomId] = useState('general');\\n  const [show, setShow] = useState(false);\\n  return (\\n    <>\\n      <label>\\n        Choose the chat room:{' '}\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"general\\\">general</option>\\n          <option value=\\\"travel\\\">travel</option>\\n          <option value=\\\"music\\\">music</option>\\n        </select>\\n      </label>\\n      <button onClick={() => setShow(!show)}>\\n        {show ? 'Close chat' : 'Open chat'}\\n      </button>\\n      {show && <hr />}\\n      {show && <ChatRoom roomId={roomId} />}\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function sendMessage(message) {\\n  console.log('ğŸ”µ You sent: ' + message);\\n}\\n\\nexport function createConnection(serverUrl, roomId) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  return {\\n    connect() {\\n      console.log('âœ… Connecting to \\\"' + roomId + '\\\" room at ' + serverUrl + '...');\\n    },\\n    disconnect() {\\n      console.log('âŒ Disconnected from \\\"' + roomId + '\\\" room at ' + serverUrl);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"input, select { margin-right: 20px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"88\",{\"children\":[\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"reactive-values-and-reactive-logic\",\"children\":\"å“åº”å¼å€¼å’Œå“åº”å¼é€»è¾‘ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ç›´è§‚ä¸Šï¼Œä½ å¯ä»¥è¯´äº‹ä»¶å¤„ç†å‡½æ•°æ€»æ˜¯â€œæ‰‹åŠ¨â€è§¦å‘çš„ï¼Œä¾‹å¦‚ç‚¹å‡»æŒ‰é’®ã€‚å¦ä¸€æ–¹é¢ï¼Œ Effect æ˜¯è‡ªåŠ¨è§¦å‘ï¼šæ¯å½“éœ€è¦ä¿æŒåŒæ­¥çš„æ—¶å€™ä»–ä»¬å°±ä¼šå¼€å§‹è¿è¡Œå’Œé‡æ–°è¿è¡Œã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"æœ‰ä¸€ä¸ªæ›´ç²¾ç¡®çš„æ–¹å¼æ¥è€ƒè™‘è¿™ä¸ªé—®é¢˜ã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç»„ä»¶å†…éƒ¨å£°æ˜çš„ state å’Œ props å˜é‡è¢«ç§°ä¸º  \",[\"$r\",\"CodeStep\",null,{\"step\":2,\"children\":\"å“åº”å¼å€¼\"}],\"ã€‚æœ¬ç¤ºä¾‹ä¸­çš„ \",[\"$r\",\"code\",null,{\"children\":\"serverUrl\"}],\" ä¸æ˜¯å“åº”å¼å€¼ï¼Œä½† \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" å’Œ \",[\"$r\",\"code\",null,{\"children\":\"message\"}],\" æ˜¯ã€‚ä»–ä»¬å‚ä¸ç»„ä»¶çš„æ¸²æŸ“æ•°æ®æµï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"[[2, 3, \\\"roomId\\\"], [2, 4, \\\"message\\\"]]\",\"children\":\"const serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId }) {\\n  const [message, setMessage] = useState('');\\n\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"åƒè¿™æ ·çš„å“åº”å¼å€¼å¯ä»¥å› ä¸ºé‡æ–°æ¸²æŸ“è€Œå˜åŒ–ã€‚ä¾‹å¦‚ç”¨æˆ·å¯èƒ½ä¼šç¼–è¾‘ \",[\"$r\",\"code\",null,{\"children\":\"message\"}],\" æˆ–è€…åœ¨ä¸‹æ‹‰èœå•ä¸­é€‰ä¸­ä¸åŒçš„ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\"ã€‚äº‹ä»¶å¤„ç†å‡½æ•°å’Œ Effect å¯¹äºå˜åŒ–çš„å“åº”æ˜¯ä¸ä¸€æ ·çš„ï¼š\"]}],\"\\n\",[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"äº‹ä»¶å¤„ç†å‡½æ•°å†…éƒ¨çš„é€»è¾‘æ˜¯éå“åº”å¼çš„\"}],\"ã€‚é™¤éç”¨æˆ·åˆæ‰§è¡Œäº†åŒæ ·çš„æ“ä½œï¼ˆä¾‹å¦‚ç‚¹å‡»ï¼‰ï¼Œå¦åˆ™è¿™æ®µé€»è¾‘ä¸ä¼šå†è¿è¡Œã€‚äº‹ä»¶å¤„ç†å‡½æ•°å¯ä»¥åœ¨â€œä¸å“åº”â€ä»–ä»¬å˜åŒ–çš„æƒ…å†µä¸‹è¯»å–å“åº”å¼å€¼ã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"Effect å†…éƒ¨çš„é€»è¾‘æ˜¯å“åº”å¼çš„\"}],\"ã€‚å¦‚æœ Effect è¦è¯»å–å“åº”å¼å€¼ï¼Œ\",[\"$r\",\"a\",null,{\"href\":\"/learn/lifecycle-of-reactive-effects#effects-react-to-reactive-values\",\"children\":\"ä½ å¿…é¡»å°†å®ƒæŒ‡å®šä¸ºä¾èµ–é¡¹\"}],\"ã€‚å¦‚æœæ¥ä¸‹æ¥çš„é‡æ–°æ¸²æŸ“å¼•èµ·é‚£ä¸ªå€¼å˜åŒ–ï¼ŒReact å°±ä¼šä½¿ç”¨æ–°å€¼é‡æ–°è¿è¡Œ Effect å†…çš„é€»è¾‘ã€‚\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è®©æˆ‘ä»¬é‡æ–°çœ‹çœ‹å‰é¢çš„ç¤ºä¾‹æ¥è¯´æ˜å·®å¼‚ã€‚\"}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"logic-inside-event-handlers-is-not-reactive\",\"children\":\"äº‹ä»¶å¤„ç†å‡½æ•°å†…éƒ¨çš„é€»è¾‘æ˜¯éå“åº”å¼çš„ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"çœ‹è¿™è¡Œä»£ç ã€‚è¿™ä¸ªé€»è¾‘æ˜¯å“åº”å¼çš„å—ï¼Ÿ\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"[[2, 2, \\\"message\\\"]]\",\"children\":\"    // ...\\n    sendMessage(message);\\n    // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä»ç”¨æˆ·è§’åº¦å‡ºå‘ï¼Œ\",[\"$r\",\"strong\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"message\"}],\" çš„å˜åŒ–å¹¶ä¸æ„å‘³ç€ä»–ä»¬æƒ³è¦å‘é€æ¶ˆæ¯\"]}],\"ã€‚å®ƒåªèƒ½è¡¨æ˜ç”¨æˆ·æ­£åœ¨è¾“å…¥ã€‚æ¢å¥è¯è¯´ï¼Œå‘é€æ¶ˆæ¯çš„é€»è¾‘ä¸åº”è¯¥æ˜¯å“åº”å¼çš„ã€‚å®ƒä¸åº”è¯¥ä»…ä»…å› ä¸º \",[\"$r\",\"CodeStep\",null,{\"step\":2,\"children\":\"å“åº”å¼å€¼\"}],\" å˜åŒ–è€Œå†æ¬¡è¿è¡Œã€‚è¿™å°±æ˜¯åº”è¯¥æŠŠå®ƒå½’å…¥äº‹ä»¶å¤„ç†å‡½æ•°çš„åŸå› ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2}\",\"children\":\"  function handleSendClick() {\\n    sendMessage(message);\\n  }\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"äº‹ä»¶å¤„ç†å‡½æ•°æ˜¯éå“åº”å¼çš„ï¼Œæ‰€ä»¥ \",[\"$r\",\"code\",null,{\"children\":\"sendMessage(message)\"}],\" åªä¼šåœ¨ç”¨æˆ·ç‚¹å‡»â€œSendâ€æŒ‰é’®çš„æ—¶å€™è¿è¡Œã€‚\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"logic-inside-effects-is-reactive\",\"children\":\"Effect å†…éƒ¨çš„é€»è¾‘æ˜¯å“åº”å¼çš„ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ç°åœ¨è®©æˆ‘ä»¬è¿”å›è¿™å‡ è¡Œä»£ç ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"[[2, 2, \\\"roomId\\\"]]\",\"children\":\"    // ...\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.connect();\\n    // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä»ç”¨æˆ·è§’åº¦å‡ºå‘ï¼Œ\",[\"$r\",\"strong\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" çš„å˜åŒ–æ„å‘³ç€ä»–ä»¬çš„ç¡®æƒ³è¦è¿æ¥åˆ°ä¸åŒçš„æˆ¿é—´\"]}],\"ã€‚æ¢å¥è¯è¯´ï¼Œè¿æ¥æˆ¿é—´çš„é€»è¾‘åº”è¯¥æ˜¯å“åº”å¼çš„ã€‚ä½  \",[\"$r\",\"strong\",null,{\"children\":\"éœ€è¦\"}],\" è¿™å‡ è¡Œä»£ç å’Œå“åº”å¼å€¼â€œä¿æŒåŒæ­¥â€ï¼Œå¹¶åœ¨å€¼ä¸åŒæ—¶å†æ¬¡è¿è¡Œã€‚è¿™å°±æ˜¯å®ƒè¢«å½’å…¥ Effect çš„åŸå› ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2-3}\",\"children\":\"  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.connect();\\n    return () => {\\n      connection.disconnect()\\n    };\\n  }, [roomId]);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"Effect æ˜¯å“åº”å¼çš„ï¼Œæ‰€ä»¥ \",[\"$r\",\"code\",null,{\"children\":\"createConnection(serverUrl, roomId)\"}],\" å’Œ \",[\"$r\",\"code\",null,{\"children\":\"connection.connect()\"}],\" ä¼šå› ä¸º \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" æ¯ä¸ªä¸åŒçš„å€¼è€Œè¿è¡Œã€‚Effect è®©èŠå¤©å®¤è¿æ¥å’Œå½“å‰é€‰ä¸­çš„æˆ¿é—´ä¿æŒäº†åŒæ­¥ã€‚\"]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"extracting-non-reactive-logic-out-of-effects\",\"children\":\"ä» Effect ä¸­æå–éå“åº”å¼é€»è¾‘ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å½“ä½ æƒ³æ··åˆä½¿ç”¨å“åº”å¼é€»è¾‘å’Œéå“åº”å¼é€»è¾‘æ—¶ï¼Œäº‹æƒ…å˜å¾—æ›´åŠ æ£˜æ‰‹ã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ä¾‹å¦‚ï¼Œå‡è®¾ä½ æƒ³åœ¨ç”¨æˆ·è¿æ¥åˆ°èŠå¤©å®¤æ—¶å±•ç¤ºä¸€ä¸ªé€šçŸ¥ã€‚å¹¶ä¸”é€šè¿‡ä» props ä¸­è¯»å–å½“å‰ themeï¼ˆdark æˆ–è€… lightï¼‰æ¥å±•ç¤ºå¯¹åº”é¢œè‰²çš„é€šçŸ¥ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1,4-6}\",\"children\":\"function ChatRoom({ roomId, theme }) {\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.on('connected', () => {\\n      showNotification('Connected!', theme);\\n    });\\n    connection.connect();\\n    // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä½†æ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"theme\"}],\" æ˜¯ä¸€ä¸ªå“åº”å¼å€¼ï¼ˆå®ƒä¼šç”±äºé‡æ–°æ¸²æŸ“è€Œå˜åŒ–ï¼‰ï¼Œå¹¶ä¸” \",[\"$r\",\"a\",null,{\"href\":\"/learn/lifecycle-of-reactive-effects#react-verifies-that-you-specified-every-reactive-value-as-a-dependency\",\"children\":\"Effect è¯»å–çš„æ¯ä¸€ä¸ªå“åº”å¼å€¼éƒ½å¿…é¡»åœ¨å…¶ä¾èµ–é¡¹ä¸­å£°æ˜\"}],\"ã€‚ç°åœ¨ä½ å¿…é¡»æŠŠ \",[\"$r\",\"code\",null,{\"children\":\"theme\"}],\" ä½œä¸º Effect çš„ä¾èµ–é¡¹ä¹‹ä¸€ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{5,11}\",\"children\":\"function ChatRoom({ roomId, theme }) {\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.on('connected', () => {\\n      showNotification('Connected!', theme);\\n    });\\n    connection.connect();\\n    return () => {\\n      connection.disconnect()\\n    };\\n  }, [roomId, theme]); // âœ… å£°æ˜æ‰€æœ‰ä¾èµ–é¡¹\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ç”¨è¿™ä¸ªä¾‹å­è¯•ä¸€ä¸‹ï¼Œçœ‹ä½ èƒ½å¦çœ‹å‡ºè¿™ä¸ªç”¨æˆ·ä½“éªŒé—®é¢˜ï¼š\"}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"latest\\\",\\n    \\\"react-dom\\\": \\\"latest\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\",\\n    \\\"toastify-js\\\": \\\"1.12.0\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { createConnection, sendMessage } from './chat.js';\\nimport { showNotification } from './notifications.js';\\n\\nconst serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId, theme }) {\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.on('connected', () => {\\n      showNotification('Connected!', theme);\\n    });\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId, theme]);\\n\\n  return <h1>Welcome to the {roomId} room!</h1>\\n}\\n\\nexport default function App() {\\n  const [roomId, setRoomId] = useState('general');\\n  const [isDark, setIsDark] = useState(false);\\n  return (\\n    <>\\n      <label>\\n        Choose the chat room:{' '}\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"general\\\">general</option>\\n          <option value=\\\"travel\\\">travel</option>\\n          <option value=\\\"music\\\">music</option>\\n        </select>\\n      </label>\\n      <label>\\n        <input\\n          type=\\\"checkbox\\\"\\n          checked={isDark}\\n          onChange={e => setIsDark(e.target.checked)}\\n        />\\n        Use dark theme\\n      </label>\\n      <hr />\\n      <ChatRoom\\n        roomId={roomId}\\n        theme={isDark ? 'dark' : 'light'}\\n      />\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection(serverUrl, roomId) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  let connectedCallback;\\n  let timeout;\\n  return {\\n    connect() {\\n      timeout = setTimeout(() => {\\n        if (connectedCallback) {\\n          connectedCallback();\\n        }\\n      }, 100);\\n    },\\n    on(event, callback) {\\n      if (connectedCallback) {\\n        throw Error('Cannot add the handler twice.');\\n      }\\n      if (event !== 'connected') {\\n        throw Error('Only \\\"connected\\\" event is supported.');\\n      }\\n      connectedCallback = callback;\\n    },\\n    disconnect() {\\n      clearTimeout(timeout);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/notifications.js\",\"children\":\"import Toastify from 'toastify-js';\\nimport 'toastify-js/src/toastify.css';\\n\\nexport function showNotification(message, theme) {\\n  Toastify({\\n    text: message,\\n    duration: 2000,\\n    gravity: 'top',\\n    position: 'right',\\n    style: {\\n      background: theme === 'dark' ? 'black' : 'white',\\n      color: theme === 'dark' ? 'white' : 'black',\\n    },\\n  }).showToast();\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label { display: block; margin-top: 10px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"116\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å½“ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" å˜åŒ–æ—¶ï¼ŒèŠå¤©ä¼šå’Œé¢„æœŸä¸€æ ·é‡æ–°è¿æ¥ã€‚ä½†æ˜¯ç”±äº \",[\"$r\",\"code\",null,{\"children\":\"theme\"}],\" ä¹Ÿæ˜¯ä¸€ä¸ªä¾èµ–é¡¹ï¼Œæ‰€ä»¥æ¯æ¬¡ä½ åœ¨ dark å’Œ light ä¸»é¢˜é—´åˆ‡æ¢æ—¶ï¼ŒèŠå¤© \",[\"$r\",\"strong\",null,{\"children\":\"ä¹Ÿä¼š\"}],\" é‡è¿ã€‚è¿™ä¸æ˜¯å¾ˆå¥½ï¼\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"æ¢è¨€ä¹‹ï¼Œå³ä½¿å®ƒåœ¨ Effect å†…éƒ¨ï¼ˆè¿™æ˜¯å“åº”å¼çš„ï¼‰ï¼Œä½ ä¹Ÿä¸æƒ³è®©è¿™è¡Œä»£ç å˜æˆå“åº”å¼ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"      // ...\\n      showNotification('Connected!', theme);\\n      // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ä½ éœ€è¦ä¸€ä¸ªå°†è¿™ä¸ªéå“åº”å¼é€»è¾‘å’Œå‘¨å›´å“åº”å¼ Effect éš”ç¦»å¼€æ¥çš„æ–¹æ³•ã€‚\"}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"declaring-an-effect-event\",\"children\":\"å£°æ˜ä¸€ä¸ª Effect Event \"}],\"\\n\",[\"$r\",\"Wip\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":[\"æœ¬ç« èŠ‚æè¿°äº†ä¸€ä¸ªåœ¨ React ç¨³å®šç‰ˆä¸­ \",[\"$r\",\"strong\",null,{\"children\":\"è¿˜æ²¡æœ‰å‘å¸ƒçš„å®éªŒæ€§ API\"}],\"ã€‚\"]}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä½¿ç”¨ \",[\"$r\",\"a\",null,{\"href\":\"/reference/react/experimental_useEffectEvent\",\"children\":[\"$r\",\"code\",null,{\"children\":\"useEffectEvent\"}]}],\" è¿™ä¸ªç‰¹æ®Šçš„ Hook ä» Effect ä¸­æå–éå“åº”å¼é€»è¾‘ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1,4-6}\",\"children\":\"import { useEffect, useEffectEvent } from 'react';\\n\\nfunction ChatRoom({ roomId, theme }) {\\n  const onConnected = useEffectEvent(() => {\\n    showNotification('Connected!', theme);\\n  });\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¿™é‡Œçš„ \",[\"$r\",\"code\",null,{\"children\":\"onConnected\"}],\" è¢«ç§°ä¸º \",[\"$r\",\"strong\",null,{\"children\":\"Effect Event\"}],\"ã€‚å®ƒæ˜¯ Effect é€»è¾‘çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯å…¶è¡Œä¸ºæ›´åƒäº‹ä»¶å¤„ç†å‡½æ•°ã€‚å®ƒå†…éƒ¨çš„é€»è¾‘ä¸æ˜¯å“åº”å¼çš„ï¼Œè€Œä¸”èƒ½ä¸€ç›´â€œçœ‹è§â€æœ€æ–°çš„ props å’Œ stateã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç°åœ¨ä½ å¯ä»¥åœ¨ Effect å†…éƒ¨è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"onConnected\"}],\" Effect Eventï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2-4,9,13}\",\"children\":\"function ChatRoom({ roomId, theme }) {\\n  const onConnected = useEffectEvent(() => {\\n    showNotification('Connected!', theme);\\n  });\\n\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.on('connected', () => {\\n      onConnected();\\n    });\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId]); // âœ… å£°æ˜æ‰€æœ‰ä¾èµ–é¡¹\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¿™ä¸ªæ–¹æ³•è§£å†³äº†é—®é¢˜ã€‚æ³¨æ„ä½ å¿…é¡»ä» Effect ä¾èµ–é¡¹ä¸­ \",[\"$r\",\"strong\",null,{\"children\":\"ç§»é™¤\"}],\" \",[\"$r\",\"code\",null,{\"children\":\"onConnected\"}],\"ã€‚\",[\"$r\",\"strong\",null,{\"children\":\"Effect Event æ˜¯éå“åº”å¼çš„å¹¶ä¸”å¿…é¡»ä»ä¾èµ–é¡¹ä¸­åˆ é™¤\"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"éªŒè¯æ–°è¡¨ç°æ˜¯å¦å’Œä½ é¢„æœŸçš„ä¸€æ ·ï¼š\"}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"experimental\\\",\\n    \\\"react-dom\\\": \\\"experimental\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\",\\n    \\\"toastify-js\\\": \\\"1.12.0\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { experimental_useEffectEvent as useEffectEvent } from 'react';\\nimport { createConnection, sendMessage } from './chat.js';\\nimport { showNotification } from './notifications.js';\\n\\nconst serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId, theme }) {\\n  const onConnected = useEffectEvent(() => {\\n    showNotification('Connected!', theme);\\n  });\\n\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.on('connected', () => {\\n      onConnected();\\n    });\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId]);\\n\\n  return <h1>Welcome to the {roomId} room!</h1>\\n}\\n\\nexport default function App() {\\n  const [roomId, setRoomId] = useState('general');\\n  const [isDark, setIsDark] = useState(false);\\n  return (\\n    <>\\n      <label>\\n        Choose the chat room:{' '}\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"general\\\">general</option>\\n          <option value=\\\"travel\\\">travel</option>\\n          <option value=\\\"music\\\">music</option>\\n        </select>\\n      </label>\\n      <label>\\n        <input\\n          type=\\\"checkbox\\\"\\n          checked={isDark}\\n          onChange={e => setIsDark(e.target.checked)}\\n        />\\n        Use dark theme\\n      </label>\\n      <hr />\\n      <ChatRoom\\n        roomId={roomId}\\n        theme={isDark ? 'dark' : 'light'}\\n      />\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection(serverUrl, roomId) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  let connectedCallback;\\n  let timeout;\\n  return {\\n    connect() {\\n      timeout = setTimeout(() => {\\n        if (connectedCallback) {\\n          connectedCallback();\\n        }\\n      }, 100);\\n    },\\n    on(event, callback) {\\n      if (connectedCallback) {\\n        throw Error('Cannot add the handler twice.');\\n      }\\n      if (event !== 'connected') {\\n        throw Error('Only \\\"connected\\\" event is supported.');\\n      }\\n      connectedCallback = callback;\\n    },\\n    disconnect() {\\n      clearTimeout(timeout);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/notifications.js hidden\",\"children\":\"import Toastify from 'toastify-js';\\nimport 'toastify-js/src/toastify.css';\\n\\nexport function showNotification(message, theme) {\\n  Toastify({\\n    text: message,\\n    duration: 2000,\\n    gravity: 'top',\\n    position: 'right',\\n    style: {\\n      background: theme === 'dark' ? 'black' : 'white',\\n      color: theme === 'dark' ? 'white' : 'black',\\n    },\\n  }).showToast();\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label { display: block; margin-top: 10px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"178\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ä½ å¯ä»¥å°† Effect Event çœ‹æˆå’Œäº‹ä»¶å¤„ç†å‡½æ•°ç›¸ä¼¼çš„ä¸œè¥¿ã€‚ä¸»è¦åŒºåˆ«æ˜¯äº‹ä»¶å¤„ç†å‡½æ•°åªåœ¨å“åº”ç”¨æˆ·äº¤äº’çš„æ—¶å€™è¿è¡Œï¼Œè€Œ Effect Event æ˜¯ä½ åœ¨ Effect ä¸­è§¦å‘çš„ã€‚Effect Event è®©ä½ åœ¨ Effect å“åº”æ€§å’Œä¸åº”æ˜¯å“åº”å¼çš„ä»£ç é—´â€œæ‰“ç ´é“¾æ¡â€ã€‚\"}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"reading-latest-props-and-state-with-effect-events\",\"children\":\"ä½¿ç”¨ Effect Event è¯»å–æœ€æ–°çš„ props å’Œ state \"}],\"\\n\",[\"$r\",\"Wip\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":[\"æœ¬ç« èŠ‚æè¿°äº†ä¸€ä¸ªåœ¨ React ç¨³å®šç‰ˆä¸­ \",[\"$r\",\"strong\",null,{\"children\":\"è¿˜æ²¡æœ‰å‘å¸ƒçš„å®éªŒæ€§ API\"}],\"ã€‚\"]}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"Effect Event å¯ä»¥ä¿®å¤ä¹‹å‰è®¸å¤šä½ å¯èƒ½è¯•å›¾æŠ‘åˆ¶ä¾èµ–é¡¹æ£€æŸ¥å·¥å…·çš„åœ°æ–¹ã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ä¾‹å¦‚ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªè®°å½•é¡µé¢è®¿é—®çš„ Effectï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"function Page() {\\n  useEffect(() => {\\n    logVisit();\\n  }, []);\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç¨åå‘ä½ çš„ç«™ç‚¹æ·»åŠ å¤šä¸ªè·¯ç”±ã€‚ç°åœ¨ \",[\"$r\",\"code\",null,{\"children\":\"Page\"}],\" ç»„ä»¶æ¥æ”¶åŒ…å«å½“å‰è·¯å¾„çš„ \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" propsã€‚ä½ æƒ³æŠŠ \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" ä½œä¸º \",[\"$r\",\"code\",null,{\"children\":\"logVisit\"}],\" è°ƒç”¨çš„ä¸€éƒ¨åˆ†è¿›è¡Œä¼ é€’ï¼Œä½†æ˜¯ä¾èµ–é¡¹æ£€æŸ¥å·¥å…·ä¼šæç¤ºï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1,3}\",\"children\":\"function Page({ url }) {\\n  useEffect(() => {\\n    logVisit(url);\\n  }, []); // ğŸ”´ React Hook useEffect ç¼ºå°‘ä¸€ä¸ªä¾èµ–é¡¹: 'url'\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æƒ³æƒ³ä½ æƒ³è¦ä»£ç åšä»€ä¹ˆã€‚ä½  \",[\"$r\",\"strong\",null,{\"children\":\"éœ€è¦\"}],\" ä¸ºä¸åŒçš„ URL è®°å½•å•ç‹¬çš„è®¿é—®ï¼Œå› ä¸ºæ¯ä¸ª URL ä»£è¡¨ä¸åŒçš„é¡µé¢ã€‚æ¢è¨€ä¹‹ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"logVisit\"}],\" è°ƒç”¨å¯¹äº \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" \",[\"$r\",\"strong\",null,{\"children\":\"åº”è¯¥\"}],\" æ˜¯å“åº”å¼çš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ éµå¾ªä¾èµ–é¡¹æ£€æŸ¥å·¥å…·å¹¶æ·»åŠ  \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" ä½œä¸ºä¸€ä¸ªä¾èµ–é¡¹å¾ˆæœ‰æ„ä¹‰ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{4}\",\"children\":\"function Page({ url }) {\\n  useEffect(() => {\\n    logVisit(url);\\n  }, [url]); // âœ… å£°æ˜æ‰€æœ‰ä¾èµ–é¡¹\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ç°åœ¨å‡è®¾ä½ æƒ³åœ¨æ¯æ¬¡é¡µé¢è®¿é—®ä¸­åŒ…å«è´­ç‰©è½¦ä¸­çš„å•†å“æ•°é‡ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2-3,6}\",\"children\":\"function Page({ url }) {\\n  const { items } = useContext(ShoppingCartContext);\\n  const numberOfItems = items.length;\\n\\n  useEffect(() => {\\n    logVisit(url, numberOfItems);\\n  }, [url]); // ğŸ”´ React Hook useEffect ç¼ºå°‘ä¾èµ–é¡¹: â€˜numberOfItemsâ€™\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä½ åœ¨ Effect å†…éƒ¨ä½¿ç”¨äº† \",[\"$r\",\"code\",null,{\"children\":\"numberOfItems\"}],\"ï¼Œæ‰€ä»¥ä»£ç æ£€æŸ¥å·¥å…·ä¼šè®©ä½ æŠŠå®ƒåŠ åˆ°ä¾èµ–é¡¹ä¸­ã€‚ä½†æ˜¯ï¼Œä½  \",[\"$r\",\"strong\",null,{\"children\":\"ä¸\"}],\" æƒ³è¦ \",[\"$r\",\"code\",null,{\"children\":\"logVisit\"}],\" è°ƒç”¨å“åº” \",[\"$r\",\"code\",null,{\"children\":\"numberOfItems\"}],\"ã€‚å¦‚æœç”¨æˆ·æŠŠæŸæ ·ä¸œè¥¿æ”¾å…¥è´­ç‰©è½¦ï¼Œ \",[\"$r\",\"code\",null,{\"children\":\"numberOfItems\"}],\" ä¼šå˜åŒ–ï¼Œè¿™ \",[\"$r\",\"strong\",null,{\"children\":\"å¹¶ä¸æ„å‘³ç€\"}],\" ç”¨æˆ·å†æ¬¡è®¿é—®äº†è¿™ä¸ªé¡µé¢ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨æŸç§æ„ä¹‰ä¸Šï¼Œ\",[\"$r\",\"strong\",null,{\"children\":\"è®¿é—®é¡µé¢\"}],\" æ˜¯ä¸€ä¸ªâ€œäº‹ä»¶â€ã€‚å®ƒå‘ç”Ÿåœ¨æŸä¸ªå‡†ç¡®çš„æ—¶åˆ»ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å°†ä»£ç åˆ†å‰²ä¸ºä¸¤éƒ¨åˆ†ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{5-7,10}\",\"children\":\"function Page({ url }) {\\n  const { items } = useContext(ShoppingCartContext);\\n  const numberOfItems = items.length;\\n\\n  const onVisit = useEffectEvent(visitedUrl => {\\n    logVisit(visitedUrl, numberOfItems);\\n  });\\n\\n  useEffect(() => {\\n    onVisit(url);\\n  }, [url]); // âœ… å£°æ˜æ‰€æœ‰ä¾èµ–é¡¹\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¿™é‡Œçš„ \",[\"$r\",\"code\",null,{\"children\":\"onVisit\"}],\" æ˜¯ä¸€ä¸ª Effect Eventã€‚é‡Œé¢çš„ä»£ç ä¸æ˜¯å“åº”å¼çš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ å¯ä»¥ä½¿ç”¨ \",[\"$r\",\"code\",null,{\"children\":\"numberOfItems\"}],\"ï¼ˆæˆ–è€…ä»»æ„å“åº”å¼å€¼ï¼ï¼‰è€Œä¸ç”¨æ‹…å¿ƒå¼•èµ·å‘¨å›´ä»£ç å› ä¸ºå˜åŒ–è€Œé‡æ–°æ‰§è¡Œã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å¦ä¸€æ–¹é¢ï¼ŒEffect æœ¬èº«ä»ç„¶æ˜¯å“åº”å¼çš„ã€‚å…¶å†…éƒ¨çš„ä»£ç ä½¿ç”¨äº† \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" propsï¼Œæ‰€ä»¥æ¯æ¬¡å› ä¸ºä¸åŒçš„ \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" é‡æ–°æ¸²æŸ“å Effect éƒ½ä¼šé‡æ–°è¿è¡Œã€‚è¿™ä¼šä¾æ¬¡è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"onVisit\"}],\" è¿™ä¸ª Effect Eventã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç»“æœæ˜¯ä½ ä¼šå› ä¸º \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" çš„å˜åŒ–å»è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"logVisit\"}],\"ï¼Œå¹¶ä¸”è¯»å–çš„ä¸€ç›´éƒ½æ˜¯æœ€æ–°çš„ \",[\"$r\",\"code\",null,{\"children\":\"numberOfItems\"}],\"ã€‚ä½†æ˜¯å¦‚æœ \",[\"$r\",\"code\",null,{\"children\":\"numberOfItems\"}],\" è‡ªå·±å˜åŒ–ï¼Œä¸ä¼šå¼•èµ·ä»»ä½•ä»£ç çš„é‡æ–°è¿è¡Œã€‚\"]}],\"\\n\",[\"$r\",\"Note\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"ä½ å¯èƒ½æƒ³çŸ¥é“æ˜¯å¦å¯ä»¥æ— å‚æ•°è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"onVisit()\"}],\" å¹¶ä¸”è¯»å–å†…éƒ¨çš„ \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\"ï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2,6}\",\"children\":\"  const onVisit = useEffectEvent(() => {\\n    logVisit(url, numberOfItems);\\n  });\\n\\n  useEffect(() => {\\n    onVisit();\\n  }, [url]);\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"è¿™å¯ä»¥èµ·ä½œç”¨ï¼Œä½†æ˜¯æ›´å¥½çš„æ–¹æ³•æ˜¯å°†è¿™ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" æ˜¾å¼ä¼ é€’ç»™Effect Eventã€‚\",[\"$r\",\"strong\",null,{\"children\":[\"é€šè¿‡å°† \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" ä½œä¸ºå‚æ•°ä¼ ç»™ Effect Eventï¼Œä½ å¯ä»¥è¯´ä»ç”¨æˆ·è§’åº¦æ¥çœ‹ä½¿ç”¨ä¸åŒçš„ \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" è®¿é—®é¡µé¢æ„æˆäº†ä¸€ä¸ªç‹¬ç«‹çš„â€œäº‹ä»¶â€\"]}],\"ã€‚\",[\"$r\",\"code\",null,{\"children\":\"visitedUrl\"}],\" æ˜¯å‘ç”Ÿçš„â€œäº‹ä»¶â€çš„ä¸€éƒ¨åˆ†ï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1-2,6}\",\"children\":\"  const onVisit = useEffectEvent(visitedUrl => {\\n    logVisit(visitedUrl, numberOfItems);\\n  });\\n\\n  useEffect(() => {\\n    onVisit(url);\\n  }, [url]);\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"ç”±äº Effect æ˜ç¡®â€œè¦æ±‚â€ \",[\"$r\",\"code\",null,{\"children\":\"visitedUrl\"}],\"ï¼Œæ‰€ä»¥ç°åœ¨ä½ ä¸ä¼šä¸å°å¿ƒåœ°ä» Effect çš„ä¾èµ–é¡¹ä¸­ç§»é™¤ \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\"ã€‚å¦‚æœä½ ç§»é™¤äº† \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" ä¾èµ–é¡¹ï¼ˆå¯¼è‡´ä¸åŒçš„é¡µé¢è®¿é—®è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªï¼‰ï¼Œä»£ç æ£€æŸ¥å·¥å…·ä¼šå‘ä½ æå‡ºè­¦å‘Šã€‚å¦‚æœä½ æƒ³è¦ \",[\"$r\",\"code\",null,{\"children\":\"onVisit\"}],\" èƒ½å¯¹ \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" çš„å˜åŒ–åšå‡ºå“åº”ï¼Œä¸è¦è¯»å–å†…éƒ¨çš„ \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\"ï¼ˆè¿™é‡Œä¸æ˜¯å“åº”å¼çš„ï¼‰ï¼Œè€Œæ˜¯åº”è¯¥å°†å®ƒ \",[\"$r\",\"strong\",null,{\"children\":\"ä»\"}],\" Effect ä¸­ä¼ å…¥ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":\"å¦‚æœ Effect å†…éƒ¨æœ‰ä¸€äº›å¼‚æ­¥é€»è¾‘ï¼Œè¿™å°±å˜å¾—éå¸¸é‡è¦äº†ï¼š\"}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{6,8}\",\"children\":\"  const onVisit = useEffectEvent(visitedUrl => {\\n    logVisit(visitedUrl, numberOfItems);\\n  });\\n\\n  useEffect(() => {\\n    setTimeout(() => {\\n      onVisit(url);\\n    }, 5000); // å»¶è¿Ÿè®°å½•è®¿é—®\\n  }, [url]);\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"åœ¨è¿™é‡Œï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"onVisit\"}],\" å†…çš„ \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" å¯¹åº” \",[\"$r\",\"strong\",null,{\"children\":\"æœ€æ–°çš„\"}],\" \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\"ï¼ˆå¯èƒ½å·²ç»å˜åŒ–äº†ï¼‰ï¼Œä½†æ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"visitedUrl\"}],\" å¯¹åº”çš„æ˜¯æœ€å¼€å§‹å¼•èµ·è¿™ä¸ª Effectï¼ˆå¹¶ä¸”æ˜¯æœ¬æ¬¡ \",[\"$r\",\"code\",null,{\"children\":\"onVisit\"}],\" è°ƒç”¨ï¼‰è¿è¡Œçš„ \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" ã€‚\"]}]]}],\"\\n\",[\"$r\",\"DeepDive\",null,{\"children\":[[\"$r\",\"h4\",null,{\"id\":\"is-it-okay-to-suppress-the-dependency-linter-instead\",\"children\":\"æŠ‘åˆ¶ä¾èµ–é¡¹æ£€æŸ¥æ˜¯å¯è¡Œçš„å—ï¼Ÿ \"}],[\"$r\",\"p\",null,{\"children\":\"åœ¨å·²ç»å­˜åœ¨çš„ä»£ç åº“ä¸­ï¼Œä½ å¯èƒ½æœ‰æ—¶ä¼šçœ‹è§åƒè¿™æ ·çš„æ£€æŸ¥è§„åˆ™æŠ‘åˆ¶ï¼š\"}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{7-9}\",\"children\":\"function Page({ url }) {\\n  const { items } = useContext(ShoppingCartContext);\\n  const numberOfItems = items.length;\\n\\n  useEffect(() => {\\n    logVisit(url, numberOfItems);\\n    // ğŸ”´ é¿å…åƒè¿™æ ·æŠ‘åˆ¶ä»£ç æ£€æŸ¥:\\n    // eslint-disable-next-line react-hooks/exhaustive-deps\\n  }, [url]);\\n  // ...\\n}\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"ç­‰ \",[\"$r\",\"code\",null,{\"children\":\"useEffectEvent\"}],\" æˆä¸º React ç¨³å®šéƒ¨åˆ†åï¼Œæˆ‘ä»¬ä¼šæ¨è \",[\"$r\",\"strong\",null,{\"children\":\"æ°¸è¿œä¸è¦æŠ‘åˆ¶ä»£ç æ£€æŸ¥å·¥å…·\"}],\"ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"æŠ‘åˆ¶è§„åˆ™çš„ç¬¬ä¸€ä¸ªç¼ºç‚¹æ˜¯å½“ Effect éœ€è¦å¯¹ä¸€ä¸ªå·²ç»åœ¨ä»£ç ä¸­å‡ºç°è¿‡çš„æ–°å“åº”å¼ä¾èµ–é¡¹åšå‡ºâ€œå“åº”â€æ—¶ï¼ŒReact ä¸ä¼šå†å‘å‡ºè­¦å‘Šã€‚åœ¨ç¨æ—©ä¹‹å‰çš„ç¤ºä¾‹ä¸­ï¼Œä½ å°† \",[\"$r\",\"code\",null,{\"children\":\"url\"}],\" æ·»åŠ ä¸ºä¾èµ–é¡¹ï¼Œ\",[\"$r\",\"strong\",null,{\"children\":\"æ˜¯å› ä¸º\"}],\" React æé†’ä½ å»åšè¿™ä»¶äº‹ã€‚å¦‚æœç¦ç”¨ä»£ç æ£€æŸ¥ï¼Œä½ æœªæ¥å°†ä¸ä¼šå†æ”¶åˆ°ä»»ä½•å…³äº Effect ä¿®æ”¹çš„æé†’ã€‚è¿™å¼•èµ·äº† bugã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†ä¸€ä¸ªç”±æŠ‘åˆ¶ä»£ç æ£€æŸ¥å¼•èµ·çš„å¥‡æ€ª bugã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"handleMove\"}],\" åº”è¯¥è¯»å–å½“å‰çš„ state å˜é‡ \",[\"$r\",\"code\",null,{\"children\":\"canMove\"}],\" çš„å€¼æ¥å†³å®šè¿™ä¸ªç‚¹æ˜¯å¦åº”è¯¥è·Ÿéšå…‰æ ‡ã€‚ä½†æ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"handleMove\"}],\" ä¸­çš„ \",[\"$r\",\"code\",null,{\"children\":\"canMove\"}],\" ä¸€ç›´æ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"true\"}],\"ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":\"ä½ èƒ½çœ‹å‡ºæ˜¯ä¸ºä»€ä¹ˆå—ï¼Ÿ\"}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\n\\nexport default function App() {\\n  const [position, setPosition] = useState({ x: 0, y: 0 });\\n  const [canMove, setCanMove] = useState(true);\\n\\n  function handleMove(e) {\\n    if (canMove) {\\n      setPosition({ x: e.clientX, y: e.clientY });\\n    }\\n  }\\n\\n  useEffect(() => {\\n    window.addEventListener('pointermove', handleMove);\\n    return () => window.removeEventListener('pointermove', handleMove);\\n    // eslint-disable-next-line react-hooks/exhaustive-deps\\n  }, []);\\n\\n  return (\\n    <>\\n      <label>\\n        <input type=\\\"checkbox\\\"\\n          checked={canMove}\\n          onChange={e => setCanMove(e.target.checked)}\\n        />\\n        The dot is allowed to move\\n      </label>\\n      <hr />\\n      <div style={{\\n        position: 'absolute',\\n        backgroundColor: 'pink',\\n        borderRadius: '50%',\\n        opacity: 0.6,\\n        transform: `translate(${position.x}px, ${position.y}px)`,\\n        pointerEvents: 'none',\\n        left: -20,\\n        top: -20,\\n        width: 40,\\n        height: 40,\\n      }} />\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"body {\\n  height: 200px;\\n}\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":[\"è¿™æ®µä»£ç çš„é—®é¢˜åœ¨äºæŠ‘åˆ¶ä¾èµ–é¡¹æ£€æŸ¥ã€‚å¦‚æœç§»é™¤ï¼Œä½ å¯ä»¥çœ‹åˆ° Effect åº”è¯¥ä¾èµ–äº \",[\"$r\",\"code\",null,{\"children\":\"handleMove\"}],\" å‡½æ•°ã€‚è¿™éå¸¸æœ‰æ„ä¹‰ï¼š\",[\"$r\",\"code\",null,{\"children\":\"handleMove\"}],\" æ˜¯åœ¨ç»„ä»¶å†…å£°æ˜çš„ï¼Œæ˜¯å“åº”å¼å€¼ã€‚è€Œæ¯ä¸ªå“åº”å¼å€¼éƒ½å¿…é¡»è¢«æŒ‡å®šä¸ºä¾èµ–é¡¹ï¼Œå¦åˆ™å®ƒå¯èƒ½ä¼šéšç€æ—¶é—´è€Œè¿‡æ—¶ï¼\"]}],[\"$r\",\"p\",null,{\"children\":[\"åŸä»£ç çš„ä½œè€…å¯¹ React â€œæ’’è°â€è¯´ Effect ä¸ä¾èµ–äºä»»ä½•å“åº”å¼å€¼ï¼ˆ\",[\"$r\",\"code\",null,{\"children\":\"[]\"}],\"ï¼‰ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ \",[\"$r\",\"code\",null,{\"children\":\"canMove\"}],\"ï¼ˆä»¥åŠ \",[\"$r\",\"code\",null,{\"children\":\"handleMove\"}],\"ï¼‰å˜åŒ–å React æ²¡æœ‰é‡æ–°åŒæ­¥ã€‚å› ä¸º React æ²¡æœ‰é‡æ–°åŒæ­¥ Effectï¼Œæ‰€ä»¥ä½œä¸ºç›‘å¬å™¨é™„åŠ çš„ \",[\"$r\",\"code\",null,{\"children\":\"handleMove\"}],\" è¿˜æ˜¯åˆæ¬¡æ¸²æŸ“æœŸé—´åˆ›å»ºçš„ \",[\"$r\",\"code\",null,{\"children\":\"handleMove\"}],\" å‡½æ•°ã€‚åˆæ¬¡æ¸²æŸ“æœŸé—´ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"canMove\"}],\" çš„å€¼æ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"true\"}],\"ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ¥è‡ªåˆæ¬¡æ¸²æŸ“çš„ \",[\"$r\",\"code\",null,{\"children\":\"handleMove\"}],\" æ°¸è¿œåªèƒ½çœ‹åˆ°è¿™ä¸ªå€¼ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"$r\",\"strong\",null,{\"children\":\"å¦‚æœä½ ä»æ¥æ²¡æœ‰æŠ‘åˆ¶ä»£ç æ£€æŸ¥ï¼Œå°±æ°¸è¿œä¸ä¼šé‡è§è¿‡æœŸå€¼çš„é—®é¢˜ã€‚\"}]}],[\"$r\",\"p\",null,{\"children\":[\"æœ‰äº† \",[\"$r\",\"code\",null,{\"children\":\"useEffectEvent\"}],\"ï¼Œå°±ä¸éœ€è¦å¯¹ä»£ç æ£€æŸ¥å·¥å…·â€œè¯´è°â€ï¼Œå¹¶ä¸”ä»£ç ä¹Ÿèƒ½å’Œä½ é¢„æœŸçš„ä¸€æ ·å·¥ä½œï¼š\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"experimental\\\",\\n    \\\"react-dom\\\": \\\"experimental\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { experimental_useEffectEvent as useEffectEvent } from 'react';\\n\\nexport default function App() {\\n  const [position, setPosition] = useState({ x: 0, y: 0 });\\n  const [canMove, setCanMove] = useState(true);\\n\\n  const onMove = useEffectEvent(e => {\\n    if (canMove) {\\n      setPosition({ x: e.clientX, y: e.clientY });\\n    }\\n  });\\n\\n  useEffect(() => {\\n    window.addEventListener('pointermove', onMove);\\n    return () => window.removeEventListener('pointermove', onMove);\\n  }, []);\\n\\n  return (\\n    <>\\n      <label>\\n        <input type=\\\"checkbox\\\"\\n          checked={canMove}\\n          onChange={e => setCanMove(e.target.checked)}\\n        />\\n        The dot is allowed to move\\n      </label>\\n      <hr />\\n      <div style={{\\n        position: 'absolute',\\n        backgroundColor: 'pink',\\n        borderRadius: '50%',\\n        opacity: 0.6,\\n        transform: `translate(${position.x}px, ${position.y}px)`,\\n        pointerEvents: 'none',\\n        left: -20,\\n        top: -20,\\n        width: 40,\\n        height: 40,\\n      }} />\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"body {\\n  height: 200px;\\n}\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":[\"è¿™ä¸æ„å‘³ç€ \",[\"$r\",\"code\",null,{\"children\":\"useEffectEvent\"}],\" \",[\"$r\",\"strong\",null,{\"children\":\"æ€»æ˜¯\"}],\" æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆã€‚ä½ åªèƒ½æŠŠå®ƒç”¨åœ¨ä½ ä¸éœ€è¦å˜æˆå“åº”å¼çš„ä»£ç ä¸Šã€‚ä¸Šé¢çš„ sandbox ä¸­ï¼Œä½ ä¸éœ€è¦ Effect çš„ä»£ç å“åº” \",[\"$r\",\"code\",null,{\"children\":\"canMove\"}],\"ã€‚è¿™å°±æ˜¯æå– Effect Event å¾ˆæœ‰æ„ä¹‰çš„åŸå› ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"é˜…è¯» \",[\"$r\",\"a\",null,{\"href\":\"/learn/removing-effect-dependencies\",\"children\":\"ç§»é™¤ Effect ä¾èµ–é¡¹\"}],\" å¯»æ‰¾æŠ‘åˆ¶ä»£ç æ£€æŸ¥çš„å…¶ä»–æ­£ç¡®çš„æ›¿ä»£æ–¹å¼ã€‚\"]}]]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"limitations-of-effect-events\",\"children\":\"Effect Event çš„å±€é™æ€§ \"}],\"\\n\",[\"$r\",\"Wip\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":[\"æœ¬ç« èŠ‚æè¿°äº†ä¸€ä¸ªåœ¨ React ç¨³å®šç‰ˆä¸­ \",[\"$r\",\"strong\",null,{\"children\":\"è¿˜æ²¡æœ‰å‘å¸ƒçš„å®éªŒæ€§ API\"}],\"ã€‚\"]}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"Effect Event çš„å±€é™æ€§åœ¨äºä½ å¦‚ä½•ä½¿ç”¨ä»–ä»¬ï¼š\"}],\"\\n\",[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"åªåœ¨ Effect å†…éƒ¨è°ƒç”¨ä»–ä»¬\"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"æ°¸è¿œä¸è¦æŠŠä»–ä»¬ä¼ ç»™å…¶ä»–çš„ç»„ä»¶æˆ–è€… Hook\"}],\"ã€‚\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ä¾‹å¦‚ä¸è¦åƒè¿™æ ·å£°æ˜å’Œä¼ é€’ Effect Eventï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{4-6,8}\",\"children\":\"function Timer() {\\n  const [count, setCount] = useState(0);\\n\\n  const onTick = useEffectEvent(() => {\\n    setCount(count + 1);\\n  });\\n\\n  useTimer(onTick, 1000); // ğŸ”´ Avoid: ä¼ é€’ Effect Event\\n\\n  return <h1>{count}</h1>\\n}\\n\\nfunction useTimer(callback, delay) {\\n  useEffect(() => {\\n    const id = setInterval(() => {\\n      callback();\\n    }, delay);\\n    return () => {\\n      clearInterval(id);\\n    };\\n  }, [delay, callback]); // éœ€è¦åœ¨ä¾èµ–é¡¹ä¸­æŒ‡å®šâ€œcallbackâ€\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæ°¸è¿œç›´æ¥åœ¨ä½¿ç”¨ä»–ä»¬çš„ Effect æ—è¾¹å£°æ˜ Effect Eventï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{10-12,16,21}\",\"children\":\"function Timer() {\\n  const [count, setCount] = useState(0);\\n  useTimer(() => {\\n    setCount(count + 1);\\n  }, 1000);\\n  return <h1>{count}</h1>\\n}\\n\\nfunction useTimer(callback, delay) {\\n  const onTick = useEffectEvent(() => {\\n    callback();\\n  });\\n\\n  useEffect(() => {\\n    const id = setInterval(() => {\\n      onTick(); // âœ… Good: åªåœ¨ Effect å†…éƒ¨å±€éƒ¨è°ƒç”¨\\n    }, delay);\\n    return () => {\\n      clearInterval(id);\\n    };\\n  }, [delay]); // ä¸éœ€è¦æŒ‡å®š â€œonTickâ€ (Effect Event) ä½œä¸ºä¾èµ–é¡¹\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"Effect Event æ˜¯ Effect ä»£ç çš„éå“åº”å¼â€œç‰‡æ®µâ€ã€‚ä»–ä»¬åº”è¯¥åœ¨ä½¿ç”¨ä»–ä»¬çš„ Effect çš„æ—è¾¹ã€‚\"}],\"\\n\",[\"$r\",\"Recap\",null,{\"children\":[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"äº‹ä»¶å¤„ç†å‡½æ•°åœ¨å“åº”ç‰¹å®šäº¤äº’æ—¶è¿è¡Œã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"Effect åœ¨éœ€è¦åŒæ­¥çš„æ—¶å€™è¿è¡Œã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"äº‹ä»¶å¤„ç†å‡½æ•°å†…éƒ¨çš„é€»è¾‘æ˜¯éå“åº”å¼çš„ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"Effect å†…éƒ¨çš„é€»è¾‘æ˜¯å“åº”å¼çš„ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ä½ å¯ä»¥å°†éå“åº”å¼é€»è¾‘ä» Effect ç§»åˆ° Effect Event ä¸­ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"åªåœ¨ Effect å†…éƒ¨è°ƒç”¨ Effect Eventã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ä¸è¦å°† Effect Event ä¼ ç»™å…¶ä»–ç»„ä»¶æˆ–è€… Hookã€‚\"}],\"\\n\"]}]}],\"\\n\"]}],[\"$r\",\"Challenges\",null,{\"children\":[[\"$r\",\"h4\",null,{\"id\":\"fix-a-variable-that-doesnt-update\",\"children\":\"ä¿®å¤ä¸€ä¸ªä¸æ›´æ–°çš„å˜é‡ \"}],[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"Timer\"}],\" ç»„ä»¶ä¿å­˜äº†ä¸€ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"count\"}],\" çš„ state å˜é‡ï¼Œè¿™ä¸ªå˜é‡æ¯ç§’å¢åŠ ä¸€æ¬¡ã€‚æ¯æ¬¡å¢åŠ çš„å€¼å­˜å‚¨åœ¨ \",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\" state å˜é‡ä¸­ã€‚ä½ å¯ä»¥ä½¿ç”¨åŠ å‡æŒ‰é’®æ§åˆ¶ \",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\" å˜é‡ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"ä½†æ˜¯æ— è®ºä½ ç‚¹å‡»åŠ å·æŒ‰é’®å¤šå°‘æ¬¡ï¼Œè®¡æ•°å™¨æ¯ç§’éƒ½åªå¢åŠ  ï¼‘ã€‚è¿™æ®µä»£ç å­˜åœ¨ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿä¸ºä»€ä¹ˆ Effect å†…éƒ¨çš„ \",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\" æ€»æ˜¯ç­‰äº \",[\"$r\",\"code\",null,{\"children\":\"1\"}],\" å‘¢ï¼Ÿæ‰¾å‡ºé”™è¯¯å¹¶ä¿®å¤å®ƒã€‚\"]}],[\"$r\",\"Hint\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":\"ä¿®å¤è¿™æ®µä»£ç ï¼Œå¿…é¡»è¶³å¤Ÿéµå¾ªè¿™äº›è§„åˆ™ã€‚\"}]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\n\\nexport default function Timer() {\\n  const [count, setCount] = useState(0);\\n  const [increment, setIncrement] = useState(1);\\n\\n  useEffect(() => {\\n    const id = setInterval(() => {\\n      setCount(c => c + increment);\\n    }, 1000);\\n    return () => {\\n      clearInterval(id);\\n    };\\n    // eslint-disable-next-line react-hooks/exhaustive-deps\\n  }, []);\\n\\n  return (\\n    <>\\n      <h1>\\n        Counter: {count}\\n        <button onClick={() => setCount(0)}>Reset</button>\\n      </h1>\\n      <hr />\\n      <p>\\n        Every second, increment by:\\n        <button disabled={increment === 0} onClick={() => {\\n          setIncrement(i => i - 1);\\n        }}>â€“</button>\\n        <b>{increment}</b>\\n        <button onClick={() => {\\n          setIncrement(i => i + 1);\\n        }}>+</button>\\n      </p>\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 10px; }\\n\"}]}]]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":\"å’Œå¾€å¸¸ä¸€æ ·ï¼Œå½“ä½ å¯»æ‰¾ Effect ä¸­çš„ bug æ—¶ï¼Œä»å¯»æ‰¾ä»£ç æ£€æŸ¥æŠ‘åˆ¶å¼€å§‹ã€‚\"}],[\"$r\",\"p\",null,{\"children\":[\"å¦‚æœä½ ç§»é™¤äº†æŠ‘åˆ¶æ³¨é‡Šï¼ŒReact å°±ä¼šå‘Šè¯‰ä½ è¿™ä¸ª Effect çš„ä»£ç ä¾èµ–äº \",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\"ï¼Œä½†æ˜¯ä½ é€šè¿‡å®£ç§°è¿™ä¸ª Effect ä¸ä¾èµ–äºå“åº”å¼å€¼ï¼ˆ\",[\"$r\",\"code\",null,{\"children\":\"[]\"}],\"ï¼‰â€œæ¬ºéª—â€äº† Reactã€‚å°† \",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\" æ·»åŠ åˆ°ä¾èµ–é¡¹æ•°ç»„ï¼š\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\n\\nexport default function Timer() {\\n  const [count, setCount] = useState(0);\\n  const [increment, setIncrement] = useState(1);\\n\\n  useEffect(() => {\\n    const id = setInterval(() => {\\n      setCount(c => c + increment);\\n    }, 1000);\\n    return () => {\\n      clearInterval(id);\\n    };\\n  }, [increment]);\\n\\n  return (\\n    <>\\n      <h1>\\n        Counter: {count}\\n        <button onClick={() => setCount(0)}>Reset</button>\\n      </h1>\\n      <hr />\\n      <p>\\n        Every second, increment by:\\n        <button disabled={increment === 0} onClick={() => {\\n          setIncrement(i => i - 1);\\n        }}>â€“</button>\\n        <b>{increment}</b>\\n        <button onClick={() => {\\n          setIncrement(i => i + 1);\\n        }}>+</button>\\n      </p>\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 10px; }\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":[\"ç°åœ¨å½“ \",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\" å˜åŒ–æ—¶ï¼ŒReact ä¼šé‡æ–°åŒæ­¥ä½ çš„ Effectï¼Œè¿™ä¼šé‡å¯ intervalã€‚\"]}]]}],[\"$r\",\"h4\",null,{\"id\":\"fix-a-freezing-counter\",\"children\":\"ä¿®å¤ä¸€ä¸ªå†»ç»“çš„è®¡æ•°å™¨ \"}],[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"Timer\"}],\" ç»„ä»¶ä¿å­˜äº†ä¸€ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"count\"}],\" çš„ state å˜é‡ï¼Œè¿™ä¸ªå˜é‡æ¯ç§’å¢åŠ ä¸€æ¬¡ã€‚æ¯æ¬¡å¢åŠ çš„å€¼å­˜å‚¨åœ¨ \",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\" state å˜é‡ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨åŠ å‡æŒ‰é’®æ§åˆ¶å®ƒã€‚ä¾‹å¦‚ï¼Œå°è¯•ç‚¹å‡»åŠ å·æŒ‰é’®ä¹æ¬¡ï¼Œæ³¨æ„ç°åœ¨ \",[\"$r\",\"code\",null,{\"children\":\"count\"}],\" æ¯æ¬¡éƒ½å¢åŠ  10 è€Œä¸æ˜¯ 1ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"è¿™ä¸ªç”¨æˆ·æ¥å£æœ‰ä¸€ä¸ªå°é—®é¢˜ã€‚ä½ å¯èƒ½æ³¨æ„åˆ°å¦‚æœä½ æ¯ç§’å†…æŒ‰å‹åŠ å‡æŒ‰é’®ä¸æ­¢ä¸€æ¬¡ï¼Œ é‚£è®¡æ—¶å™¨æœ¬èº«ä¼¼ä¹å°±ä¼šæš‚åœã€‚å®ƒåªåœ¨ä½ æœ€åä¸€æ¬¡æŒ‰å‹æŒ‰é’®çš„ä¸€ç§’åæ¢å¤ã€‚æ‰¾å‡ºä¸ºä»€ä¹ˆä¼šå‘ç”Ÿè¿™ç§ç°è±¡ï¼Œå¹¶ä¿®å¤å®ƒä»¥ä¾¿è®¡æ—¶å™¨èƒ½ \",[\"$r\",\"strong\",null,{\"children\":\"æ¯\"}],\" ç§’æ»´ç­”ä½œå“è€Œä¸ä¸­æ–­ã€‚\"]}],[\"$r\",\"Hint\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":[\"ä¼¼ä¹è®¾ç½®è®¡æ—¶å™¨çš„ Effect å¯¹ \",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\" å€¼çš„å˜åŒ–åšå‡ºäº†â€œå“åº”â€ã€‚ä¸ºäº†è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"setCount\"}],\" è€Œä½¿ç”¨å½“å‰ \",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\" å€¼çš„ä»£ç è¡ŒçœŸçš„éœ€è¦æ˜¯å“åº”å¼å—ï¼Ÿ\"]}]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"experimental\\\",\\n    \\\"react-dom\\\": \\\"experimental\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { experimental_useEffectEvent as useEffectEvent } from 'react';\\n\\nexport default function Timer() {\\n  const [count, setCount] = useState(0);\\n  const [increment, setIncrement] = useState(1);\\n\\n  useEffect(() => {\\n    const id = setInterval(() => {\\n      setCount(c => c + increment);\\n    }, 1000);\\n    return () => {\\n      clearInterval(id);\\n    };\\n  }, [increment]);\\n\\n  return (\\n    <>\\n      <h1>\\n        Counter: {count}\\n        <button onClick={() => setCount(0)}>Reset</button>\\n      </h1>\\n      <hr />\\n      <p>\\n        Every second, increment by:\\n        <button disabled={increment === 0} onClick={() => {\\n          setIncrement(i => i - 1);\\n        }}>â€“</button>\\n        <b>{increment}</b>\\n        <button onClick={() => {\\n          setIncrement(i => i + 1);\\n        }}>+</button>\\n      </p>\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 10px; }\\n\"}]}]]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"é—®é¢˜åœ¨äº Effect å†…éƒ¨çš„ä»£ç ä½¿ç”¨äº† \",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\" è¿™ä¸ª state å˜é‡ã€‚å› ä¸ºå®ƒæ˜¯ Effect çš„ä¸€ä¸ªä¾èµ–é¡¹ï¼Œæ¯æ¬¡ \",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\" å˜åŒ–éƒ½ä¼šå¼•èµ· Effect é‡æ–°åŒæ­¥ï¼Œè¿™å¼•èµ·äº† interval æ¸…ç†ã€‚å¦‚æœä½ æ¯æ¬¡æœ‰æœºä¼šè§¦å‘ä¹‹å‰å°±æ¸…ç† intervalï¼Œå®ƒä¼šè¡¨ç°å¾—å¥½åƒè®¡æ—¶å™¨å·²ç»åœæ­¢äº†ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦ä» Effect ä¸­æå–ä¸€ä¸ª Effect Event \",[\"$r\",\"code\",null,{\"children\":\"onTick\"}],\"ï¼š\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"experimental\\\",\\n    \\\"react-dom\\\": \\\"experimental\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { experimental_useEffectEvent as useEffectEvent } from 'react';\\n\\nexport default function Timer() {\\n  const [count, setCount] = useState(0);\\n  const [increment, setIncrement] = useState(1);\\n\\n  const onTick = useEffectEvent(() => {\\n    setCount(c => c + increment);\\n  });\\n\\n  useEffect(() => {\\n    const id = setInterval(() => {\\n      onTick();\\n    }, 1000);\\n    return () => {\\n      clearInterval(id);\\n    };\\n  }, []);\\n\\n  return (\\n    <>\\n      <h1>\\n        Counter: {count}\\n        <button onClick={() => setCount(0)}>Reset</button>\\n      </h1>\\n      <hr />\\n      <p>\\n        Every second, increment by:\\n        <button disabled={increment === 0} onClick={() => {\\n          setIncrement(i => i - 1);\\n        }}>â€“</button>\\n        <b>{increment}</b>\\n        <button onClick={() => {\\n          setIncrement(i => i + 1);\\n        }}>+</button>\\n      </p>\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 10px; }\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":[\"ç”±äº \",[\"$r\",\"code\",null,{\"children\":\"onTick\"}],\" æ˜¯ä¸€ä¸ª Effect Eventï¼Œæ‰€ä»¥å†…éƒ¨çš„ä»£ç æ˜¯éå“åº”å¼çš„ã€‚\",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\" çš„å˜åŒ–ä¸ä¼šè§¦å‘ä»»ä½• Effectã€‚\"]}]]}],[\"$r\",\"h4\",null,{\"id\":\"fix-a-non-adjustable-delay\",\"children\":\"ä¿®å¤ä¸å¯è°ƒæ•´çš„å»¶è¿Ÿ \"}],[\"$r\",\"p\",null,{\"children\":[\"åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰ interval å»¶è¿Ÿã€‚å®ƒè¢«å‚¨å­˜åœ¨ä¸€ä¸ªç”±ä¸¤ä¸ªæŒ‰é’®æ›´æ–°çš„ \",[\"$r\",\"code\",null,{\"children\":\"delay\"}],\" state å˜é‡ä¸­ã€‚ä½†ä½ å³ä½¿æŒ‰äº†â€œåŠ  100 msâ€æŒ‰é’®åˆ° \",[\"$r\",\"code\",null,{\"children\":\"delay\"}],\" ä¸º 1000 æ¯«ç§’ï¼ˆå³ 1 ç§’ï¼‰ï¼Œå¯ä»¥æ³¨æ„åˆ°è®¡æ—¶å™¨ä»ç„¶åœ¨å¿«é€Ÿå¢åŠ ï¼ˆæ¯ 100 msï¼‰ã€‚ä½ å¯¹ \",[\"$r\",\"code\",null,{\"children\":\"delay\"}],\" çš„ä¿®æ”¹å¥½åƒè¢«å¿½ç•¥äº†ã€‚æ‰¾åˆ°å¹¶ä¿®å¤è¿™ä¸ª bugã€‚\"]}],[\"$r\",\"Hint\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":[\"Effect Event å†…éƒ¨çš„ä»£ç æ˜¯éå“åº”å¼çš„ã€‚å“ªäº›æƒ…å†µä¸‹ä½ ä¼š \",[\"$r\",\"strong\",null,{\"children\":\"æƒ³è¦\"}],\" \",[\"$r\",\"code\",null,{\"children\":\"setInterval\"}],\" è°ƒç”¨é‡æ–°è¿è¡Œå‘¢ï¼Ÿ\"]}]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"experimental\\\",\\n    \\\"react-dom\\\": \\\"experimental\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { experimental_useEffectEvent as useEffectEvent } from 'react';\\n\\nexport default function Timer() {\\n  const [count, setCount] = useState(0);\\n  const [increment, setIncrement] = useState(1);\\n  const [delay, setDelay] = useState(100);\\n\\n  const onTick = useEffectEvent(() => {\\n    setCount(c => c + increment);\\n  });\\n\\n  const onMount = useEffectEvent(() => {\\n    return setInterval(() => {\\n      onTick();\\n    }, delay);\\n  });\\n\\n  useEffect(() => {\\n    const id = onMount();\\n    return () => {\\n      clearInterval(id);\\n    }\\n  }, []);\\n\\n  return (\\n    <>\\n      <h1>\\n        Counter: {count}\\n        <button onClick={() => setCount(0)}>Reset</button>\\n      </h1>\\n      <hr />\\n      <p>\\n        Increment by:\\n        <button disabled={increment === 0} onClick={() => {\\n          setIncrement(i => i - 1);\\n        }}>â€“</button>\\n        <b>{increment}</b>\\n        <button onClick={() => {\\n          setIncrement(i => i + 1);\\n        }}>+</button>\\n      </p>\\n      <p>\\n        Increment delay:\\n        <button disabled={delay === 100} onClick={() => {\\n          setDelay(d => d - 100);\\n        }}>â€“100 ms</button>\\n        <b>{delay} ms</b>\\n        <button onClick={() => {\\n          setDelay(d => d + 100);\\n        }}>+100 ms</button>\\n      </p>\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 10px; }\\n\"}]}]]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"ä¸Šé¢è¿™ä¸ªç¤ºä¾‹çš„é—®é¢˜åœ¨äºå®ƒæ²¡æœ‰è€ƒè™‘ä»£ç å®é™…æ­£åœ¨åšä»€ä¹ˆå°±ç›´æ¥æå–äº†ä¸€ä¸ªå«åš \",[\"$r\",\"code\",null,{\"children\":\"onMount\"}],\" çš„ Effect Eventã€‚ä½ åº”è¯¥åªä¸ºç‰¹å®šçš„åŸå› æå– Effect Eventï¼šä½ æƒ³è®©ä»£ç çš„ä¸€éƒ¨åˆ†ç§°ä¸ºéå“åº”å¼ã€‚ä½†æ˜¯ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"setInterval\"}],\" è°ƒç”¨ state å˜é‡ \",[\"$r\",\"code\",null,{\"children\":\"delay\"}],\" çš„å˜åŒ– \",[\"$r\",\"strong\",null,{\"children\":\"åº”è¯¥\"}],\" æ˜¯å“åº”å¼çš„ã€‚å¦‚æœ \",[\"$r\",\"code\",null,{\"children\":\"delay\"}],\" å˜åŒ–äº†ï¼Œä½ æƒ³è¦é‡æ–°è®¾ç½® intervalï¼ä¸ºäº†ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œä½ éœ€è¦å°†æ‰€æœ‰çš„å“åº”å¼ä»£ç æ”¾å›åˆ° Effect å†…éƒ¨ï¼š\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"experimental\\\",\\n    \\\"react-dom\\\": \\\"experimental\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { experimental_useEffectEvent as useEffectEvent } from 'react';\\n\\nexport default function Timer() {\\n  const [count, setCount] = useState(0);\\n  const [increment, setIncrement] = useState(1);\\n  const [delay, setDelay] = useState(100);\\n\\n  const onTick = useEffectEvent(() => {\\n    setCount(c => c + increment);\\n  });\\n\\n  useEffect(() => {\\n    const id = setInterval(() => {\\n      onTick();\\n    }, delay);\\n    return () => {\\n      clearInterval(id);\\n    }\\n  }, [delay]);\\n\\n  return (\\n    <>\\n      <h1>\\n        Counter: {count}\\n        <button onClick={() => setCount(0)}>Reset</button>\\n      </h1>\\n      <hr />\\n      <p>\\n        Increment by:\\n        <button disabled={increment === 0} onClick={() => {\\n          setIncrement(i => i - 1);\\n        }}>â€“</button>\\n        <b>{increment}</b>\\n        <button onClick={() => {\\n          setIncrement(i => i + 1);\\n        }}>+</button>\\n      </p>\\n      <p>\\n        Increment delay:\\n        <button disabled={delay === 100} onClick={() => {\\n          setDelay(d => d - 100);\\n        }}>â€“100 ms</button>\\n        <b>{delay} ms</b>\\n        <button onClick={() => {\\n          setDelay(d => d + 100);\\n        }}>+100 ms</button>\\n      </p>\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 10px; }\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":[\"æ€»çš„æ¥è¯´ï¼Œä½ åº”è¯¥å¯¹åƒ \",[\"$r\",\"code\",null,{\"children\":\"onMount\"}],\" è¿™æ ·ä¸»è¦å…³æ³¨ \",[\"$r\",\"strong\",null,{\"children\":\"æ‰§è¡Œæ—¶æœº\"}],\" è€Œé \",[\"$r\",\"strong\",null,{\"children\":\"ç›®çš„\"}],\" çš„å‡½æ•°æŒæœ‰æ€€ç–‘æ€åº¦ã€‚å¼€å§‹å¯èƒ½ä¼šæ„Ÿè§‰â€œæ›´å…·æè¿°æ€§â€ï¼Œä½†æ˜¯å¯èƒ½ä¼šæ¨¡ç³Šä½ çš„æ„å›¾ã€‚æ ¹æ®ç»éªŒæ¥è¯´ï¼ŒEffect Event åº”è¯¥å¯¹åº”ä»â€œç”¨æˆ·çš„â€è§’åº¦å‘ç”Ÿçš„äº‹æƒ…ã€‚ä¾‹å¦‚ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"onMessage\"}],\"ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"onTick\"}],\"ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"onVisit\"}],\" æˆ–è€… \",[\"$r\",\"code\",null,{\"children\":\"onConnected\"}],\" æ˜¯ä¼˜ç§€çš„ Effect Event åç§°ã€‚å®ƒä»¬å†…éƒ¨çš„ä»£ç å¯èƒ½ä¸éœ€è¦æ˜¯å“åº”å¼çš„ã€‚å¦ä¸€æ–¹é¢ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"onMount\"}],\"ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"onUpdate\"}],\"ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"onUnmount\"}],\" æˆ–è€… \",[\"$r\",\"code\",null,{\"children\":\"onAfterRender\"}],\" å¤ªé€šç”¨äº†ï¼Œä»¥è‡³äºå¾ˆå®¹æ˜“ä¸å°å¿ƒå°±æŠŠä¸€äº›â€åº”è¯¥â€æ˜¯å“åº”å¼çš„ä»£ç æ”¾å…¥å…¶ä¸­ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ åº”è¯¥ç”¨ \",[\"$r\",\"strong\",null,{\"children\":\"ç”¨æˆ·æƒ³è¦ä»€ä¹ˆå‘ç”Ÿ\"}],\" æ¥ç»™ä½ çš„ Effect Event å‘½åï¼Œè€Œä¸æ˜¯ç”¨æŸäº›ä»£ç æ­£å¥½è¿è¡Œçš„æ—¶æœºå‘½åã€‚\"]}]]}],[\"$r\",\"h4\",null,{\"id\":\"fix-a-delayed-notification\",\"children\":\"ä¿®å¤å»¶è¿Ÿé€šçŸ¥ \"}],[\"$r\",\"p\",null,{\"children\":\"å½“ä½ åŠ å…¥ä¸€ä¸ªèŠå¤©å®¤æ—¶ï¼Œè¿™ä¸ªç»„ä»¶å±•ç¤ºä¸€ä¸ªé€šçŸ¥ã€‚ä½†æ˜¯å®ƒä¸ä¼šç«‹åˆ»å±•ç¤ºé€šçŸ¥ã€‚ç›¸åï¼ŒæŠŠé€šçŸ¥äººå·¥å»¶è¿Ÿ 2 ç§’é’Ÿï¼Œä»¥ä¾¿ç”¨æˆ·æœ‰æœºä¼šæŸ¥çœ‹ UIã€‚\"}],[\"$r\",\"p\",null,{\"children\":[\"è¿™å‡ ä¹ç”Ÿæ•ˆäº†ï¼Œä½†è¿˜æ˜¯æœ‰ä¸€ä¸ª bugã€‚å°è¯•å°†ä¸‹æ‹‰èœå•ä»â€œgeneralâ€å˜æˆâ€œtravelâ€å¹¶ä¸”æ¥ä¸‹æ¥éå¸¸å¿«é€Ÿçš„å˜æˆâ€œmusicâ€ã€‚å¦‚æœä½ åŠ¨ä½œè¶³å¤Ÿå¿«ï¼Œä½ ä¼šçœ‹åˆ°ä¸¤ä¸ªé€šçŸ¥ï¼ˆå’Œé¢„æœŸä¸€æ ·ï¼ï¼‰ï¼Œä½†æ˜¯ä»–ä»¬ \",[\"$r\",\"strong\",null,{\"children\":\"éƒ½æ˜¯\"}],\" å±•ç¤º â€œWelcome to musicâ€ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"ä¿®å¤å®ƒï¼Œè®©å®ƒèƒ½åœ¨ä½ å¿«é€Ÿä»â€œgeneralâ€åˆ‡æ¢åˆ°â€œtravelâ€å†åˆ°â€œmusicâ€çš„æ—¶å€™çœ‹è§ä¸¤ä¸ªé€šçŸ¥ï¼Œç¬¬ä¸€ä¸ªæ˜¯â€œWelcome to travelâ€ ï¼Œç¬¬äºŒä¸ªæ˜¯â€œWelcome to musicâ€ï¼ˆæœ‰ä¸€ä¸ªé¢å¤–çš„æŒ‘æˆ˜ï¼Œå‡è®¾ä½  \",[\"$r\",\"strong\",null,{\"children\":\"å·²ç»\"}],\" è®©é€šçŸ¥æ˜¾ç¤ºäº†æ­£ç¡®çš„æˆ¿é—´ï¼Œè¯·ä¿®æ”¹ä»£ç åªå±•ç¤ºåé¢çš„é€šçŸ¥ï¼‰ã€‚\"]}],[\"$r\",\"Hint\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":\"ä½ çš„ Effect çŸ¥é“å®ƒè¿æ¥çš„æ˜¯å“ªä¸€ä¸ªæˆ¿é—´ã€‚æœ‰ä»»ä½•ä½ å¯èƒ½æƒ³è¦ä¼ ç»™ Effect Event çš„ä¿¡æ¯å—ï¼Ÿ\"}]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"experimental\\\",\\n    \\\"react-dom\\\": \\\"experimental\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\",\\n    \\\"toastify-js\\\": \\\"1.12.0\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { experimental_useEffectEvent as useEffectEvent } from 'react';\\nimport { createConnection, sendMessage } from './chat.js';\\nimport { showNotification } from './notifications.js';\\n\\nconst serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId, theme }) {\\n  const onConnected = useEffectEvent(() => {\\n    showNotification('Welcome to ' + roomId, theme);\\n  });\\n\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.on('connected', () => {\\n      setTimeout(() => {\\n        onConnected();\\n      }, 2000);\\n    });\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId]);\\n\\n  return <h1>Welcome to the {roomId} room!</h1>\\n}\\n\\nexport default function App() {\\n  const [roomId, setRoomId] = useState('general');\\n  const [isDark, setIsDark] = useState(false);\\n  return (\\n    <>\\n      <label>\\n        Choose the chat room:{' '}\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"general\\\">general</option>\\n          <option value=\\\"travel\\\">travel</option>\\n          <option value=\\\"music\\\">music</option>\\n        </select>\\n      </label>\\n      <label>\\n        <input\\n          type=\\\"checkbox\\\"\\n          checked={isDark}\\n          onChange={e => setIsDark(e.target.checked)}\\n        />\\n        Use dark theme\\n      </label>\\n      <hr />\\n      <ChatRoom\\n        roomId={roomId}\\n        theme={isDark ? 'dark' : 'light'}\\n      />\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection(serverUrl, roomId) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  let connectedCallback;\\n  let timeout;\\n  return {\\n    connect() {\\n      timeout = setTimeout(() => {\\n        if (connectedCallback) {\\n          connectedCallback();\\n        }\\n      }, 100);\\n    },\\n    on(event, callback) {\\n      if (connectedCallback) {\\n        throw Error('Cannot add the handler twice.');\\n      }\\n      if (event !== 'connected') {\\n        throw Error('Only \\\"connected\\\" event is supported.');\\n      }\\n      connectedCallback = callback;\\n    },\\n    disconnect() {\\n      clearTimeout(timeout);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/notifications.js hidden\",\"children\":\"import Toastify from 'toastify-js';\\nimport 'toastify-js/src/toastify.css';\\n\\nexport function showNotification(message, theme) {\\n  Toastify({\\n    text: message,\\n    duration: 2000,\\n    gravity: 'top',\\n    position: 'right',\\n    style: {\\n      background: theme === 'dark' ? 'black' : 'white',\\n      color: theme === 'dark' ? 'white' : 'black',\\n    },\\n  }).showToast();\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label { display: block; margin-top: 10px; }\\n\"}]}]]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"åœ¨ Effect Event å†…éƒ¨ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" æ˜¯ \",[\"$r\",\"strong\",null,{\"children\":\"Effect Event è¢«è°ƒç”¨æ—¶åˆ»\"}],\" çš„å€¼ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"Effect Event ä¼´éšç€ä¸¤ç§’çš„å»¶è¿Ÿè¢«è°ƒç”¨ã€‚å¦‚æœä½ å¿«é€Ÿåœ°ä» travel åˆ‡æ¢åˆ° music èŠå¤©å®¤ï¼Œç›´åˆ° travel èŠå¤©å®¤çš„é€šçŸ¥æ˜¾ç¤ºå‡ºæ¥ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" å·²ç»æ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"â€œmusicâ€\"}],\" äº†ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸¤ä¸ªé€šçŸ¥éƒ½æ˜¯ â€œWelcome to musicâ€ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"ä¸ºäº†ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œä¸è¦åœ¨ Effect Event é‡Œé¢è¯»å– \",[\"$r\",\"strong\",null,{\"children\":\"æœ€æ–°çš„\"}],\" \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\"ï¼Œè€Œæ˜¯å¦‚åŒä¸‹é¢çš„ \",[\"$r\",\"code\",null,{\"children\":\"connectedRoomId\"}],\" ä¸€æ ·è®©å®ƒæˆä¸º Effect Event çš„å‚æ•°ã€‚ç„¶åé€šè¿‡è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"onConnected(roomId)\"}],\" å°† \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" ä» Effect ä¸­ä¼ å…¥ï¼š\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"experimental\\\",\\n    \\\"react-dom\\\": \\\"experimental\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\",\\n    \\\"toastify-js\\\": \\\"1.12.0\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { experimental_useEffectEvent as useEffectEvent } from 'react';\\nimport { createConnection, sendMessage } from './chat.js';\\nimport { showNotification } from './notifications.js';\\n\\nconst serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId, theme }) {\\n  const onConnected = useEffectEvent(connectedRoomId => {\\n    showNotification('Welcome to ' + connectedRoomId, theme);\\n  });\\n\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.on('connected', () => {\\n      setTimeout(() => {\\n        onConnected(roomId);\\n      }, 2000);\\n    });\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId]);\\n\\n  return <h1>Welcome to the {roomId} room!</h1>\\n}\\n\\nexport default function App() {\\n  const [roomId, setRoomId] = useState('general');\\n  const [isDark, setIsDark] = useState(false);\\n  return (\\n    <>\\n      <label>\\n        Choose the chat room:{' '}\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"general\\\">general</option>\\n          <option value=\\\"travel\\\">travel</option>\\n          <option value=\\\"music\\\">music</option>\\n        </select>\\n      </label>\\n      <label>\\n        <input\\n          type=\\\"checkbox\\\"\\n          checked={isDark}\\n          onChange={e => setIsDark(e.target.checked)}\\n        />\\n        Use dark theme\\n      </label>\\n      <hr />\\n      <ChatRoom\\n        roomId={roomId}\\n        theme={isDark ? 'dark' : 'light'}\\n      />\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection(serverUrl, roomId) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  let connectedCallback;\\n  let timeout;\\n  return {\\n    connect() {\\n      timeout = setTimeout(() => {\\n        if (connectedCallback) {\\n          connectedCallback();\\n        }\\n      }, 100);\\n    },\\n    on(event, callback) {\\n      if (connectedCallback) {\\n        throw Error('Cannot add the handler twice.');\\n      }\\n      if (event !== 'connected') {\\n        throw Error('Only \\\"connected\\\" event is supported.');\\n      }\\n      connectedCallback = callback;\\n    },\\n    disconnect() {\\n      clearTimeout(timeout);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/notifications.js hidden\",\"children\":\"import Toastify from 'toastify-js';\\nimport 'toastify-js/src/toastify.css';\\n\\nexport function showNotification(message, theme) {\\n  Toastify({\\n    text: message,\\n    duration: 2000,\\n    gravity: 'top',\\n    position: 'right',\\n    style: {\\n      background: theme === 'dark' ? 'black' : 'white',\\n      color: theme === 'dark' ? 'white' : 'black',\\n    },\\n  }).showToast();\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label { display: block; margin-top: 10px; }\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":[\"å°† \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" è®¾ç½®ä¸º \",[\"$r\",\"code\",null,{\"children\":\"â€œtravelâ€\"}],\"ï¼ˆæ‰€ä»¥å®ƒè¿æ¥åˆ°äº† \",[\"$r\",\"code\",null,{\"children\":\"â€œtravelâ€\"}],\" èŠå¤©å®¤ï¼‰çš„ Effect å°†ä¼šå±•ç¤º \",[\"$r\",\"code\",null,{\"children\":\"â€œtravelâ€\"}],\" çš„é€šçŸ¥ã€‚å°† \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" è®¾ç½®ä¸º \",[\"$r\",\"code\",null,{\"children\":\"â€œmusicâ€\"}],\"ï¼ˆæ‰€ä»¥å®ƒè¿æ¥åˆ°äº† \",[\"$r\",\"code\",null,{\"children\":\"â€œmusicâ€\"}],\" èŠå¤©å®¤ï¼‰çš„ Effect å°†ä¼šå±•ç¤º \",[\"$r\",\"code\",null,{\"children\":\"\\\"music\\\"\"}],\" çš„é€šçŸ¥ã€‚æ¢è¨€ä¹‹ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"connectedRoomId\"}],\" æ¥è‡ª Effectï¼ˆæ˜¯å“åº”å¼çš„ï¼‰ï¼Œè€Œ \",[\"$r\",\"code\",null,{\"children\":\"theme\"}],\" æ€»æ˜¯ä½¿ç”¨æœ€æ–°å€¼ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":\"ä¸ºäº†è§£å†³é¢å¤–çš„æŒ‘æˆ˜ï¼Œä¿å­˜é€šçŸ¥çš„ timeout IDï¼Œå¹¶åœ¨ Effect çš„æ¸…ç†å‡½æ•°ä¸­è¿›è¡Œæ¸…ç†ï¼š\"}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"experimental\\\",\\n    \\\"react-dom\\\": \\\"experimental\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\",\\n    \\\"toastify-js\\\": \\\"1.12.0\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { experimental_useEffectEvent as useEffectEvent } from 'react';\\nimport { createConnection, sendMessage } from './chat.js';\\nimport { showNotification } from './notifications.js';\\n\\nconst serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId, theme }) {\\n  const onConnected = useEffectEvent(connectedRoomId => {\\n    showNotification('Welcome to ' + connectedRoomId, theme);\\n  });\\n\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    let notificationTimeoutId;\\n    connection.on('connected', () => {\\n      notificationTimeoutId = setTimeout(() => {\\n        onConnected(roomId);\\n      }, 2000);\\n    });\\n    connection.connect();\\n    return () => {\\n      connection.disconnect();\\n      if (notificationTimeoutId !== undefined) {\\n        clearTimeout(notificationTimeoutId);\\n      }\\n    };\\n  }, [roomId]);\\n\\n  return <h1>Welcome to the {roomId} room!</h1>\\n}\\n\\nexport default function App() {\\n  const [roomId, setRoomId] = useState('general');\\n  const [isDark, setIsDark] = useState(false);\\n  return (\\n    <>\\n      <label>\\n        Choose the chat room:{' '}\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"general\\\">general</option>\\n          <option value=\\\"travel\\\">travel</option>\\n          <option value=\\\"music\\\">music</option>\\n        </select>\\n      </label>\\n      <label>\\n        <input\\n          type=\\\"checkbox\\\"\\n          checked={isDark}\\n          onChange={e => setIsDark(e.target.checked)}\\n        />\\n        Use dark theme\\n      </label>\\n      <hr />\\n      <ChatRoom\\n        roomId={roomId}\\n        theme={isDark ? 'dark' : 'light'}\\n      />\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection(serverUrl, roomId) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  let connectedCallback;\\n  let timeout;\\n  return {\\n    connect() {\\n      timeout = setTimeout(() => {\\n        if (connectedCallback) {\\n          connectedCallback();\\n        }\\n      }, 100);\\n    },\\n    on(event, callback) {\\n      if (connectedCallback) {\\n        throw Error('Cannot add the handler twice.');\\n      }\\n      if (event !== 'connected') {\\n        throw Error('Only \\\"connected\\\" event is supported.');\\n      }\\n      connectedCallback = callback;\\n    },\\n    disconnect() {\\n      clearTimeout(timeout);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/notifications.js hidden\",\"children\":\"import Toastify from 'toastify-js';\\nimport 'toastify-js/src/toastify.css';\\n\\nexport function showNotification(message, theme) {\\n  Toastify({\\n    text: message,\\n    duration: 2000,\\n    gravity: 'top',\\n    position: 'right',\\n    style: {\\n      background: theme === 'dark' ? 'black' : 'white',\\n      color: theme === 'dark' ? 'white' : 'black',\\n    },\\n  }).showToast();\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label { display: block; margin-top: 10px; }\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":\"è¿™ç¡®ä¿äº†å½“ä½ ä¿®æ”¹èŠå¤©å®¤æ—¶ï¼Œå·²ç»å®‰æ’å¥½ï¼ˆä½†è¿˜æ²¡å±•ç¤ºï¼‰çš„é€šçŸ¥ä¼šè¢«å–æ¶ˆã€‚\"}]]}]]}]]","meta":{"title":"å°†äº‹ä»¶ä» Effect ä¸­åˆ†å¼€"}},"__N_SSG":true}