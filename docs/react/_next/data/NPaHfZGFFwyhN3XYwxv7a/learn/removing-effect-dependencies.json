{"pageProps":{"toc":"[{\"url\":\"#\",\"text\":\"æ¦‚è§ˆ\",\"depth\":2},{\"url\":\"#dependencies-should-match-the-code\",\"depth\":2,\"text\":\"ä¾èµ–åº”è¯¥å’Œä»£ç ä¿æŒä¸€è‡´ \"},{\"url\":\"#to-remove-a-dependency-prove-that-its-not-a-dependency\",\"depth\":3,\"text\":\"å½“è¦ç§»é™¤ä¸€ä¸ªä¾èµ–æ—¶ï¼Œè¯·è¯æ˜å®ƒä¸æ˜¯ä¸€ä¸ªä¾èµ– \"},{\"url\":\"#to-change-the-dependencies-change-the-code\",\"depth\":3,\"text\":\"è¦æ”¹å˜ä¾èµ–ï¼Œè¯·æ”¹å˜ä»£ç  \"},{\"url\":\"#removing-unnecessary-dependencies\",\"depth\":2,\"text\":\"ç§»é™¤éå¿…éœ€çš„ä¾èµ– \"},{\"url\":\"#should-this-code-move-to-an-event-handler\",\"depth\":3,\"text\":\"è¿™æ®µä»£ç åº”è¯¥ç§»åˆ°äº‹ä»¶å¤„ç†ç¨‹åºä¸­å—ï¼Ÿ \"},{\"url\":\"#is-your-effect-doing-several-unrelated-things\",\"depth\":3,\"text\":\"Effect æ˜¯å¦åœ¨åšå‡ ä»¶ä¸ç›¸å…³çš„äº‹æƒ…ï¼Ÿ \"},{\"url\":\"#are-you-reading-some-state-to-calculate-the-next-state\",\"depth\":3,\"text\":\"æ˜¯å¦åœ¨è¯»å–ä¸€äº›çŠ¶æ€æ¥è®¡ç®—ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Ÿ \"},{\"url\":\"#do-you-want-to-read-a-value-without-reacting-to-its-changes\",\"depth\":3,\"text\":\"ä½ æƒ³è¯»å–ä¸€ä¸ªå€¼è€Œä¸å¯¹å…¶å˜åŒ–åšå‡ºâ€œååº”â€å—ï¼Ÿ \"},{\"url\":\"#does-some-reactive-value-change-unintentionally\",\"depth\":3,\"text\":\"ä¸€äº›å“åº”å¼å€¼æ˜¯å¦æ— æ„ä¸­æ”¹å˜äº†ï¼Ÿ \"},{\"url\":\"#recap\",\"depth\":2,\"text\":\"Recap\"},{\"url\":\"#challenges\",\"depth\":2,\"text\":\"Challenges\"}]","content":"[[\"$r\",\"MaxWidth\",\"12\",{\"children\":[[\"$r\",\"Intro\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":\"å½“ç¼–å†™ Effect æ—¶ï¼Œlinter ä¼šéªŒè¯æ˜¯å¦å·²ç»å°† Effect è¯»å–çš„æ¯ä¸€ä¸ªå“åº”å¼å€¼ï¼ˆå¦‚ props å’Œ stateï¼‰åŒ…å«åœ¨ Effect çš„ä¾èµ–ä¸­ã€‚è¿™å¯ä»¥ç¡®ä¿ Effect ä¸ç»„ä»¶çš„ props å’Œ state ä¿æŒåŒæ­¥ã€‚ä¸å¿…è¦çš„ä¾èµ–å¯èƒ½ä¼šå¯¼è‡´ Effect è¿è¡Œè¿‡äºé¢‘ç¹ï¼Œç”šè‡³äº§ç”Ÿæ— é™å¾ªç¯ã€‚è¯·æŒ‰ç…§æœ¬æŒ‡å—å®¡æŸ¥å¹¶ç§»é™¤ Effect ä¸­ä¸å¿…è¦çš„ä¾èµ–ã€‚\"}]}],\"\\n\",[\"$r\",\"YouWillLearn\",null,{\"children\":[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ä¿®å¤æ— é™çš„ Effect ä¾èµ–æ€§å¾ªç¯\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"å½“ä½ æƒ³ç§»é™¤ä¾èµ–æ—¶ï¼Œè¯¥æ€ä¹ˆåš\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ä» Effect ä¸­è¯»å–å€¼è€Œä¸å¯¹å®ƒä½œå‡ºâ€œååº”â€\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ä¸ºä»€ä¹ˆä»¥åŠå¦‚ä½•é¿å…å¯¹è±¡å’Œå‡½æ•°çš„ä¾èµ–ï¼Ÿ\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ä¸ºä»€ä¹ˆæŠ‘åˆ¶ä¾èµ–ä»£ç æ£€æŸ¥å™¨çš„æ£€æŸ¥æ˜¯å±é™©çš„ï¼Œä»¥åŠåº”è¯¥å¦‚ä½•åšï¼Ÿ\"}],\"\\n\"]}]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"dependencies-should-match-the-code\",\"children\":\"ä¾èµ–åº”è¯¥å’Œä»£ç ä¿æŒä¸€è‡´ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å½“ä½ ç¼–å†™ Effect æ—¶ï¼Œæ— è®ºè¿™ä¸ª Effect è¦åšä»€ä¹ˆï¼Œä½ é¦–å…ˆè¦æ˜ç¡®å…¶ \",[\"$r\",\"a\",null,{\"href\":\"/learn/lifecycle-of-reactive-effects#the-lifecycle-of-an-effect\",\"children\":\"ç”Ÿå‘½å‘¨æœŸ\"}],\"ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{5-7}\",\"children\":\"const serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId }) {\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  \\t// ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å¦‚æœä½ è®¾ç½® Effect çš„ä¾èµ–æ˜¯ç©ºæ•°ç»„ï¼ˆ\",[\"$r\",\"code\",null,{\"children\":\"[]\"}],\"ï¼‰ï¼Œé‚£ä¹ˆ linter å°†ä¼šå»ºè®®åˆé€‚çš„ä¾èµ–ï¼š\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { createConnection } from './chat.js';\\n\\nconst serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId }) {\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, []); // <-- ä¿®å¤è¿™é‡Œçš„ä¾èµ–ï¼\\n  return <h1>æ¬¢è¿æ¥åˆ° {roomId} æˆ¿é—´ï¼</h1>;\\n}\\n\\nexport default function App() {\\n  const [roomId, setRoomId] = useState('æ‰€æœ‰');\\n  return (\\n    <>\\n      <label>\\n        é€‰æ‹©èŠå¤©å®¤ï¼š\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"æ‰€æœ‰\\\">æ‰€æœ‰</option>\\n          <option value=\\\"æ—…æ¸¸\\\">æ—…æ¸¸</option>\\n          <option value=\\\"éŸ³ä¹\\\">éŸ³ä¹</option>\\n        </select>\\n      </label>\\n      <hr />\\n      <ChatRoom roomId={roomId} />\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection(serverUrl, roomId) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  return {\\n    connect() {\\n      console.log('âœ… è¿æ¥åˆ°â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl + '...');\\n    },\\n    disconnect() {\\n      console.log('âŒ æ–­å¼€â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"input { display: block; margin-bottom: 20px; }\\nbutton { margin-left: 10px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"20\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":\"æŒ‰ç…§ linter çš„å»ºè®®ï¼ŒæŠŠå®ƒä»¬å¡«è¿›å»ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{6}\",\"children\":\"function ChatRoom({ roomId }) {\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"a\",null,{\"href\":\"/learn/lifecycle-of-reactive-effects#effects-react-to-reactive-values\",\"children\":\"Effect â€œååº”â€å“åº”å¼å€¼\"}],\" å› ä¸ºè¿™é‡Œçš„ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" æ˜¯ä¸€ä¸ªå“åº”å¼å€¼ï¼ˆå®ƒå¯èƒ½éšé‡æ–°æ¸²æŸ“è€Œæ”¹å˜ï¼‰ï¼Œæ‰€ä»¥ linter ä¼šéªŒè¯ä½ æ˜¯å¦å°†å®ƒæŒ‡å®šä¸ºä¾èµ–ã€‚å¦‚æœ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" å˜æˆä¸åŒçš„å€¼ï¼ŒReact å°†é‡æ–°è¿è¡Œ Effectã€‚è¿™å¯ä»¥ç¡®ä¿èŠå¤©ç•Œé¢ä¸æ‰€é€‰æˆ¿é—´ä¿æŒä¸€è‡´ï¼Œå¹¶æŠŠå˜åŒ–â€œåé¦ˆâ€ç»™ä¸‹æ‹‰èœå•ï¼š\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { createConnection } from './chat.js';\\n\\nconst serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId }) {\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId]);\\n  return <h1>æ¬¢è¿æ¥åˆ° {roomId} æˆ¿é—´ï¼</h1>;\\n}\\n\\nexport default function App() {\\n  const [roomId, setRoomId] = useState('æ‰€æœ‰');\\n  return (\\n    <>\\n      <label>\\n        é€‰æ‹©èŠå¤©å®¤ï¼š\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"æ‰€æœ‰\\\">æ‰€æœ‰</option>\\n          <option value=\\\"æ—…æ¸¸\\\">æ—…æ¸¸</option>\\n          <option value=\\\"éŸ³ä¹\\\">éŸ³ä¹</option>\\n        </select>\\n      </label>\\n      <hr />\\n      <ChatRoom roomId={roomId} />\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection(serverUrl, roomId) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  return {\\n    connect() {\\n      console.log('âœ… è¿æ¥åˆ°â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl + '...');\\n    },\\n    disconnect() {\\n      console.log('âŒ æ–­å¼€â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"input { display: block; margin-bottom: 20px; }\\nbutton { margin-left: 10px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"40\",{\"children\":[\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"to-remove-a-dependency-prove-that-its-not-a-dependency\",\"children\":\"å½“è¦ç§»é™¤ä¸€ä¸ªä¾èµ–æ—¶ï¼Œè¯·è¯æ˜å®ƒä¸æ˜¯ä¸€ä¸ªä¾èµ– \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æ³¨æ„ï¼Œä½ ä¸èƒ½â€œé€‰æ‹©â€ Effect çš„ä¾èµ–ã€‚æ¯ä¸ªè¢« Effect æ‰€ä½¿ç”¨çš„\",[\"$r\",\"CodeStep\",null,{\"step\":2,\"children\":\"å“åº”å¼å€¼\"}],\"ï¼Œå¿…é¡»åœ¨ä¾èµ–ä¸­å£°æ˜ã€‚ä¾èµ–æ˜¯ç”± Effect çš„ä»£ç å†³å®šçš„ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"[[2, 3, \\\"roomId\\\"], [2, 5, \\\"roomId\\\"], [2, 8, \\\"roomId\\\"]]\",\"children\":\"const serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId }) { // è¿™æ˜¯ä¸€ä¸ªå“åº”å¼å€¼\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId); // Effect åœ¨è¿™é‡Œè¯»å–å“åº”å¼å€¼\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId]); // âœ… æ‰€ä»¥ä½ å¿…é¡»åœ¨ä¾èµ–ä¸­å£°æ˜ Effect ä½¿ç”¨çš„å“åº”å¼å€¼\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"a\",null,{\"href\":\"/learn/lifecycle-of-reactive-effects#all-variables-declared-in-the-component-body-are-reactive\",\"children\":\"å“åº”å¼å€¼\"}],\" åŒ…æ‹¬ props ä»¥åŠæ‰€æœ‰ä½ ç›´æ¥åœ¨ç»„ä»¶ä¸­å£°æ˜çš„å˜é‡å’Œå‡½æ•°ã€‚ç”±äº \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" æ˜¯å“åº”å¼å€¼ï¼Œä½ ä¸èƒ½æŠŠå®ƒä»ä¾èµ–ä¸­ç§»é™¤ã€‚linter ä¸å…è®¸è¿™æ ·åšï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{8}\",\"children\":\"const serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId }) {\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, []); // ğŸ”´ React Hook useEffect ç¼ºå¤±ä¾èµ–: 'roomId'\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"linter æ˜¯å¯¹çš„ï¼ ç”±äº \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" å¯èƒ½ä¼šéšæ—¶é—´å˜åŒ–ï¼Œè¿™ä¼šåœ¨ä»£ç ä¸­å¼•å…¥é”™è¯¯ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"ç§»é™¤ä¸€ä¸ªä¾èµ–ï¼Œä½ éœ€è¦å‘ linter è¯æ˜å…¶ä¸éœ€è¦è¿™ä¸ªä¾èµ–\"}],\"ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°† \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" ç§»å‡ºç»„ä»¶ï¼Œä»¥è¯æ˜å®ƒä¸æ˜¯å“åº”çš„ï¼Œä¹Ÿä¸ä¼šåœ¨é‡æ–°æ¸²æŸ“æ—¶æ”¹å˜ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2,9}\",\"children\":\"const serverUrl = 'https://localhost:1234';\\nconst roomId = 'éŸ³ä¹'; // ä¸å†æ˜¯å“åº”å¼å€¼\\n\\nfunction ChatRoom() {\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, []); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç°åœ¨ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" ä¸æ˜¯å“åº”å¼å€¼ï¼ˆå¹¶ä¸”ä¸èƒ½åœ¨é‡æ–°æ¸²æŸ“æ—¶æ”¹å˜ï¼‰ï¼Œé‚£å®ƒä¸å°±ä¸æ˜¯ä¾èµ–ï¼š\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { createConnection } from './chat.js';\\n\\nconst serverUrl = 'https://localhost:1234';\\nconst roomId = 'éŸ³ä¹';\\n\\nexport default function ChatRoom() {\\n  useEffect(() => {\\n    const connection = createConnection(serverUrl, roomId);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, []);\\n  return <h1>æ¬¢è¿æ¥åˆ° {roomId} æˆ¿é—´ï¼</h1>;\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection(serverUrl, roomId) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  return {\\n    connect() {\\n      console.log('âœ… è¿æ¥åˆ°â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl + '...');\\n    },\\n    disconnect() {\\n      console.log('âŒ æ–­å¼€â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"input { display: block; margin-bottom: 20px; }\\nbutton { margin-left: 10px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"192\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ ç°åœ¨å¯ä»¥æŒ‡å®š \",[\"$r\",\"a\",null,{\"href\":\"/learn/lifecycle-of-reactive-effects#what-an-effect-with-empty-dependencies-means\",\"children\":[\"ç©ºï¼ˆ\",[\"$r\",\"code\",null,{\"children\":\"[]\"}],\"ï¼‰ä¾èµ–\"]}],\"ã€‚Effect \",[\"$r\",\"strong\",null,{\"children\":\"çœŸçš„ä¸\"}],\" ä¾èµ–ä»»ä½•å“åº”å¼å€¼äº†ï¼Œä¹Ÿ \",[\"$r\",\"strong\",null,{\"children\":\"çœŸçš„ä¸\"}],\" éœ€è¦åœ¨ç»„ä»¶çš„ props æˆ– state æ”¹å˜æ—¶é‡æ–°è¿è¡Œã€‚\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"to-change-the-dependencies-change-the-code\",\"children\":\"è¦æ”¹å˜ä¾èµ–ï¼Œè¯·æ”¹å˜ä»£ç  \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°å·¥ä½œæµç¨‹ä¸­æœ‰ä¸€ä¸ªæ¨¡å¼ï¼š\"}],\"\\n\",[\"$r\",\"ol\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"é¦–å…ˆï¼Œä½  \",[\"$r\",\"strong\",null,{\"children\":\"æ”¹å˜ Effect çš„ä»£ç \"}],\" æˆ–å“åº”å¼å€¼çš„å£°æ˜æ–¹å¼ã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"ç„¶åï¼Œä½ é‡‡çº³ linter çš„å»ºè®®ï¼Œè°ƒæ•´ä¾èµ–ï¼Œä»¥ \",[\"$r\",\"strong\",null,{\"children\":\"åŒ¹é…ä½ æ‰€æ”¹å˜çš„ä»£ç \"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"å¦‚æœä½ å¯¹ä¾èµ–ä¸æ»¡æ„ï¼Œä½ å¯ä»¥ \",[\"$r\",\"strong\",null,{\"children\":\"å›åˆ°ç¬¬ä¸€æ­¥\"}],\"ï¼ˆå¹¶å†æ¬¡ä¿®æ”¹ä»£ç ï¼‰ã€‚\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æœ€åä¸€éƒ¨åˆ†å¾ˆé‡è¦ã€‚\",[\"$r\",\"strong\",null,{\"children\":\"å¦‚æœä½ æƒ³æ”¹å˜ä¾èµ–ï¼Œé¦–å…ˆè¦æ”¹å˜æ‰€æ¶‰åŠåˆ°çš„ä»£ç \"}],\"ã€‚ä½ å¯ä»¥æŠŠä¾èµ–çœ‹ä½œæ˜¯ \",[\"$r\",\"a\",null,{\"href\":\"/learn/lifecycle-of-reactive-effects#react-verifies-that-you-specified-every-reactive-value-as-a-dependency\",\"children\":\"Effectçš„ä»£ç æ‰€ä¾èµ–çš„æ‰€æœ‰å“åº”å¼å€¼çš„åˆ—è¡¨\"}],\"ã€‚ä½ ä¸è¦ \",[\"$r\",\"strong\",null,{\"children\":\"é€‰æ‹©\"}],\" æŠŠä»€ä¹ˆæ”¾åœ¨è¿™ä¸ªåˆ—è¡¨ä¸Šã€‚è¯¥åˆ—è¡¨ \",[\"$r\",\"strong\",null,{\"children\":\"æè¿°äº†\"}],\" ä»£ç ã€‚è¦æ”¹å˜ä¾èµ–ï¼Œè¯·æ”¹å˜ä»£ç ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è¿™å¯èƒ½æ„Ÿè§‰å°±åƒè§£æ–¹ç¨‹ä¸€æ ·ã€‚ä½ æœ‰ä¸€ä¸ªç›®æ ‡ï¼ˆä¾‹å¦‚ï¼Œç§»é™¤ä¸€ä¸ªä¾èµ–ï¼‰ï¼Œä½ éœ€è¦â€œæ‰¾åˆ°â€ä¸è¯¥ç›®æ ‡ç›¸åŒ¹é…çš„ä»£ç ã€‚ä¸æ˜¯æ¯ä¸ªäººéƒ½è§‰å¾—è§£æ–¹ç¨‹å¾ˆæœ‰è¶£ï¼Œå†™ Effect ä¹Ÿæ˜¯å¦‚æ­¤ï¼å¹¸è¿çš„æ˜¯ï¼Œä¸‹é¢æœ‰ä¸€äº›å¸¸è§çš„è§£å†³æ–¹æ¡ˆä½ å¯ä»¥å»å°è¯•ã€‚\"}],\"\\n\",[\"$r\",\"Pitfall\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":\"å¦‚æœä½ æœ‰ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ä»£ç åº“ï¼Œä½ å¯èƒ½ä¼šæœ‰ä¸€äº›åƒè¿™æ ·æŠ‘åˆ¶ linter çš„ä»£ç ï¼š\"}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{3-4}\",\"children\":\"useEffect(() => {\\n  // ...\\n  // ğŸ”´ é¿å…åƒè¿™æ ·æŠ‘åˆ¶ linter çš„è­¦å‘Šæˆ–é”™è¯¯æç¤ºï¼š\\n  // eslint-ignore-next-line react-hooks/exhaustive-deps\\n}, []);\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"å½“ä¾èµ–ä¸ä»£ç ä¸åŒ¹é…æ—¶ï¼Œææœ‰å¯èƒ½å¼•å…¥ bug\"}],\"ã€‚é€šè¿‡æŠ‘åˆ¶ linterï¼Œä½ æ˜¯åœ¨ Effect æ‰€ä¾èµ–çš„å€¼ä¸Šå¯¹ React â€œæ’’è°â€ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":\"ä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æŠ€æœ¯ã€‚\"}]]}],\"\\n\",[\"$r\",\"DeepDive\",null,{\"children\":[[\"$r\",\"h4\",null,{\"id\":\"why-is-suppressing-the-dependency-linter-so-dangerous\",\"children\":\"ä¸ºä»€ä¹ˆæŠ‘åˆ¶ linter å¯¹ä¾èµ–çš„æ£€æŸ¥å¦‚æ­¤å±é™©ï¼Ÿ \"}],[\"$r\",\"p\",null,{\"children\":\"æŠ‘åˆ¶ linter ä¼šå¯¼è‡´éå¸¸ä¸ç›´è§‚çš„ bugï¼Œè¿™å°†å¾ˆéš¾å‘ç°å’Œä¿®å¤ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ï¼š\"}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\n\\nexport default function Timer() {\\n  const [count, setCount] = useState(0);\\n  const [increment, setIncrement] = useState(1);\\n\\n  function onTick() {\\n\\tsetCount(count + increment);\\n  }\\n\\n  useEffect(() => {\\n    const id = setInterval(onTick, 1000);\\n    return () => clearInterval(id);\\n    // eslint-disable-next-line react-hooks/exhaustive-deps\\n  }, []);\\n\\n  return (\\n    <>\\n      <h1>\\n        è®¡æ•°å™¨ï¼š{count}\\n        <button onClick={() => setCount(0)}>é‡åˆ¶</button>\\n      </h1>\\n      <hr />\\n      <p>\\n        æ¯ç§’é€’å¢ï¼š\\n        <button disabled={increment === 0} onClick={() => {\\n          setIncrement(i => i - 1);\\n        }}>â€“</button>\\n        <b>{increment}</b>\\n        <button onClick={() => {\\n          setIncrement(i => i + 1);\\n        }}>+</button>\\n      </p>\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 10px; }\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":[\"æ¯”æ–¹è¯´ï¼Œä½ æƒ³â€œåªåœ¨ mount æ—¶â€è¿è¡Œ Effectã€‚ä½ å·²ç»çŸ¥é“å¯ä»¥é€šè¿‡è®¾ç½® \",[\"$r\",\"a\",null,{\"href\":\"/learn/lifecycle-of-reactive-effects#what-an-effect-with-empty-dependencies-means\",\"children\":[\"ç©ºï¼ˆ\",[\"$r\",\"code\",null,{\"children\":\"[]\"}],\"ï¼‰ä¾èµ–\"]}],\" æ¥è¾¾åˆ°è¿™ç§æ•ˆæœï¼Œæ‰€ä»¥ä½ å†³å®šå¿½ç•¥ linter çš„æ£€æŸ¥ï¼Œå¼ºè¡ŒæŒ‡å®š \",[\"$r\",\"code\",null,{\"children\":\"[]\"}],\" ä¸ºä¾èµ–ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"ä¸Šé¢çš„è®¡æ•°å™¨ä¾‹å­ï¼Œæœ¬åº”è¯¥æ¯ç§’é€’å¢ï¼Œé€’å¢é‡å¯ä»¥é€šè¿‡ä¸¤ä¸ªæŒ‰é’®æ¥æ§åˆ¶ã€‚ç„¶è€Œï¼Œç”±äºä½ å¯¹ React â€œæ’’è°â€ï¼Œè¯´è¿™ä¸ª Effect ä¸ä¾èµ–äºä»»ä½•ä¸œè¥¿ï¼ŒReact ä¾¿ä¸€ç›´ä½¿ç”¨åˆæ¬¡æ¸²æŸ“æ—¶çš„ \",[\"$r\",\"code\",null,{\"children\":\"onTick\"}],\" å‡½æ•°ã€‚\",[\"$r\",\"a\",null,{\"href\":\"/learn/state-as-a-snapshot#rendering-takes-a-snapshot-in-time\",\"children\":\"åœ¨åç»­æ¸²æŸ“ä¸­\"}],\"ï¼Œ \",[\"$r\",\"code\",null,{\"children\":\"count\"}],\" æ€»æ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"0\"}],\" ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\" æ€»æ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"1\"}],\"ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå®šæ—¶å™¨æ¯ç§’è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"onTick\"}],\" å‡½æ•°ï¼Œå®é™…è¿è¡Œçš„æ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"setCount(0 + 1)\"}],[\"$r\",\"sup\",null,{\"children\":[\"$r\",\"a\",null,{\"href\":\"#note1\",\"children\":\"[1]\"}]}],\"ï¼Œæ‰€ä»¥ä½ æ€»æ˜¯çœ‹åˆ° \",[\"$r\",\"code\",null,{\"children\":\"1\"}],\"ã€‚åƒè¿™æ ·çš„é”™è¯¯ï¼Œå½“å®ƒä»¬åˆ†æ•£åœ¨å¤šä¸ªç»„ä»¶ä¸­æ—¶ï¼Œå°±æ›´éš¾è§£å†³äº†ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"è¿™é‡Œæœ‰ä¸€ä¸ªæ¯”å¿½ç•¥ linter æ›´å¥½çš„è§£å†³æ–¹æ¡ˆ! é‚£ä¾¿æ˜¯å°† \",[\"$r\",\"code\",null,{\"children\":\"onTick\"}],\" æ·»åŠ åˆ°ä¾èµ–ä¸­ã€‚(ä¸ºäº†ç¡®ä¿ interval åªè®¾ç½®ä¸€æ¬¡ï¼Œ\",[\"$r\",\"a\",null,{\"href\":\"/learn/separating-events-from-effects#reading-latest-props-and-state-with-effect-events\",\"children\":[\"ä½¿ \",[\"$r\",\"code\",null,{\"children\":\"onTick\"}],\" æˆä¸º Effect Event\"]}],\"ã€‚)\"]}],[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"æˆ‘ä»¬å»ºè®®å°†ä¾èµ–æ€§ lint é”™è¯¯ä½œä¸ºä¸€ä¸ªç¼–è¯‘é”™è¯¯æ¥å¤„ç†ã€‚å¦‚æœä½ ä¸æŠ‘åˆ¶å®ƒï¼Œä½ å°†æ°¸è¿œä¸ä¼šé‡åˆ°åƒä¸Šé¢è¿™æ ·çš„é”™è¯¯\"}],\"ã€‚æœ¬é¡µé¢çš„å‰©ä¸‹éƒ¨åˆ†å°†ä»‹ç»è¿™ä¸ªå’Œå…¶ä»–æƒ…å†µçš„æ›¿ä»£æ–¹æ¡ˆã€‚\"]}]]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"removing-unnecessary-dependencies\",\"children\":\"ç§»é™¤éå¿…éœ€çš„ä¾èµ– \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"æ¯å½“ä½ è°ƒæ•´ Effect çš„ä¾èµ–ä»¥é€‚é…ä»£ç æ—¶ï¼Œè¯·æ³¨æ„ä¸€ä¸‹å½“å‰çš„ä¾èµ–ã€‚å½“è¿™äº›ä¾èµ–å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè®© Effect é‡æ–°è¿è¡Œæ˜¯å¦æœ‰æ„ä¹‰ï¼Ÿæœ‰æ—¶ï¼Œç­”æ¡ˆæ˜¯â€œä¸â€ï¼š\"}],\"\\n\",[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"ä½ å¯èƒ½æƒ³åœ¨ä¸åŒçš„æ¡ä»¶ä¸‹é‡æ–°æ‰§è¡Œ Effect çš„ \",[\"$r\",\"strong\",null,{\"children\":\"ä¸åŒéƒ¨åˆ†\"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"ä½ å¯èƒ½æƒ³åªè¯»å–æŸä¸ªä¾èµ–çš„ \",[\"$r\",\"strong\",null,{\"children\":\"æœ€æ–°å€¼\"}],\"ï¼Œè€Œä¸æ˜¯å¯¹å…¶å˜åŒ–åšå‡ºâ€œååº”â€ã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"ä¾èµ–å¯èƒ½ä¼šå› ä¸ºå®ƒçš„ç±»å‹æ˜¯å¯¹è±¡æˆ–å‡½æ•°è€Œ \",[\"$r\",\"strong\",null,{\"children\":\"æ— æ„é—´\"}],\" æ”¹å˜å¤ªé¢‘ç¹ã€‚\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ä¸ºäº†æ‰¾åˆ°æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆï¼Œä½ éœ€è¦å›ç­”å…³äº Effect çš„å‡ ä¸ªé—®é¢˜ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™äº›é—®é¢˜ã€‚\"}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"should-this-code-move-to-an-event-handler\",\"children\":\"è¿™æ®µä»£ç åº”è¯¥ç§»åˆ°äº‹ä»¶å¤„ç†ç¨‹åºä¸­å—ï¼Ÿ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ä½ åº”è¯¥è€ƒè™‘çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ï¼Œè¿™æ®µä»£ç æ˜¯å¦åº”è¯¥æˆä¸º Effectã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æƒ³è±¡ä¸€ä¸ªè¡¨å•ï¼Œåœ¨æäº¤æ—¶ä½ å°† \",[\"$r\",\"code\",null,{\"children\":\"submitted\"}],\" çŠ¶æ€å˜é‡è®¾ç½®ä¸º \",[\"$r\",\"code\",null,{\"children\":\"true\"}],\"ï¼Œå¹¶åœ¨ \",[\"$r\",\"code\",null,{\"children\":\"submitted\"}],\" ä¸º \",[\"$r\",\"code\",null,{\"children\":\"true\"}],\" æ—¶ï¼Œéœ€è¦å‘é€ POST è¯·æ±‚å¹¶æ˜¾ç¤ºé€šçŸ¥ã€‚ä½ æŠŠè¿™ä¸ªé€»è¾‘æ”¾åœ¨ Effect å†…ï¼Œå¹¶æ ¹æ® \",[\"$r\",\"code\",null,{\"children\":\"submitted\"}],\" ä¸º \",[\"$r\",\"code\",null,{\"children\":\"true\"}],\" â€œååº”â€ã€‚\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{6-8}\",\"children\":\"function Form() {\\n  const [submitted, setSubmitted] = useState(false);\\n\\n  useEffect(() => {\\n    if (submitted) {\\n      // ğŸ”´ é¿å…: Effect ä¸­æœ‰ç‰¹å®šäº‹ä»¶çš„é€»è¾‘\\n      post('/api/register');\\n      showNotification('Successfully registered!');\\n    }\\n  }, [submitted]);\\n\\n  function handleSubmit() {\\n    setSubmitted(true);\\n  }\\n\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"åæ¥ï¼Œä½ æƒ³é€šè¿‡è¯»å–å½“å‰çš„ä¸»é¢˜å€¼æ¥è°ƒæ•´é€šçŸ¥ä¿¡æ¯çš„æ ·å¼ã€‚å› ä¸º \",[\"$r\",\"code\",null,{\"children\":\"theme\"}],\" æ˜¯åœ¨ç»„ä»¶ä¸­å£°æ˜çš„ï¼Œæ‰€ä»¥å®ƒæ˜¯å“åº”å¼å€¼ï¼Œä½ å†³å®šæŠŠå®ƒä½œä¸ºä¾èµ–åŠ å…¥ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{3,9,11}\",\"children\":\"function Form() {\\n  const [submitted, setSubmitted] = useState(false);\\n  const theme = useContext(ThemeContext);\\n\\n  useEffect(() => {\\n    if (submitted) {\\n      // ğŸ”´ é¿å…: Effect ä¸­æœ‰ç‰¹å®šäº‹ä»¶çš„é€»è¾‘\\n      post('/api/register');\\n      showNotification('Successfully registered!', theme);\\n    }\\n  }, [submitted, theme]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n\\n  function handleSubmit() {\\n    setSubmitted(true);\\n  }  \\n\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å¦‚æœè¿™ä¹ˆåšï¼Œä½ å°†å¼•å…¥ä¸€ä¸ªé”™è¯¯ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ å…ˆæäº¤è¡¨å•ï¼Œç„¶ååˆ‡æ¢æš—äº®ä¸»é¢˜ã€‚å½“ \",[\"$r\",\"code\",null,{\"children\":\"theme\"}],\" æ”¹å˜åï¼ŒEffect é‡æ–°è¿è¡Œï¼Œè¿™å°†å¯¼è‡´æ˜¾ç¤ºä¸¤æ¬¡ç›¸åŒçš„é€šçŸ¥ï¼\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"é¦–å…ˆï¼Œè¿™é‡Œçš„é—®é¢˜æ˜¯ï¼Œä»£ç ä¸åº”è¯¥ä»¥ Effect å®ç°\"}],\"ã€‚ä½ æƒ³å‘é€è¿™ä¸ª POST è¯·æ±‚ï¼Œå¹¶åœ¨ \",[\"$r\",\"strong\",null,{\"children\":\"æäº¤è¡¨å•æ—¶æ˜¾ç¤ºé€šçŸ¥\"}],\"ï¼Œè¿™æ˜¯ä¸€ä¸ªç‰¹å®šçš„äº¤äº’ã€‚ç‰¹å®šçš„äº¤äº’è¯·å°†è¯¥é€»è¾‘ç›´æ¥æ”¾åˆ°ç›¸åº”çš„äº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{6-7}\",\"children\":\"function Form() {\\n  const theme = useContext(ThemeContext);\\n\\n  function handleSubmit() {\\n    // âœ… å¥½ï¼šä»äº‹ä»¶å¤„ç†ç¨‹åºè°ƒç”¨ç‰¹å®šäºäº‹ä»¶çš„é€»è¾‘\\n    post('/api/register');\\n    showNotification('Successfully registered!', theme);\\n  }  \\n\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç°åœ¨ï¼Œä»£ç åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼Œå®ƒä¸æ˜¯å“åº”å¼çš„ â€”â€” æ‰€ä»¥å®ƒåªåœ¨ç”¨æˆ·æäº¤è¡¨å•æ—¶è¿è¡Œã€‚é˜…è¯»æ›´å¤šå…³äº \",[\"$r\",\"a\",null,{\"href\":\"/learn/separating-events-from-effects#reactive-values-and-reactive-logic\",\"children\":\"åœ¨äº‹ä»¶å¤„ç†ç¨‹åºå’Œ Effect ä¹‹é—´åšå‡ºé€‰æ‹©\"}],\" å’Œ \",[\"$r\",\"a\",null,{\"href\":\"/learn/you-might-not-need-an-effect\",\"children\":\"å¦‚ä½•åˆ é™¤ä¸å¿…è¦çš„ Effect\"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"is-your-effect-doing-several-unrelated-things\",\"children\":\"Effect æ˜¯å¦åœ¨åšå‡ ä»¶ä¸ç›¸å…³çš„äº‹æƒ…ï¼Ÿ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ä¸‹ä¸€ä¸ªåº”è¯¥é—®è‡ªå·±çš„é—®é¢˜æ˜¯ï¼ŒEffect æ˜¯å¦åœ¨åšå‡ ä»¶ä¸ç›¸å…³çš„äº‹æƒ…ã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å¦‚ä¸‹ä¾‹å­ï¼Œä½ æ­£åœ¨å®ç°è¿è¾“è¡¨å•ï¼Œç”¨æˆ·éœ€è¦é€‰æ‹©ä»–ä»¬çš„åŸå¸‚å’Œåœ°åŒºã€‚ä½ æ ¹æ®æ‰€é€‰çš„â€œå›½å®¶â€ä»æœåŠ¡å™¨ä¸Šè·å–â€œåŸå¸‚â€åˆ—è¡¨ï¼Œç„¶ååœ¨ä¸‹æ‹‰èœå•ä¸­æ˜¾ç¤ºï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"function ShippingForm({ country }) {\\n  const [cities, setCities] = useState(null);\\n  const [city, setCity] = useState(null);\\n\\n  useEffect(() => {\\n    let ignore = false;\\n    fetch(`/api/cities?country=${country}`)\\n      .then(response => response.json())\\n      .then(json => {\\n        if (!ignore) {\\n          setCities(json);\\n        }\\n      });\\n    return () => {\\n      ignore = true;\\n    };\\n  }, [country]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¿™æ˜¯ä¸€ä¸ª \",[\"$r\",\"a\",null,{\"href\":\"/learn/you-might-not-need-an-effect#fetching-data\",\"children\":\"åœ¨Effectä¸­è·å–æ•°æ®\"}],\" çš„å¥½ä¾‹å­ï¼š\",[\"$r\",\"code\",null,{\"children\":\"cities\"}],\" state é€šè¿‡ç½‘ç»œå’Œ \",[\"$r\",\"code\",null,{\"children\":\"country\"}],\" props è¿›è¡Œâ€œåŒæ­¥â€ã€‚ä½†ä½ ä¸èƒ½åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­è¿™æ ·åšï¼Œå› ä¸ºä½ éœ€è¦åœ¨ \",[\"$r\",\"code\",null,{\"children\":\"ShippingForm\"}],\" æ˜¾ç¤ºæ—¶å’Œ \",[\"$r\",\"code\",null,{\"children\":\"country\"}],\" å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆä¸ç®¡æ˜¯å“ªä¸ªäº¤äº’å¯¼è‡´çš„ï¼‰ç«‹å³è·å–ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç°åœ¨æˆ‘ä»¬å‡è®¾ä½ è¦ä¸ºåŸå¸‚åŒºåŸŸæ·»åŠ ç¬¬äºŒä¸ªé€‰æ‹©æ¡†ï¼Œå®ƒåº”è¯¥è·å–å½“å‰é€‰æ‹©çš„ \",[\"$r\",\"code\",null,{\"children\":\"city\"}],\" çš„ \",[\"$r\",\"code\",null,{\"children\":\"areas\"}],\"ã€‚ä½ ä¹Ÿè®¸ä¼šåœ¨åŒä¸€ä¸ª Effect ä¸­æ·»åŠ ç¬¬äºŒä¸ª \",[\"$r\",\"code\",null,{\"children\":\"fetch\"}],\" è°ƒç”¨æ¥è·å–åœ°åŒºåˆ—è¡¨ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{15-24,28}\",\"children\":\"function ShippingForm({ country }) {\\n  const [cities, setCities] = useState(null);\\n  const [city, setCity] = useState(null);\\n  const [areas, setAreas] = useState(null);\\n\\n  useEffect(() => {\\n    let ignore = false;\\n    fetch(`/api/cities?country=${country}`)\\n      .then(response => response.json())\\n      .then(json => {\\n        if (!ignore) {\\n          setCities(json);\\n        }\\n      });\\n    // ğŸ”´ é¿å…: å•ä¸ª Effect åŒæ­¥ä¸¤ä¸ªç‹¬ç«‹é€»è¾‘å¤„ç†\\n    if (city) {\\n      fetch(`/api/areas?city=${city}`)\\n        .then(response => response.json())\\n        .then(json => {\\n          if (!ignore) {\\n            setAreas(json);\\n          }\\n        });\\n    }\\n    return () => {\\n      ignore = true;\\n    };\\n  }, [country, city]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç„¶è€Œï¼Œç”±äº Effect ç°åœ¨ä½¿ç”¨ \",[\"$r\",\"code\",null,{\"children\":\"city\"}],\" state å˜é‡ï¼Œä½ ä¸å¾—ä¸æŠŠ \",[\"$r\",\"code\",null,{\"children\":\"city\"}],\" åŠ å…¥åˆ°ä¾èµ–ä¸­ã€‚è¿™åˆå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼šå½“ç”¨æˆ·é€‰æ‹©ä¸åŒçš„åŸå¸‚æ—¶ï¼ŒEffect å°†é‡æ–°è¿è¡Œå¹¶è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"fetchCities(country)\"}],\"ã€‚è¿™å°†å¯¼è‡´ä¸å¿…è¦åœ°å¤šæ¬¡è·å–åŸå¸‚åˆ—è¡¨ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"è¿™æ®µä»£ç çš„é—®é¢˜åœ¨äºï¼Œä½ åœ¨åŒæ­¥ä¸¤ä¸ªä¸åŒçš„ã€ä¸ç›¸å…³çš„ä¸œè¥¿\"}],\"ï¼š\"]}],\"\\n\",[\"$r\",\"ol\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"ä½ æƒ³è¦æ ¹æ® \",[\"$r\",\"code\",null,{\"children\":\"country\"}],\" props é€šè¿‡ç½‘ç»œåŒæ­¥ \",[\"$r\",\"code\",null,{\"children\":\"city\"}],\" state\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"ä½ æƒ³è¦æ ¹æ® \",[\"$r\",\"code\",null,{\"children\":\"city\"}],\" çŠ¶æ€é€šè¿‡ç½‘ç»œåŒæ­¥ \",[\"$r\",\"code\",null,{\"children\":\"areas\"}],\" state\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å°†é€»è¾‘åˆ†åˆ° 2 ä¸ª Effect ä¸­ï¼Œæ¯ä¸ª Effect ä»…å“åº”å…¶éœ€è¦åŒæ­¥å“åº”çš„ propsï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{19-33}\",\"children\":\"function ShippingForm({ country }) {\\n  const [cities, setCities] = useState(null);\\n  useEffect(() => {\\n    let ignore = false;\\n    fetch(`/api/cities?country=${country}`)\\n      .then(response => response.json())\\n      .then(json => {\\n        if (!ignore) {\\n          setCities(json);\\n        }\\n      });\\n    return () => {\\n      ignore = true;\\n    };\\n  }, [country]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n\\n  const [city, setCity] = useState(null);\\n  const [areas, setAreas] = useState(null);\\n  useEffect(() => {\\n    if (city) {\\n      let ignore = false;\\n      fetch(`/api/areas?city=${city}`)\\n        .then(response => response.json())\\n        .then(json => {\\n          if (!ignore) {\\n            setAreas(json);\\n          }\\n        });\\n      return () => {\\n        ignore = true;\\n      };\\n    }\\n  }, [city]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç°åœ¨ï¼Œç¬¬ä¸€ä¸ª Effect åªåœ¨ \",[\"$r\",\"code\",null,{\"children\":\"country\"}],\" æ”¹å˜æ—¶é‡æ–°è¿è¡Œï¼Œè€Œç¬¬äºŒä¸ª Effect åœ¨ \",[\"$r\",\"code\",null,{\"children\":\"city\"}],\" æ”¹å˜æ—¶é‡æ–°è¿è¡Œã€‚ä½ å·²ç»æŒ‰ç›®çš„æŠŠå®ƒä»¬åˆ†å¼€äº†ï¼šä¸¤ä»¶ä¸åŒçš„äº‹æƒ…ç”±ä¸¤ä¸ªç‹¬ç«‹çš„ Effect æ¥åŒæ­¥ã€‚ä¸¤ä¸ªç‹¬ç«‹çš„ Effect æœ‰ä¸¤ä¸ªç‹¬ç«‹çš„ä¾èµ–ï¼Œæ‰€ä»¥å®ƒä»¬ä¸ä¼šåœ¨æ— æ„ä¸­ç›¸äº’è§¦å‘ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æœ€ç»ˆå®Œæˆçš„ä»£ç æ¯”æœ€åˆçš„è¦é•¿ï¼Œä½†æ˜¯æ‹†åˆ†è¿™äº› Effect æ˜¯éå¸¸æ­£ç¡®çš„ã€‚\",[\"$r\",\"a\",null,{\"href\":\"/learn/lifecycle-of-reactive-effects#each-effect-represents-a-separate-synchronization-process\",\"children\":\"æ¯ä¸ª Effect åº”è¯¥ä»£è¡¨ä¸€ä¸ªç‹¬ç«‹çš„åŒæ­¥è¿‡ç¨‹\"}],\"ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåˆ é™¤ä¸€ä¸ª Effect å¹¶ä¸ä¼šå½±å“åˆ°å¦ä¸€ä¸ª Effect çš„é€»è¾‘ã€‚è¿™æ„å‘³ç€ä»–ä»¬ \",[\"$r\",\"strong\",null,{\"children\":\"åŒæ­¥ä¸åŒçš„äº‹æƒ…\"}],\"ï¼Œåˆ†å¼€ä»–ä»¬å¤„ç†æ˜¯ä¸€ä»¶å¥½äº‹ã€‚å¦‚æœä½ æ‹…å¿ƒé‡å¤ä»£ç çš„é—®é¢˜ï¼Œä½ å¯ä»¥é€šè¿‡ \",[\"$r\",\"a\",null,{\"href\":\"/learn/reusing-logic-with-custom-hooks#when-to-use-custom-hooks\",\"children\":\"æå–ç›¸åŒé€»è¾‘åˆ°è‡ªå®šä¹‰ Hook\"}],\" æ¥æå‡ä»£ç è´¨é‡\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"are-you-reading-some-state-to-calculate-the-next-state\",\"children\":\"æ˜¯å¦åœ¨è¯»å–ä¸€äº›çŠ¶æ€æ¥è®¡ç®—ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Ÿ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æ¯æ¬¡æœ‰æ–°çš„æ¶ˆæ¯åˆ°è¾¾æ—¶ï¼Œè¿™ä¸ª Effect ä¼šç”¨æ–°åˆ›å»ºçš„æ•°ç»„æ›´æ–° \",[\"$r\",\"code\",null,{\"children\":\"messages\"}],\" stateï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2,6-8}\",\"children\":\"function ChatRoom({ roomId }) {\\n  const [messages, setMessages] = useState([]);\\n  useEffect(() => {\\n    const connection = createConnection();\\n    connection.connect();\\n    connection.on('message', (receivedMessage) => {\\n      setMessages([...messages, receivedMessage]);\\n    });\\n    // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å®ƒä½¿ç”¨ \",[\"$r\",\"code\",null,{\"children\":\"messages\"}],\" å˜é‡æ¥ \",[\"$r\",\"a\",null,{\"href\":\"/learn/updating-arrays-in-state\",\"children\":\"åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„\"}],\"ï¼šä»æ‰€æœ‰ç°æœ‰çš„æ¶ˆæ¯å¼€å§‹ï¼Œå¹¶åœ¨æœ€åæ·»åŠ æ–°çš„æ¶ˆæ¯ã€‚ç„¶è€Œï¼Œç”±äº \",[\"$r\",\"code\",null,{\"children\":\"messages\"}],\" æ˜¯ä¸€ä¸ªç”± Effect è¯»å–çš„å“åº”å¼å€¼ï¼Œå®ƒå¿…é¡»æ˜¯ä¸€ä¸ªä¾èµ–ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{7,10}\",\"children\":\"function ChatRoom({ roomId }) {\\n  const [messages, setMessages] = useState([]);\\n  useEffect(() => {\\n    const connection = createConnection();\\n    connection.connect();\\n    connection.on('message', (receivedMessage) => {\\n      setMessages([...messages, receivedMessage]);\\n    });\\n    return () => connection.disconnect();\\n  }, [roomId, messages]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è€Œè®© \",[\"$r\",\"code\",null,{\"children\":\"messages\"}],\" æˆä¸ºä¾èµ–ä¼šå¸¦æ¥é—®é¢˜ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æ¯å½“ä½ æ”¶åˆ°ä¸€æ¡æ¶ˆæ¯ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"setMessages()\"}],\" å°±ä¼šä½¿è¯¥ç»„ä»¶é‡æ–°æ¸²æŸ“ä¸€ä¸ªæ–°çš„ \",[\"$r\",\"code\",null,{\"children\":\"messages\"}],\" æ•°ç»„ï¼Œå…¶ä¸­åŒ…æ‹¬æ”¶åˆ°çš„æ¶ˆæ¯ã€‚ç„¶è€Œï¼Œç”±äºè¯¥ Effect ç°åœ¨ä¾èµ–äº \",[\"$r\",\"code\",null,{\"children\":\"messages\"}],\"ï¼Œè¿™ \",[\"$r\",\"strong\",null,{\"children\":\"ä¹Ÿå°†\"}],\" é‡æ–°åŒæ­¥è¯¥ Effectã€‚æ‰€ä»¥æ¯æ¡æ–°æ¶ˆæ¯éƒ½ä¼šä½¿èŠå¤©é‡æ–°è¿æ¥ã€‚ç”¨æˆ·ä¸ä¼šå–œæ¬¢è¿™æ ·ï¼\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸è¦åœ¨ Effect é‡Œé¢è¯»å– \",[\"$r\",\"code\",null,{\"children\":\"messages\"}],\"ã€‚ç›¸åï¼Œåº”è¯¥å°†ä¸€ä¸ª \",[\"$r\",\"a\",null,{\"href\":\"/reference/react/useState#updating-state-based-the-previous-state\",\"children\":\"state æ›´æ–°å‡½æ•°\"}],\" ä¼ é€’ç»™ \",[\"$r\",\"code\",null,{\"children\":\"setMessages\"}],\"ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{7,10}\",\"children\":\"function ChatRoom({ roomId }) {\\n  const [messages, setMessages] = useState([]);\\n  useEffect(() => {\\n    const connection = createConnection();\\n    connection.connect();\\n    connection.on('message', (receivedMessage) => {\\n      setMessages(msgs => [...msgs, receivedMessage]);\\n    });\\n    return () => connection.disconnect();\\n  }, [roomId]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":[\"æ³¨æ„ Effect ç°åœ¨æ ¹æœ¬ä¸è¯»å– \",[\"$r\",\"code\",null,{\"children\":\"messages\"}],\" å˜é‡\"]}],\"ã€‚ä½ åªéœ€è¦ä¼ é€’ä¸€ä¸ªæ›´æ–°å‡½æ•°ï¼Œæ¯”å¦‚ \",[\"$r\",\"code\",null,{\"children\":\"msgs => [...msgs, receivedMessage]\"}],\"ã€‚React \",[\"$r\",\"a\",null,{\"href\":\"/learn/queueing-a-series-of-state-updates\",\"children\":\"å°†æ›´æ–°ç¨‹åºå‡½æ•°æ”¾å…¥é˜Ÿåˆ—\"}],\" å¹¶å°†åœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“æœŸé—´å‘å…¶æä¾› \",[\"$r\",\"code\",null,{\"children\":\"msgs\"}],\" å‚æ•°ã€‚è¿™å°±æ˜¯ Effect æœ¬èº«ä¸å†éœ€è¦ä¾èµ– \",[\"$r\",\"code\",null,{\"children\":\"messages\"}],\" çš„åŸå› ã€‚ä¿®å¤åï¼Œæ¥æ”¶èŠå¤©æ¶ˆæ¯å°†ä¸å†ä½¿èŠå¤©é‡æ–°è¿æ¥ã€‚\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"do-you-want-to-read-a-value-without-reacting-to-its-changes\",\"children\":\"ä½ æƒ³è¯»å–ä¸€ä¸ªå€¼è€Œä¸å¯¹å…¶å˜åŒ–åšå‡ºâ€œååº”â€å—ï¼Ÿ \"}],\"\\n\",[\"$r\",\"Wip\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":[\"æœ¬èŠ‚æè¿°äº†ä¸€ä¸ªåœ¨ç¨³å®šç‰ˆæœ¬çš„ React ä¸­ \",[\"$r\",\"strong\",null,{\"children\":\"å°šæœªå‘å¸ƒçš„å®éªŒæ€§\"}],\" APIã€‚\"]}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å‡è®¾ä½ å¸Œæœ›åœ¨ç”¨æˆ·æ”¶åˆ°æ–°æ¶ˆæ¯æ—¶æ’­æ”¾å£°éŸ³ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"isMuted\"}],\" ä¸º \",[\"$r\",\"code\",null,{\"children\":\"true\"}],\" é™¤å¤–ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{3,10-12}\",\"children\":\"function ChatRoom({ roomId }) {\\n  const [messages, setMessages] = useState([]);\\n  const [isMuted, setIsMuted] = useState(false);\\n\\n  useEffect(() => {\\n    const connection = createConnection();\\n    connection.connect();\\n    connection.on('message', (receivedMessage) => {\\n      setMessages(msgs => [...msgs, receivedMessage]);\\n      if (!isMuted) {\\n        playSound();\\n      }\\n    });\\n    // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç”±äº Effect ç°åœ¨åœ¨å…¶ä»£ç ä¸­ä½¿ç”¨äº† \",[\"$r\",\"code\",null,{\"children\":\"isMuted\"}],\" ï¼Œå› æ­¤ä½ å¿…é¡»å°†å…¶æ·»åŠ åˆ°ä¾èµ–ä¸­ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{10,15}\",\"children\":\"function ChatRoom({ roomId }) {\\n  const [messages, setMessages] = useState([]);\\n  const [isMuted, setIsMuted] = useState(false);\\n\\n  useEffect(() => {\\n    const connection = createConnection();\\n    connection.connect();\\n    connection.on('message', (receivedMessage) => {\\n      setMessages(msgs => [...msgs, receivedMessage]);\\n      if (!isMuted) {\\n        playSound();\\n      }\\n    });\\n    return () => connection.disconnect();\\n  }, [roomId, isMuted]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"é—®é¢˜æ˜¯æ¯æ¬¡ \",[\"$r\",\"code\",null,{\"children\":\"isMuted\"}],\" æ”¹å˜æ—¶ï¼ˆä¾‹å¦‚ï¼Œå½“ç”¨æˆ·æŒ‰ä¸‹â€œé™éŸ³â€å¼€å…³æ—¶ï¼‰ï¼ŒEffect å°†é‡æ–°åŒæ­¥ï¼Œå¹¶é‡æ–°è¿æ¥åˆ°èŠå¤©ã€‚è¿™ä¸æ˜¯ç†æƒ³çš„ç”¨æˆ·ä½“éªŒï¼ï¼ˆåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå³ä½¿ç¦ç”¨ linter ä¹Ÿä¸èµ·ä½œç”¨â€”â€”å¦‚æœä½ è¿™æ ·åšï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"isMuted\"}],\" å°†â€œä¿æŒâ€å…¶æ—§å€¼ã€‚ï¼‰\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å°†ä¸åº”è¯¥å“åº”å¼çš„é€»è¾‘ä» Effect ä¸­æŠ½å–å‡ºæ¥ã€‚ä½ ä¸å¸Œæœ›æ­¤ Effect å¯¹ \",[\"$r\",\"code\",null,{\"children\":\"isMuted\"}],\" ä¸­çš„æ›´æ”¹åšå‡ºâ€œååº”â€ã€‚\",[\"$r\",\"a\",null,{\"href\":\"/learn/separating-events-from-effects#declaring-an-effect-event\",\"children\":\"å°†è¿™æ®µéå“åº”å¼é€»è¾‘ç§»è‡³ Effect Event ä¸­\"}],\"ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1,7-12,18,21}\",\"children\":\"import { useState, useEffect, useEffectEvent } from 'react';\\n\\nfunction ChatRoom({ roomId }) {\\n  const [messages, setMessages] = useState([]);\\n  const [isMuted, setIsMuted] = useState(false);\\n\\n  const onMessage = useEffectEvent(receivedMessage => {\\n    setMessages(msgs => [...msgs, receivedMessage]);\\n    if (!isMuted) {\\n      playSound();\\n    }\\n  });\\n\\n  useEffect(() => {\\n    const connection = createConnection();\\n    connection.connect();\\n    connection.on('message', (receivedMessage) => {\\n      onMessage(receivedMessage);\\n    });\\n    return () => connection.disconnect();\\n  }, [roomId]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"Effect Events è®©ä½ å¯ä»¥å°† Effect åˆ†æˆå“åº”å¼éƒ¨åˆ†ï¼ˆåº”è¯¥â€œååº”â€å“åº”å¼å€¼ï¼Œå¦‚ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" åŠå…¶å˜åŒ–ï¼‰å’Œéå“åº”å¼éƒ¨åˆ†ï¼ˆåªè¯»å–å®ƒä»¬çš„æœ€æ–°å€¼ï¼Œå¦‚ \",[\"$r\",\"code\",null,{\"children\":\"onMessage\"}],\" è¯»å– \",[\"$r\",\"code\",null,{\"children\":\"isMuted\"}],\"ï¼‰ã€‚\",[\"$r\",\"strong\",null,{\"children\":[\"ç°åœ¨ä½ åœ¨ Effect Event ä¸­è¯»å–äº† \",[\"$r\",\"code\",null,{\"children\":\"isMuted\"}],\"ï¼Œå®ƒä¸éœ€è¦æ·»åŠ åˆ° Effect ä¾èµ–ä¸­\"]}],\"ã€‚å› æ­¤ï¼Œå½“ä½ æ‰“å¼€æˆ–è€…å…³é—­â€œé™éŸ³â€è®¾ç½®æ—¶ï¼ŒèŠå¤©ä¸ä¼šé‡æ–°è¿æ¥ã€‚è‡³æ­¤ï¼Œè§£å†³åŸå§‹é—®é¢˜ï¼\"]}],\"\\n\",[\"$r\",\"h4\",null,{\"id\":\"wrapping-an-event-handler-from-the-props\",\"children\":\"åŒ…è£…æ¥è‡ª props çš„äº‹ä»¶å¤„ç†ç¨‹åº \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å½“ç»„ä»¶æ¥æ”¶äº‹ä»¶å¤„ç†å‡½æ•°ä½œä¸º props æ—¶ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1,8,11}\",\"children\":\"function ChatRoom({ roomId, onReceiveMessage }) {\\n  const [messages, setMessages] = useState([]);\\n\\n  useEffect(() => {\\n    const connection = createConnection();\\n    connection.connect();\\n    connection.on('message', (receivedMessage) => {\\n      onReceiveMessage(receivedMessage);\\n    });\\n    return () => connection.disconnect();\\n  }, [roomId, onReceiveMessage]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å‡è®¾çˆ¶ç»„ä»¶åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¼ é€’äº†ä¸€ä¸ª \",[\"$r\",\"strong\",null,{\"children\":\"ä¸åŒçš„\"}],\" \",[\"$r\",\"code\",null,{\"children\":\"onReceiveMessage\"}],\" å‡½æ•°ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{3-5}\",\"children\":\"<ChatRoom\\n  roomId={roomId}\\n  onReceiveMessage={receivedMessage => {\\n    // ...\\n  }}\\n/>\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç”±äº \",[\"$r\",\"code\",null,{\"children\":\"onReceiveMessage\"}],\" æ˜¯ä¾èµ–ï¼Œå®ƒä¼šå¯¼è‡´ Effect åœ¨æ¯æ¬¡çˆ¶çº§é‡æ–°æ¸²æŸ“åé‡æ–°åŒæ­¥ã€‚è¿™å°†å¯¼è‡´èŠå¤©é‡æ–°è¿æ¥ã€‚è¦è§£å†³æ­¤é—®é¢˜ï¼Œè¯·ç”¨ Effect Event åŒ…è£¹ä¹‹åå†è°ƒç”¨ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{4-6,12,15}\",\"children\":\"function ChatRoom({ roomId, onReceiveMessage }) {\\n  const [messages, setMessages] = useState([]);\\n\\n  const onMessage = useEffectEvent(receivedMessage => {\\n    onReceiveMessage(receivedMessage);\\n  });\\n\\n  useEffect(() => {\\n    const connection = createConnection();\\n    connection.connect();\\n    connection.on('message', (receivedMessage) => {\\n      onMessage(receivedMessage);\\n    });\\n    return () => connection.disconnect();\\n  }, [roomId]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"Effect Events ä¸æ˜¯å“åº”å¼çš„ï¼Œå› æ­¤ä½ ä¸éœ€è¦å°†å®ƒä»¬æŒ‡å®šä¸ºä¾èµ–ã€‚å› æ­¤ï¼Œå³ä½¿çˆ¶ç»„ä»¶ä¼ é€’çš„å‡½æ•°åœ¨æ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶éƒ½ä¸åŒï¼ŒèŠå¤©ä¹Ÿå°†ä¸å†é‡æ–°è¿æ¥ã€‚\"}],\"\\n\",[\"$r\",\"h4\",null,{\"id\":\"separating-reactive-and-non-reactive-code\",\"children\":\"åˆ†ç¦»å“åº”å¼å’Œéå“åº”å¼ä»£ç  \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œä½ å¸Œæœ›åœ¨æ¯æ¬¡ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" æ›´æ”¹æ—¶è®°å½•ä¸€æ¬¡ã€‚ä½ å¸Œæœ›åœ¨æ¯ä¸ªæ—¥å¿—ä¸­åŒ…å«å½“å‰çš„ \",[\"$r\",\"code\",null,{\"children\":\"notificationCount\"}],\"ï¼Œä½†ä½  \",[\"$r\",\"strong\",null,{\"children\":\"ä¸\"}],\" å¸Œæœ›é€šè¿‡æ›´æ”¹ \",[\"$r\",\"code\",null,{\"children\":\"notificationCount\"}],\" æ¥è§¦å‘æ—¥å¿—äº‹ä»¶ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è§£å†³æ–¹æ¡ˆè¿˜æ˜¯å°†éå“åº”å¼ä»£ç æ‹†åˆ†ï¼Œå°†å…¶æ”¾åˆ° Effect Event å†…ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2-4,7}\",\"children\":\"function Chat({ roomId, notificationCount }) {\\n  const onVisit = useEffectEvent(visitedRoomId => {\\n    logVisit(visitedRoomId, notificationCount);\\n  });\\n\\n  useEffect(() => {\\n    onVisit(roomId);\\n  }, [roomId]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä½ å¸Œæœ›é€»è¾‘å¯¹ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" åšå‡ºå“åº”ï¼Œå› æ­¤ä½ åœ¨ Effect ä¸­è¯»å– \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\"ã€‚ä½†æ˜¯ï¼Œä½ ä¸å¸Œæœ›æ›´æ”¹ \",[\"$r\",\"code\",null,{\"children\":\"notificationCount\"}],\" æ¥è®°å½•é¢å¤–çš„æ—¥å¿—è¾“å‡ºï¼Œå› æ­¤ä½ å¯ä»¥åœ¨ Effect Event ä¸­è¯»å– \",[\"$r\",\"code\",null,{\"children\":\"notificationCount\"}],\"ã€‚\",[\"$r\",\"a\",null,{\"href\":\"/learn/separating-events-from-effects#reading-latest-props-and-state-with-effect-events\",\"children\":\"äº†è§£ä½¿ç”¨ Effect Events åœ¨ Effect ä¸­è¯»å–æœ€æ–° props å’Œ state çš„æ›´å¤šä¿¡æ¯\"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"does-some-reactive-value-change-unintentionally\",\"children\":\"ä¸€äº›å“åº”å¼å€¼æ˜¯å¦æ— æ„ä¸­æ”¹å˜äº†ï¼Ÿ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æœ‰æ—¶ï¼Œä½  \",[\"$r\",\"strong\",null,{\"children\":\"ç¡®å®\"}],\" å¸Œæœ› Effect å¯¹æŸä¸ªå€¼â€œåšå‡ºååº”â€ï¼Œä½†è¯¥å€¼çš„å˜åŒ–æ¯”ä½ å¸Œæœ›çš„æ›´é¢‘ç¹â€”â€”å¹¶ä¸”å¯èƒ½ä¸ä¼šä»ç”¨æˆ·çš„è§’åº¦åæ˜ ä»»ä½•å®é™…å˜åŒ–ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ åœ¨ç»„ä»¶ä¸­åˆ›å»ºäº† \",[\"$r\",\"code\",null,{\"children\":\"options\"}],\" å¯¹è±¡ï¼Œç„¶åä» Effect å†…éƒ¨è¯»å–è¯¥å¯¹è±¡ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{3-6,9}\",\"children\":\"function ChatRoom({ roomId }) {\\n  // ...\\n  const options = {\\n    serverUrl: serverUrl,\\n    roomId: roomId\\n  };\\n\\n  useEffect(() => {\\n    const connection = createConnection(options);\\n    connection.connect();\\n    // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¯¥å¯¹è±¡åœ¨ç»„ä»¶ä¸­å£°æ˜ï¼Œå› æ­¤å®ƒæ˜¯ \",[\"$r\",\"a\",null,{\"href\":\"/learn/lifecycle-of-reactive-effects#effects-react-to-reactive-values\",\"children\":\"å“åº”å¼å€¼\"}],\"ã€‚å½“ä½ åœ¨ Effect ä¸­è¯»å–è¿™æ ·çš„å“åº”å¼å€¼æ—¶ï¼Œä½ å°†å…¶å£°æ˜ä¸ºä¾èµ–ã€‚è¿™å¯ç¡®ä¿ Effect å¯¹å…¶æ›´æ”¹åšå‡ºâ€œååº”â€ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{3,6}\",\"children\":\"  // ...\\n  useEffect(() => {\\n    const connection = createConnection(options);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [options]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å°†å…¶å£°æ˜ä¸ºä¾èµ–å¾ˆé‡è¦ï¼ä¾‹å¦‚ï¼Œè¿™å¯ä»¥ç¡®ä¿å¦‚æœ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" å‘ç”Ÿå˜åŒ–ï¼ŒEffect å°†ä½¿ç”¨æ–°çš„ \",[\"$r\",\"code\",null,{\"children\":\"options\"}],\" é‡æ–°è¿æ¥åˆ°èŠå¤©ã€‚ä½†æ˜¯ï¼Œä¸Šé¢çš„ä»£ç ä¹Ÿæœ‰é—®é¢˜ã€‚è¦æŸ¥çœ‹å®ƒï¼Œè¯·å°è¯•åœ¨ä¸‹é¢çš„æ²™ç›’ä¸­è¾“å…¥å†…å®¹ï¼Œç„¶åè§‚å¯Ÿæ§åˆ¶å°ä¸­å‘ç”Ÿçš„æƒ…å†µï¼š\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { createConnection } from './chat.js';\\n\\nconst serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId }) {\\n  const [message, setMessage] = useState('');\\n\\n  // æš‚æ—¶ç¦ç”¨ linter ä»¥æ¼”ç¤ºé—®é¢˜\\n  // eslint-disable-next-line react-hooks/exhaustive-deps\\n  const options = {\\n    serverUrl: serverUrl,\\n    roomId: roomId\\n  };\\n\\n  useEffect(() => {\\n    const connection = createConnection(options);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [options]);\\n\\n  return (\\n    <>\\n      <h1>æ¬¢è¿æ¥åˆ° {roomId} æˆ¿é—´ï¼</h1>\\n      <input value={message} onChange={e => setMessage(e.target.value)} />\\n    </>\\n  );\\n}\\n\\nexport default function App() {\\n  const [roomId, setRoomId] = useState('æ‰€æœ‰');\\n  return (\\n    <>\\n      <label>\\n        é€‰æ‹©èŠå¤©å®¤ï¼š\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"æ‰€æœ‰\\\">æ‰€æœ‰</option>\\n          <option value=\\\"æ—…æ¸¸\\\">æ—…æ¸¸</option>\\n          <option value=\\\"éŸ³ä¹\\\">éŸ³ä¹</option>\\n        </select>\\n      </label>\\n      <hr />\\n      <ChatRoom roomId={roomId} />\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection({ serverUrl, roomId }) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  return {\\n    connect() {\\n      console.log('âœ… è¿æ¥åˆ°â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl + '...');\\n    },\\n    disconnect() {\\n      console.log('âŒ æ–­å¼€â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"input { display: block; margin-bottom: 20px; }\\nbutton { margin-left: 10px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"232\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"åœ¨ä¸Šé¢çš„æ²™ç®±ä¸­ï¼Œè¾“å…¥ä»…æ›´æ–° \",[\"$r\",\"code\",null,{\"children\":\"message\"}],\" çŠ¶æ€å˜é‡ã€‚ä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸åº”è¯¥å½±å“èŠå¤©è¿æ¥ã€‚ä½†æ˜¯ï¼Œæ¯æ¬¡æ›´æ–° \",[\"$r\",\"code\",null,{\"children\":\"message\"}],\" æ—¶ï¼Œç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚å½“ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œå…¶ä¸­çš„ä»£ç ä¼šä»å¤´å¼€å§‹é‡æ–°è¿è¡Œã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"åœ¨æ¯æ¬¡é‡æ–°æ¸²æŸ“ \",[\"$r\",\"code\",null,{\"children\":\"ChatRoom\"}],\" ç»„ä»¶æ—¶ï¼Œéƒ½ä¼šä»å¤´å¼€å§‹åˆ›å»ºä¸€ä¸ªæ–°çš„ \",[\"$r\",\"code\",null,{\"children\":\"options\"}],\" å¯¹è±¡ã€‚React å‘ç° \",[\"$r\",\"code\",null,{\"children\":\"options\"}],\" å¯¹è±¡ä¸ä¸Šæ¬¡æ¸²æŸ“æœŸé—´åˆ›å»ºçš„ \",[\"$r\",\"code\",null,{\"children\":\"options\"}],\" å¯¹è±¡æ˜¯ \",[\"$r\",\"strong\",null,{\"children\":\"ä¸åŒçš„å¯¹è±¡\"}],\"ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä¼šé‡æ–°åŒæ­¥ Effectï¼ˆä¾èµ–äº \",[\"$r\",\"code\",null,{\"children\":\"options\"}],\"ï¼‰ï¼Œå¹¶ä¸”ä¼šåœ¨ä½ è¾“å…¥æ—¶é‡æ–°è¿æ¥èŠå¤©ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"æ­¤é—®é¢˜ä»…å½±å“å¯¹è±¡å’Œå‡½æ•°ã€‚åœ¨ JavaScript ä¸­ï¼Œæ¯ä¸ªæ–°åˆ›å»ºçš„å¯¹è±¡å’Œå‡½æ•°éƒ½è¢«è®¤ä¸ºä¸å…¶ä»–æ‰€æœ‰å¯¹è±¡å’Œå‡½æ•°ä¸åŒã€‚å³ä½¿ä»–ä»¬çš„å€¼ç›¸åŒä¹Ÿæ²¡å…³ç³»\"}],\"ï¼\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{7-8}\",\"children\":\"// ç¬¬ä¸€æ¬¡æ¸²æŸ“\\nconst options1 = { serverUrl: 'https://localhost:1234', roomId: 'éŸ³ä¹' };\\n\\n// ä¸‹ä¸€æ¬¡æ¸²æŸ“\\nconst options2 = { serverUrl: 'https://localhost:1234', roomId: 'éŸ³ä¹' };\\n\\n// è¿™æ˜¯ 2 ä¸ªä¸åŒçš„å¯¹è±¡\\nconsole.log(Object.is(options1, options2)); // false\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"å¯¹è±¡å’Œå‡½æ•°ä½œä¸ºä¾èµ–ï¼Œä¼šä½¿ Effect æ¯”ä½ éœ€è¦çš„æ›´é¢‘ç¹åœ°é‡æ–°åŒæ­¥\"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ åº”è¯¥å°½å¯èƒ½é¿å…å°†å¯¹è±¡å’Œå‡½æ•°ä½œä¸º Effect çš„ä¾èµ–ã€‚æ‰€ä»¥ï¼Œå°è¯•å°†å®ƒä»¬ç§»åˆ°ç»„ä»¶å¤–éƒ¨ã€Effect å†…éƒ¨ï¼Œæˆ–ä»ä¸­æå–åŸå§‹å€¼ã€‚\"}],\"\\n\",[\"$r\",\"h4\",null,{\"id\":\"move-static-objects-and-functions-outside-your-component\",\"children\":\"å°†é™æ€å¯¹è±¡å’Œå‡½æ•°ç§»å‡ºç»„ä»¶ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å¦‚æœè¯¥å¯¹è±¡ä¸ä¾èµ–äºä»»ä½• props å’Œ stateï¼Œä½ å¯ä»¥å°†è¯¥å¯¹è±¡ç§»åˆ°ç»„ä»¶ä¹‹å¤–ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1-4,13}\",\"children\":\"const options = {\\n  serverUrl: 'https://localhost:1234',\\n  roomId: 'éŸ³ä¹'\\n};\\n\\nfunction ChatRoom() {\\n  const [message, setMessage] = useState('');\\n\\n  useEffect(() => {\\n    const connection = createConnection(options);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, []); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¿™æ ·ï¼Œä½ å‘ linter \",[\"$r\",\"strong\",null,{\"children\":\"è¯æ˜\"}],\" å®ƒä¸æ˜¯å“åº”å¼çš„ã€‚å®ƒä¸ä¼šå› ä¸ºé‡æ–°æ¸²æŸ“è€Œæ”¹å˜ï¼Œæ‰€ä»¥å®ƒä¸æ˜¯ä¾èµ–ã€‚ç°åœ¨é‡æ–°æ¸²æŸ“ \",[\"$r\",\"code\",null,{\"children\":\"ChatRoom\"}],\" ä¸ä¼šå¯¼è‡´ Effect é‡æ–°åŒæ­¥ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è¿™ä¹Ÿé€‚ç”¨äºå‡½æ•°åœºæ™¯ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1-6,12}\",\"children\":\"function createOptions() {\\n  return {\\n    serverUrl: 'https://localhost:1234',\\n    roomId: 'éŸ³ä¹'\\n  };\\n}\\n\\nfunction ChatRoom() {\\n  const [message, setMessage] = useState('');\\n\\n  useEffect(() => {\\n    const options = createOptions();\\n    const connection = createConnection(options);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, []); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç”±äº \",[\"$r\",\"code\",null,{\"children\":\"createOptions\"}],\" æ˜¯åœ¨ç»„ä»¶å¤–éƒ¨å£°æ˜çš„ï¼Œå› æ­¤å®ƒä¸æ˜¯å“åº”å¼å€¼ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä¸éœ€è¦åœ¨ Effect çš„ä¾èµ–ä¸­æŒ‡å®šï¼Œä»¥åŠä¸ºä»€ä¹ˆå®ƒæ°¸è¿œä¸ä¼šå¯¼è‡´ Effect é‡æ–°åŒæ­¥ã€‚\"]}],\"\\n\",[\"$r\",\"h4\",null,{\"id\":\"move-dynamic-objects-and-functions-inside-your-effect\",\"children\":\"å°†åŠ¨æ€å¯¹è±¡å’Œå‡½æ•°ç§»åŠ¨åˆ° Effect ä¸­ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å¦‚æœå¯¹è±¡ä¾èµ–äºä¸€äº›å¯èƒ½å› é‡æ–°æ¸²æŸ“è€Œæ”¹å˜çš„å“åº”å¼å€¼ï¼Œä¾‹å¦‚ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" propsï¼Œé‚£ä¹ˆä½ ä¸èƒ½å°†å®ƒæ”¾ç½®äºç»„ä»¶ \",[\"$r\",\"strong\",null,{\"children\":\"å¤–éƒ¨\"}],\"ã€‚ä½ å¯ä»¥åœ¨ Effect \",[\"$r\",\"strong\",null,{\"children\":\"å†…éƒ¨\"}],\" åˆ›å»ºå®ƒï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{7-10,11,14}\",\"children\":\"const serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId }) {\\n  const [message, setMessage] = useState('');\\n\\n  useEffect(() => {\\n    const options = {\\n      serverUrl: serverUrl,\\n      roomId: roomId\\n    };\\n    const connection = createConnection(options);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç°åœ¨ \",[\"$r\",\"code\",null,{\"children\":\"options\"}],\" å·²åœ¨ Effect ä¸­å£°æ˜ï¼Œå®ƒä¸å†æ˜¯ Effect çš„ä¾èµ–ã€‚ç›¸åï¼ŒEffect ä½¿ç”¨çš„å”¯ä¸€å“åº”å¼å€¼æ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\"ã€‚ç”±äº \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" ä¸æ˜¯å¯¹è±¡æˆ–å‡½æ•°ï¼Œä½ å¯ä»¥ç¡®å®šå®ƒä¸ä¼š \",[\"$r\",\"strong\",null,{\"children\":\"æ— æ„é—´\"}],\" å˜ä¸åŒã€‚åœ¨ JavaScript ä¸­ï¼Œæ•°å­—å’Œå­—ç¬¦ä¸²æ ¹æ®å®ƒä»¬çš„å†…å®¹è¿›è¡Œæ¯”è¾ƒï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{7-8}\",\"children\":\"// ç¬¬ä¸€æ¬¡æ¸²æŸ“\\nconst roomId1 = 'éŸ³ä¹';\\n\\n// ä¸‹ä¸€æ¬¡æ¸²æŸ“\\nconst roomId2 = 'éŸ³ä¹';\\n\\n// è¿™ 2 ä¸ªå­—ç¬¦ä¸²æ˜¯ç›¸åŒçš„\\nconsole.log(Object.is(roomId1, roomId2)); // true\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å¾—ç›Šäºæ­¤ä¿®å¤ï¼Œå½“ä½ ç¼–è¾‘è¾“å…¥æ—¶ï¼ŒèŠå¤©å°†ä¸å†é‡æ–°è¿æ¥ï¼š\"}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { createConnection } from './chat.js';\\n\\nconst serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId }) {\\n  const [message, setMessage] = useState('');\\n\\n  useEffect(() => {\\n    const options = {\\n      serverUrl: serverUrl,\\n      roomId: roomId\\n    };\\n    const connection = createConnection(options);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId]);\\n\\n  return (\\n    <>\\n      <h1>æ¬¢è¿æ¥åˆ° {roomId} æˆ¿é—´!</h1>\\n      <input value={message} onChange={e => setMessage(e.target.value)} />\\n    </>\\n  );\\n}\\n\\nexport default function App() {\\n  const [roomId, setRoomId] = useState('æ‰€æœ‰');\\n  return (\\n    <>\\n      <label>\\n        é€‰æ‹©èŠå¤©å®¤:{' '}\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"æ‰€æœ‰\\\">æ‰€æœ‰</option>\\n          <option value=\\\"æ—…æ¸¸\\\">æ—…æ¸¸</option>\\n          <option value=\\\"éŸ³ä¹\\\">éŸ³ä¹</option>\\n        </select>\\n      </label>\\n      <hr />\\n      <ChatRoom roomId={roomId} />\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection({ serverUrl, roomId }) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  return {\\n    connect() {\\n      console.log('âœ… è¿æ¥åˆ°â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl + '...');\\n    },\\n    disconnect() {\\n      console.log('âŒ æ–­å¼€â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"input { display: block; margin-bottom: 20px; }\\nbutton { margin-left: 10px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"272\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç„¶è€Œï¼Œå½“ä½ æ›´æ”¹ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" ä¸‹æ‹‰åˆ—è¡¨æ—¶ï¼Œå®ƒ \",[\"$r\",\"strong\",null,{\"children\":\"ç¡®å®\"}],\" é‡æ–°è¿æ¥ï¼Œæ­£å¦‚ä½ æ‰€æœŸæœ›çš„é‚£æ ·ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è¿™ä¹Ÿé€‚ç”¨äºå‡½æ•°çš„åœºæ™¯ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{7-12,14}\",\"children\":\"const serverUrl = 'https://localhost:1234';\\n\\nfunction ChatRoom({ roomId }) {\\n  const [message, setMessage] = useState('');\\n\\n  useEffect(() => {\\n    function createOptions() {\\n      return {\\n        serverUrl: serverUrl,\\n        roomId: roomId\\n      };\\n    }\\n\\n    const options = createOptions();\\n    const connection = createConnection(options);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä½ å¯ä»¥ç¼–å†™è‡ªå·±çš„å‡½æ•°æ¥ç»„ç»‡ Effect ä¸­çš„é€»è¾‘ã€‚åªè¦å°†è¿™äº›å‡½æ•°å£°æ˜åœ¨ Effect \",[\"$r\",\"strong\",null,{\"children\":\"å†…éƒ¨\"}],\"ï¼Œå®ƒä»¬å°±ä¸æ˜¯å“åº”å¼å€¼ï¼Œå› æ­¤å®ƒä»¬ä¹Ÿä¸æ˜¯ Effect çš„ä¾èµ–ã€‚\"]}],\"\\n\",[\"$r\",\"h4\",null,{\"id\":\"read-primitive-values-from-objects\",\"children\":\"ä»å¯¹è±¡ä¸­è¯»å–åŸå§‹å€¼ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"æœ‰æ—¶ï¼Œä½ å¯èƒ½ä¼šé€šè¿‡ props æ¥æ”¶åˆ°ç±»å‹ä¸ºå¯¹è±¡çš„å€¼ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1,5,8}\",\"children\":\"function ChatRoom({ options }) {\\n  const [message, setMessage] = useState('');\\n\\n  useEffect(() => {\\n    const connection = createConnection(options);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [options]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è¿™é‡Œçš„é£é™©æ˜¯çˆ¶ç»„ä»¶ä¼šåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­åˆ›å»ºå¯¹è±¡ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{3-6}\",\"children\":\"<ChatRoom\\n  roomId={roomId}\\n  options={{\\n    serverUrl: serverUrl,\\n    roomId: roomId\\n  }}\\n/>\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¿™å°†å¯¼è‡´ Effect åœ¨æ¯æ¬¡çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶é‡æ–°è¿æ¥ã€‚è¦è§£å†³æ­¤é—®é¢˜ï¼Œè¯·ä» Effect \",[\"$r\",\"strong\",null,{\"children\":\"å¤–éƒ¨\"}],\" è¯»å–å¯¹è±¡ä¿¡æ¯ï¼Œå¹¶é¿å…ä¾èµ–å¯¹è±¡å’Œå‡½æ•°ç±»å‹ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{4,7-8,12}\",\"children\":\"function ChatRoom({ options }) {\\n  const [message, setMessage] = useState('');\\n\\n  const { roomId, serverUrl } = options;\\n  useEffect(() => {\\n    const connection = createConnection({\\n      roomId: roomId,\\n      serverUrl: serverUrl\\n    });\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId, serverUrl]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"é€»è¾‘æœ‰ç‚¹é‡å¤ï¼ˆä½ ä» Effect å¤–éƒ¨çš„å¯¹è±¡è¯»å–ä¸€äº›å€¼ï¼Œç„¶ååœ¨ Effect å†…éƒ¨åˆ›å»ºå…·æœ‰ç›¸åŒå€¼çš„å¯¹è±¡ï¼‰ã€‚ä½†è¿™ä½¿å¾— Effect \",[\"$r\",\"strong\",null,{\"children\":\"å®é™…\"}],\" ä¾èµ–çš„ä¿¡æ¯éå¸¸æ˜ç¡®ã€‚å¦‚æœå¯¹è±¡è¢«çˆ¶ç»„ä»¶æ— æ„ä¸­é‡æ–°åˆ›å»ºï¼ŒèŠå¤©ä¹Ÿä¸ä¼šé‡æ–°è¿æ¥ã€‚ä½†æ˜¯ï¼Œå¦‚æœ \",[\"$r\",\"code\",null,{\"children\":\"options.roomId\"}],\" æˆ– \",[\"$r\",\"code\",null,{\"children\":\"options.serverUrl\"}],\" ç¡®å®ä¸åŒï¼ŒèŠå¤©å°†é‡æ–°è¿æ¥ã€‚\"]}],\"\\n\",[\"$r\",\"h4\",null,{\"id\":\"calculate-primitive-values-from-functions\",\"children\":\"ä»å‡½æ•°ä¸­è®¡ç®—åŸå§‹å€¼ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"åŒæ ·çš„æ–¹æ³•ä¹Ÿé€‚ç”¨äºå‡½æ•°ã€‚ä¾‹å¦‚ï¼Œå‡è®¾çˆ¶ç»„ä»¶ä¼ é€’äº†ä¸€ä¸ªå‡½æ•°ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{3-8}\",\"children\":\"<ChatRoom\\n  roomId={roomId}\\n  getOptions={() => {\\n    return {\\n      serverUrl: serverUrl,\\n      roomId: roomId\\n    };\\n  }}\\n/>\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä¸ºé¿å…ä½¿å…¶æˆä¸ºä¾èµ–ï¼ˆå¹¶å¯¼è‡´å®ƒåœ¨é‡æ–°æ¸²æŸ“æ—¶é‡æ–°è¿æ¥ï¼‰ï¼Œè¯·åœ¨ Effect å¤–éƒ¨è°ƒç”¨å®ƒã€‚è¿™ä¸ºä½ æä¾›äº†ä¸æ˜¯å¯¹è±¡çš„ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" å’Œ \",[\"$r\",\"code\",null,{\"children\":\"serverUrl\"}],\" å€¼ï¼Œä½ å¯ä»¥ä» Effect ä¸­è¯»å–å®ƒä»¬ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1,4}\",\"children\":\"function ChatRoom({ getOptions }) {\\n  const [message, setMessage] = useState('');\\n\\n  const { roomId, serverUrl } = getOptions();\\n  useEffect(() => {\\n    const connection = createConnection({\\n      roomId: roomId,\\n      serverUrl: serverUrl\\n    });\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId, serverUrl]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¿™ä»…é€‚ç”¨äº \",[\"$r\",\"a\",null,{\"href\":\"/learn/keeping-components-pure\",\"children\":\"çº¯\"}],\" å‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬åœ¨æ¸²æŸ“æœŸé—´å¯ä»¥å®‰å…¨è°ƒç”¨ã€‚å¦‚æœå‡½æ•°æ˜¯ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œä½†ä½ ä¸å¸Œæœ›å®ƒçš„æ›´æ”¹é‡æ–°åŒæ­¥ Effectï¼Œ\",[\"$r\",\"a\",null,{\"href\":\"#do-you-want-to-read-a-value-without-reacting-to-its-changes\",\"children\":\"å°†å®ƒåŒ…è£…åˆ° Effect Event ä¸­\"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"Recap\",null,{\"children\":[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ä¾èµ–åº”å§‹ç»ˆä¸ä»£ç åŒ¹é…ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"å½“ä½ å¯¹ä¾èµ–ä¸æ»¡æ„æ—¶ï¼Œä½ éœ€è¦ç¼–è¾‘çš„æ˜¯ä»£ç ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"æŠ‘åˆ¶ linter ä¼šå¯¼è‡´éå¸¸æ··ä¹±çš„é”™è¯¯ï¼Œä½ åº”è¯¥å§‹ç»ˆé¿å…å®ƒã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"è¦ç§»é™¤ä¾èµ–ï¼Œä½ éœ€è¦å‘ linter â€œè¯æ˜â€å®ƒä¸æ˜¯å¿…éœ€çš„ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"å¦‚æœæŸäº›ä»£ç æ˜¯ä¸ºäº†å“åº”ç‰¹å®šäº¤äº’ï¼Œè¯·å°†è¯¥ä»£ç ç§»è‡³äº‹ä»¶å¤„ç†çš„åœ°æ–¹ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"å¦‚æœ Effect çš„ä¸åŒéƒ¨åˆ†å› ä¸åŒåŸå› éœ€è¦é‡æ–°è¿è¡Œï¼Œè¯·å°†å…¶æ‹†åˆ†ä¸ºå¤šä¸ª Effectã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"å¦‚æœä½ æƒ³æ ¹æ®ä»¥å‰çš„çŠ¶æ€æ›´æ–°ä¸€äº›çŠ¶æ€ï¼Œä¼ é€’ä¸€ä¸ªæ›´æ–°å‡½æ•°ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"å¦‚æœä½ æƒ³è¯»å–æœ€æ–°å€¼è€Œä¸â€œååº”â€å®ƒï¼Œè¯·ä» Effect ä¸­æå–å‡ºä¸€ä¸ª Effect Eventã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"åœ¨ JavaScript ä¸­ï¼Œå¦‚æœå¯¹è±¡å’Œå‡½æ•°æ˜¯åœ¨ä¸åŒæ—¶é—´åˆ›å»ºçš„ï¼Œåˆ™å®ƒä»¬è¢«è®¤ä¸ºæ˜¯ä¸åŒçš„ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"å°½é‡é¿å…å¯¹è±¡å’Œå‡½æ•°ä¾èµ–ã€‚å°†å®ƒä»¬ç§»åˆ°ç»„ä»¶å¤–æˆ– Effect å†…ã€‚\"}],\"\\n\"]}]}],\"\\n\"]}],[\"$r\",\"Challenges\",null,{\"children\":[[\"$r\",\"h4\",null,{\"id\":\"fix-a-resetting-interval\",\"children\":\"ä¿®å¤é‡ç½® interval \"}],[\"$r\",\"p\",null,{\"children\":\"è¿™ä¸ª Effect è®¾ç½®äº†ä¸€ä¸ªæ¯ç§’è¿è¡Œçš„ intervalã€‚ä½ å·²ç»æ³¨æ„åˆ°ä¸€äº›å¥‡æ€ªçš„äº‹æƒ…ï¼šä¼¼ä¹æ¯æ¬¡ interval éƒ½ä¼šè¢«é”€æ¯å¹¶é‡æ–°åˆ›å»ºã€‚ä¿®å¤ä»£ç ï¼Œä½¿ interval ä¸ä¼šè¢«ä¸æ–­é‡æ–°åˆ›å»ºã€‚\"}],[\"$r\",\"Hint\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":[\"çœ‹èµ·æ¥è¿™ä¸ª Effect çš„ä»£ç ä¾èµ–äº \",[\"$r\",\"code\",null,{\"children\":\"count\"}],\"ã€‚æœ‰ä»€ä¹ˆæ–¹æ³•ä¸éœ€è¦è¿™ä¾èµ–å—ï¼Ÿæœ‰ï¼Œé‚£å°±æ˜¯æ ¹æ®å…¶ä¹‹å‰çš„å€¼æ›´æ–° \",[\"$r\",\"code\",null,{\"children\":\"count\"}],\" stateï¼Œä»è€Œé¿å…æ·»åŠ å¯¹è¯¥å€¼çš„ä¾èµ–ã€‚\"]}]}],[\"$r\",\"Sandpack\",null,{\"children\":[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\n\\nexport default function Timer() {\\n  const [count, setCount] = useState(0);\\n\\n  useEffect(() => {\\n    console.log('âœ… åˆ›å»ºå®šæ—¶å™¨');\\n    const id = setInterval(() => {\\n      console.log('â° Interval');\\n      setCount(count + 1);\\n    }, 1000);\\n    return () => {\\n      console.log('âŒ æ¸…é™¤å®šæ—¶å™¨');\\n      clearInterval(id);\\n    };\\n  }, [count]);\\n\\n  return <h1>è®¡æ•°å™¨: {count}</h1>\\n}\\n\"}]}]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"ä½ æƒ³è¦ä» Effect å†…éƒ¨å°† \",[\"$r\",\"code\",null,{\"children\":\"count\"}],\" çŠ¶æ€æ›´æ–°ä¸º \",[\"$r\",\"code\",null,{\"children\":\"count + 1\"}],\"ã€‚ä½†æ˜¯ï¼Œè¿™ä¼šä½¿ Effect ä¾èµ–äº \",[\"$r\",\"code\",null,{\"children\":\"count\"}],\"ï¼Œå®ƒä¼šéšç€æ¯æ¬¡æ»´ç­”è€Œå˜åŒ–ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ interval ä¼šåœ¨æ¯æ¬¡æ»´ç­”æ—¶é‡æ–°åˆ›å»ºã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¯·ä½¿ç”¨ \",[\"$r\",\"a\",null,{\"href\":\"/reference/react/useState#updating-state-based-on-the-previous-state\",\"children\":\"æ›´æ–°å‡½æ•°\"}],\" å¹¶ç¼–å†™ \",[\"$r\",\"code\",null,{\"children\":\"setCount(c => c + 1)\"}],\" è€Œä¸æ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"setCount(count + 1)\"}],\":\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\n\\nexport default function Timer() {\\n  const [count, setCount] = useState(0);\\n\\n  useEffect(() => {\\n    console.log('âœ… åˆ›å»ºå®šæ—¶å™¨');\\n    const id = setInterval(() => {\\n      console.log('â° Interval');\\n      setCount(c => c + 1);\\n    }, 1000);\\n    return () => {\\n      console.log('âŒ æ¸…é™¤å®šæ—¶å™¨');\\n      clearInterval(id);\\n    };\\n  }, []);\\n\\n  return <h1>è®¡æ•°å™¨: {count}</h1>\\n}\\n\"}]}]}],[\"$r\",\"p\",null,{\"children\":[\"ä½ ä¸åº”åœ¨ Effect ä¸­è¯»å– \",[\"$r\",\"code\",null,{\"children\":\"count\"}],\"ï¼Œè€Œæ˜¯å°† \",[\"$r\",\"code\",null,{\"children\":\"c => c + 1\"}],\" æŒ‡ä»¤ï¼ˆâ€œå¢åŠ æ­¤æ•°å­—ï¼â€ï¼‰ä¼ é€’ç»™ Reactã€‚React å°†åœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œå®ƒã€‚ç”±äºä½ ä¸å†éœ€è¦è¯»å– Effect ä¸­ \",[\"$r\",\"code\",null,{\"children\":\"count\"}],\" çš„å€¼ï¼Œå› æ­¤ä½ å¯ä»¥å°† Effect çš„ä¾èµ–ä¿æŒä¸ºç©ºï¼ˆ\",[\"$r\",\"code\",null,{\"children\":\"[]\"}],\"ï¼‰ã€‚è¿™å¯ä»¥é˜²æ­¢ Effect åœ¨æ¯æ¬¡æ‰§è¡Œæ—¶é‡æ–°åˆ›å»ºå®šæ—¶å™¨ intervalã€‚\"]}]]}],[\"$r\",\"h4\",null,{\"id\":\"fix-a-retriggering-animation\",\"children\":\"ä¿®å¤é‡æ–°è§¦å‘åŠ¨ç”»çš„é—®é¢˜ \"}],[\"$r\",\"p\",null,{\"children\":[\"åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå½“ä½ æŒ‰ä¸‹â€œæ˜¾ç¤ºâ€æ—¶ï¼Œæ¬¢è¿æ¶ˆæ¯æ·¡å…¥ã€‚åŠ¨ç”»æŒç»­ä¸€ç§’é’Ÿã€‚å½“ä½ æŒ‰ä¸‹â€œç§»é™¤â€æ—¶ï¼Œæ¬¢è¿ä¿¡æ¯ç«‹å³æ¶ˆå¤±ã€‚æ·¡å…¥åŠ¨ç”»çš„é€»è¾‘åœ¨ \",[\"$r\",\"code\",null,{\"children\":\"animation.js\"}],\" æ–‡ä»¶ä¸­ä»¥çº¯ JavaScript \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/window/requestAnimationFrame\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"åŠ¨ç”»å¾ªç¯\"}],\" å®ç°ã€‚ä½ ä¸éœ€è¦æ”¹å˜é‚£ä¸ªé€»è¾‘ã€‚ä½ å¯ä»¥å°†å…¶è§†ä¸ºç¬¬ä¸‰æ–¹åº“ã€‚Effect çš„é€»è¾‘æ˜¯ä¸º DOM èŠ‚ç‚¹åˆ›å»ºä¸€ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"FadeInAnimation\"}],\" å®ä¾‹ï¼Œç„¶åè°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"start(duration)\"}],\" æˆ– \",[\"$r\",\"code\",null,{\"children\":\"stop()\"}],\" æ¥æ§åˆ¶åŠ¨ç”»ã€‚\",[\"$r\",\"code\",null,{\"children\":\"duration\"}],\" ç”±æ»‘å—æ§åˆ¶ã€‚è°ƒæ•´æ»‘å—å¹¶æŸ¥çœ‹åŠ¨ç”»å¦‚ä½•å˜åŒ–ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"æ­¤ä»£ç å·²ç»èƒ½å·¥ä½œï¼Œä½†ä½ éœ€è¦æ›´æ”¹ä¸€äº›å†…å®¹ã€‚ç›®å‰ï¼Œå½“ä½ ç§»åŠ¨æ§åˆ¶ \",[\"$r\",\"code\",null,{\"children\":\"duration\"}],\" çŠ¶æ€å˜é‡çš„æ»‘å—æ—¶ï¼Œå®ƒä¼šé‡æ–°è§¦å‘åŠ¨ç”»ã€‚æ›´æ”¹è¡Œä¸ºï¼Œä½¿ Effect ä¸ä¼šå¯¹ \",[\"$r\",\"code\",null,{\"children\":\"duration\"}],\" å˜é‡åšå‡ºâ€œååº”â€ã€‚å½“ä½ æŒ‰ä¸‹â€œæ˜¾ç¤ºâ€æ—¶ï¼ŒEffect åº”è¯¥ä½¿ç”¨æ»‘å—ä¸Šçš„å½“å‰ \",[\"$r\",\"code\",null,{\"children\":\"duration\"}],\" å€¼ã€‚ä½†æ˜¯ï¼Œç§»åŠ¨æ»‘å—æœ¬èº«ä¸åº”é‡æ–°è§¦å‘åŠ¨ç”»ã€‚\"]}],[\"$r\",\"Hint\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":\"Effect ä¸­æ˜¯å¦æœ‰ä¸€è¡Œä»£ç ä¸åº”è¯¥æ˜¯å“åº”å¼çš„ï¼Ÿå¦‚ä½•å°†éå“åº”å¼ä»£ç ç§»å‡º Effectï¼Ÿ\"}]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"experimental\\\",\\n    \\\"react-dom\\\": \\\"experimental\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect, useRef } from 'react';\\nimport { experimental_useEffectEvent as useEffectEvent } from 'react';\\nimport { FadeInAnimation } from './animation.js';\\n\\nfunction Welcome({ duration }) {\\n  const ref = useRef(null);\\n\\n  useEffect(() => {\\n    const animation = new FadeInAnimation(ref.current);\\n    animation.start(duration);\\n    return () => {\\n      animation.stop();\\n    };\\n  }, [duration]);\\n\\n  return (\\n    <h1\\n      ref={ref}\\n      style={{\\n        opacity: 0,\\n        color: 'white',\\n        padding: 50,\\n        textAlign: 'center',\\n        fontSize: 50,\\n        backgroundImage: 'radial-gradient(circle, rgba(63,94,251,1) 0%, rgba(252,70,107,1) 100%)'\\n      }}\\n    >\\n      æ¬¢è¿\\n    </h1>\\n  );\\n}\\n\\nexport default function App() {\\n  const [duration, setDuration] = useState(1000);\\n  const [show, setShow] = useState(false);\\n\\n  return (\\n    <>\\n      <label>\\n        <input\\n          type=\\\"range\\\"\\n          min=\\\"100\\\"\\n          max=\\\"3000\\\"\\n          value={duration}\\n          onChange={e => setDuration(Number(e.target.value))}\\n        />\\n        <br />\\n        æ·¡å…¥ interval: {duration} ms\\n      </label>\\n      <button onClick={() => setShow(!show)}>\\n        {show ? 'ç§»é™¤' : 'æ˜¾ç¤º'}\\n      </button>\\n      <hr />\\n      {show && <Welcome duration={duration} />}\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/animation.js\",\"children\":\"export class FadeInAnimation {\\n  constructor(node) {\\n    this.node = node;\\n  }\\n  start(duration) {\\n    this.duration = duration;\\n    if (this.duration === 0) {\\n      // Jump to end immediately\\n      this.onProgress(1);\\n    } else {\\n      this.onProgress(0);\\n      // Start animating\\n      this.startTime = performance.now();\\n      this.frameId = requestAnimationFrame(() => this.onFrame());\\n    }\\n  }\\n  onFrame() {\\n    const timePassed = performance.now() - this.startTime;\\n    const progress = Math.min(timePassed / this.duration, 1);\\n    this.onProgress(progress);\\n    if (progress < 1) {\\n      // We still have more frames to paint\\n      this.frameId = requestAnimationFrame(() => this.onFrame());\\n    }\\n  }\\n  onProgress(progress) {\\n    this.node.style.opacity = progress;\\n  }\\n  stop() {\\n    cancelAnimationFrame(this.frameId);\\n    this.startTime = null;\\n    this.frameId = null;\\n    this.duration = 0;\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label, button { display: block; margin-bottom: 20px; }\\nhtml, body { min-height: 300px; }\\n\"}]}]]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"Effect éœ€è¦è¯»å– \",[\"$r\",\"code\",null,{\"children\":\"duration\"}],\" çš„æœ€æ–°å€¼ï¼Œä½†ä½ ä¸å¸Œæœ›å®ƒå¯¹ \",[\"$r\",\"code\",null,{\"children\":\"duration\"}],\" çš„å˜åŒ–åšå‡ºâ€œååº”â€ã€‚ä½ ä½¿ç”¨ \",[\"$r\",\"code\",null,{\"children\":\"duration\"}],\" æ¥å¯åŠ¨åŠ¨ç”»ï¼Œä½†å¯åŠ¨åŠ¨ç”»ä¸æ˜¯å“åº”å¼çš„ã€‚å°†éå“åº”å¼ä»£ç è¡Œæå–åˆ° Effect Event ä¸­ï¼Œå¹¶ä» Effect ä¸­è°ƒç”¨è¯¥å‡½æ•°ã€‚\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"experimental\\\",\\n    \\\"react-dom\\\": \\\"experimental\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect, useRef } from 'react';\\nimport { FadeInAnimation } from './animation.js';\\nimport { experimental_useEffectEvent as useEffectEvent } from 'react';\\n\\nfunction Welcome({ duration }) {\\n  const ref = useRef(null);\\n\\n  const onAppear = useEffectEvent(animation => {\\n    animation.start(duration);\\n  });\\n\\n  useEffect(() => {\\n    const animation = new FadeInAnimation(ref.current);\\n    onAppear(animation);\\n    return () => {\\n      animation.stop();\\n    };\\n  }, []);\\n\\n  return (\\n    <h1\\n      ref={ref}\\n      style={{\\n        opacity: 0,\\n        color: 'white',\\n        padding: 50,\\n        textAlign: 'center',\\n        fontSize: 50,\\n        backgroundImage: 'radial-gradient(circle, rgba(63,94,251,1) 0%, rgba(252,70,107,1) 100%)'\\n      }}\\n    >\\n      æ¬¢è¿\\n    </h1>\\n  );\\n}\\n\\nexport default function App() {\\n  const [duration, setDuration] = useState(1000);\\n  const [show, setShow] = useState(false);\\n\\n  return (\\n    <>\\n      <label>\\n        <input\\n          type=\\\"range\\\"\\n          min=\\\"100\\\"\\n          max=\\\"3000\\\"\\n          value={duration}\\n          onChange={e => setDuration(Number(e.target.value))}\\n        />\\n        <br />\\n        æ·¡å…¥ interval: {duration} ms\\n      </label>\\n      <button onClick={() => setShow(!show)}>\\n        {show ? 'ç§»é™¤' : 'æ˜¾ç¤º'}\\n      </button>\\n      <hr />\\n      {show && <Welcome duration={duration} />}\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/animation.js\",\"children\":\"export class FadeInAnimation {\\n  constructor(node) {\\n    this.node = node;\\n  }\\n  start(duration) {\\n    this.duration = duration;\\n    this.onProgress(0);\\n    this.startTime = performance.now();\\n    this.frameId = requestAnimationFrame(() => this.onFrame());\\n  }\\n  onFrame() {\\n    const timePassed = performance.now() - this.startTime;\\n    const progress = Math.min(timePassed / this.duration, 1);\\n    this.onProgress(progress);\\n    if (progress < 1) {\\n      // We still have more frames to paint\\n      this.frameId = requestAnimationFrame(() => this.onFrame());\\n    }\\n  }\\n  onProgress(progress) {\\n    this.node.style.opacity = progress;\\n  }\\n  stop() {\\n    cancelAnimationFrame(this.frameId);\\n    this.startTime = null;\\n    this.frameId = null;\\n    this.duration = 0;\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label, button { display: block; margin-bottom: 20px; }\\nhtml, body { min-height: 300px; }\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":[\"åƒ \",[\"$r\",\"code\",null,{\"children\":\"onAppear\"}],\" è¿™æ ·çš„ Effect Events ä¸æ˜¯å“åº”å¼çš„ï¼Œå› æ­¤ä½ å¯ä»¥åœ¨ä¸é‡æ–°è§¦å‘åŠ¨ç”»çš„æƒ…å†µä¸‹è¯»å–å†…éƒ¨çš„ \",[\"$r\",\"code\",null,{\"children\":\"duration\"}],\"ã€‚\"]}]]}],[\"$r\",\"h4\",null,{\"id\":\"fix-a-reconnecting-chat\",\"children\":\"ä¿®å¤èŠå¤©é‡æ–°è¿æ¥çš„é—®é¢˜ \"}],[\"$r\",\"p\",null,{\"children\":\"åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæ¯æ¬¡ä½ æŒ‰â€œåˆ‡æ¢ä¸»é¢˜â€æ—¶ï¼ŒèŠå¤©éƒ½ä¼šé‡æ–°è¿æ¥ã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿä¿®å¤é”™è¯¯ï¼Œåªæœ‰å½“ä½ ç¼–è¾‘æœåŠ¡å™¨ URL æˆ–é€‰æ‹©ä¸åŒçš„èŠå¤©å®¤æ—¶ï¼ŒèŠå¤©æ‰ä¼šé‡æ–°è¿æ¥ã€‚\"}],[\"$r\",\"p\",null,{\"children\":[\"å°† \",[\"$r\",\"code\",null,{\"children\":\"chat.js\"}],\" è§†ä¸ºå¤–éƒ¨ç¬¬ä¸‰æ–¹åº“ï¼šä½ å¯ä»¥æŸ¥é˜…å®ƒä»¥æ£€æŸ¥å…¶ APIï¼Œä½†ä¸è¦å¯¹å…¶è¿›è¡Œç¼–è¾‘ã€‚\"]}],[\"$r\",\"Hint\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":\"è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ä¸æ­¢ä¸€ç§ï¼Œä½†æœ€ç»ˆä½ å¸Œæœ›é¿å…å°†å¯¹è±¡ä½œä¸ºä¾èµ–ã€‚\"}]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js\",\"children\":\"import { useState } from 'react';\\nimport ChatRoom from './ChatRoom.js';\\n\\nexport default function App() {\\n  const [isDark, setIsDark] = useState(false);\\n  const [roomId, setRoomId] = useState('æ‰€æœ‰');\\n  const [serverUrl, setServerUrl] = useState('https://localhost:1234');\\n\\n  const options = {\\n    serverUrl: serverUrl,\\n    roomId: roomId\\n  };\\n\\n  return (\\n    <div className={isDark ? 'dark' : 'light'}>\\n      <button onClick={() => setIsDark(!isDark)}>\\n        åˆ‡æ¢ä¸»é¢˜\\n      </button>\\n      <label>\\n        æœåŠ¡å™¨åœ°å€ï¼š\\n        <input\\n          value={serverUrl}\\n          onChange={e => setServerUrl(e.target.value)}\\n        />\\n      </label>\\n      <label>\\n        é€‰æ‹©èŠå¤©å®¤ï¼š\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"æ‰€æœ‰\\\">æ‰€æœ‰</option>\\n          <option value=\\\"æ—…æ¸¸\\\">æ—…æ¸¸</option>\\n          <option value=\\\"éŸ³ä¹\\\">éŸ³ä¹</option>\\n        </select>\\n      </label>\\n      <hr />\\n      <ChatRoom options={options} />\\n    </div>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/ChatRoom.js active\",\"children\":\"import { useEffect } from 'react';\\nimport { createConnection } from './chat.js';\\n\\nexport default function ChatRoom({ options }) {\\n  useEffect(() => {\\n    const connection = createConnection(options);\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [options]);\\n\\n  return <h1>æ¬¢è¿æ¥åˆ° {options.roomId} æˆ¿é—´ï¼</h1>;\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection({ serverUrl, roomId }) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  if (typeof serverUrl !== 'string') {\\n    throw Error('æœŸæœ› serverUrl æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + serverUrl);\\n  }\\n  if (typeof roomId !== 'string') {\\n    throw Error('æœŸæœ› roomId æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + roomId);\\n  }\\n  return {\\n    connect() {\\n      console.log('âœ… è¿æ¥åˆ°â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl + '...');\\n    },\\n    disconnect() {\\n      console.log('âŒ æ–­å¼€â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label, button { display: block; margin-bottom: 5px; }\\n.dark { background: #222; color: #eee; }\\n\"}]}]]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"Effect å› ä¾èµ–äº \",[\"$r\",\"code\",null,{\"children\":\"options\"}],\" å¯¹è±¡ï¼Œå¯¼è‡´å…¶é‡æ–°è¿è¡Œã€‚å¯¹è±¡å¯èƒ½ä¼šåœ¨æ— æ„ä¸­è¢«é‡æ–°åˆ›å»ºï¼Œä½ åº”è¯¥å°½å¯èƒ½é¿å…å°†å®ƒä»¬ä½œä¸º Effect çš„ä¾èµ–ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"ä¾µå…¥æ€§æœ€å°çš„ä¿®å¤æ–¹æ³•æ˜¯åœ¨ Effect å¤–éƒ¨è¯»å– \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" å’Œ \",[\"$r\",\"code\",null,{\"children\":\"serverUrl\"}],\"ï¼Œç„¶åä½¿ Effect ä¾èµ–äºè¿™äº›åŸå§‹å€¼ï¼ˆä¸èƒ½æ— æ„åœ°æ›´æ”¹ï¼‰ã€‚åœ¨ Effect å†…éƒ¨ï¼Œåˆ›å»ºä¸€ä¸ªå¯¹è±¡å¹¶å°†å…¶ä¼ é€’ç»™ \",[\"$r\",\"code\",null,{\"children\":\"createConnection\"}],\"ï¼š\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js\",\"children\":\"import { useState } from 'react';\\nimport ChatRoom from './ChatRoom.js';\\n\\nexport default function App() {\\n  const [isDark, setIsDark] = useState(false);\\n  const [roomId, setRoomId] = useState('æ‰€æœ‰');\\n  const [serverUrl, setServerUrl] = useState('https://localhost:1234');\\n\\n  const options = {\\n    serverUrl: serverUrl,\\n    roomId: roomId\\n  };\\n\\n  return (\\n    <div className={isDark ? 'dark' : 'light'}>\\n      <button onClick={() => setIsDark(!isDark)}>\\n        åˆ‡æ¢ä¸»é¢˜\\n      </button>\\n      <label>\\n        æœåŠ¡å™¨åœ°å€ï¼š\\n        <input\\n          value={serverUrl}\\n          onChange={e => setServerUrl(e.target.value)}\\n        />\\n      </label>\\n      <label>\\n        é€‰æ‹©èŠå¤©å®¤ï¼š\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"æ‰€æœ‰\\\">æ‰€æœ‰</option>\\n          <option value=\\\"æ—…æ¸¸\\\">æ—…æ¸¸</option>\\n          <option value=\\\"éŸ³ä¹\\\">éŸ³ä¹</option>\\n        </select>\\n      </label>\\n      <hr />\\n      <ChatRoom options={options} />\\n    </div>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/ChatRoom.js active\",\"children\":\"import { useEffect } from 'react';\\nimport { createConnection } from './chat.js';\\n\\nexport default function ChatRoom({ options }) {\\n  const { roomId, serverUrl } = options;\\n  useEffect(() => {\\n    const connection = createConnection({\\n      roomId: roomId,\\n      serverUrl: serverUrl\\n    });\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId, serverUrl]);\\n\\n  return <h1>æ¬¢è¿æ¥åˆ° {options.roomId} æˆ¿é—´ï¼</h1>;\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection({ serverUrl, roomId }) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  if (typeof serverUrl !== 'string') {\\n    throw Error('æœŸæœ› serverUrl æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + serverUrl);\\n  }\\n  if (typeof roomId !== 'string') {\\n    throw Error('æœŸæœ› roomId æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + roomId);\\n  }\\n  return {\\n    connect() {\\n      console.log('âœ… è¿æ¥åˆ°â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl + '...');\\n    },\\n    disconnect() {\\n      console.log('âŒ æ–­å¼€â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label, button { display: block; margin-bottom: 5px; }\\n.dark { background: #222; color: #eee; }\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":[\"ç”¨æ›´å…·ä½“çš„ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" å’Œ \",[\"$r\",\"code\",null,{\"children\":\"serverUrl\"}],\" props æ›¿æ¢å¯¹è±¡ \",[\"$r\",\"code\",null,{\"children\":\"options\"}],\" props ä¼šæ›´å¥½ï¼š\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js\",\"children\":\"import { useState } from 'react';\\nimport ChatRoom from './ChatRoom.js';\\n\\nexport default function App() {\\n  const [isDark, setIsDark] = useState(false);\\n  const [roomId, setRoomId] = useState('æ‰€æœ‰');\\n  const [serverUrl, setServerUrl] = useState('https://localhost:1234');\\n\\n  return (\\n    <div className={isDark ? 'dark' : 'light'}>\\n      <button onClick={() => setIsDark(!isDark)}>\\n        åˆ‡æ¢ä¸»é¢˜\\n      </button>\\n      <label>\\n        æœåŠ¡å™¨åœ°å€ï¼š\\n        <input\\n          value={serverUrl}\\n          onChange={e => setServerUrl(e.target.value)}\\n        />\\n      </label>\\n      <label>\\n        é€‰æ‹©èŠå¤©å®¤ï¼š\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"æ‰€æœ‰\\\">æ‰€æœ‰</option>\\n          <option value=\\\"æ—…æ¸¸\\\">æ—…æ¸¸</option>\\n          <option value=\\\"éŸ³ä¹\\\">éŸ³ä¹</option>\\n        </select>\\n      </label>\\n      <hr />\\n      <ChatRoom\\n        roomId={roomId}\\n        serverUrl={serverUrl}\\n      />\\n    </div>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/ChatRoom.js active\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { createConnection } from './chat.js';\\n\\nexport default function ChatRoom({ roomId, serverUrl }) {\\n  useEffect(() => {\\n    const connection = createConnection({\\n      roomId: roomId,\\n      serverUrl: serverUrl\\n    });\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId, serverUrl]);\\n\\n  return <h1>æ¬¢è¿æ¥åˆ° {roomId} æˆ¿é—´ï¼</h1>;\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection({ serverUrl, roomId }) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  if (typeof serverUrl !== 'string') {\\n    throw Error('æœŸæœ› serverUrl æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + serverUrl);\\n  }\\n  if (typeof roomId !== 'string') {\\n    throw Error('æœŸæœ› roomId æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + roomId);\\n  }\\n  return {\\n    connect() {\\n      console.log('âœ… è¿æ¥åˆ°â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl + '...');\\n    },\\n    disconnect() {\\n      console.log('âŒ æ–­å¼€â€œ' + roomId + 'â€æˆ¿é—´ï¼Œåœ¨ ' + serverUrl);\\n    }\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label, button { display: block; margin-bottom: 5px; }\\n.dark { background: #222; color: #eee; }\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":\"å°½å¯èƒ½åšæŒä½¿ç”¨åŸå§‹ propsï¼Œä»¥ä¾¿ä»¥åæ›´å®¹æ˜“ä¼˜åŒ–ç»„ä»¶ã€‚\"}]]}],[\"$r\",\"h4\",null,{\"id\":\"fix-a-reconnecting-chat-again\",\"children\":\"å†æ¬¡ä¿®å¤èŠå¤©é‡æ–°è¿æ¥çš„é—®é¢˜ \"}],[\"$r\",\"p\",null,{\"children\":\"æ­¤ç¤ºä¾‹ä½¿ç”¨æˆ–ä¸ä½¿ç”¨åŠ å¯†è¿æ¥åˆ°èŠå¤©ã€‚åˆ‡æ¢å¤é€‰æ¡†å¹¶æ³¨æ„åŠ å¯†æ‰“å¼€å’Œå…³é—­æ—¶æ§åˆ¶å°ä¸­çš„ä¸åŒæ¶ˆæ¯ã€‚æ¢ä¸ªæˆ¿é—´è¯•è¯•ï¼Œç„¶åï¼Œå°è¯•åˆ‡æ¢ä¸»é¢˜ã€‚å½“ä½ è¿æ¥åˆ°èŠå¤©å®¤æ—¶ï¼Œæ¯éš”å‡ ç§’é’Ÿå°±ä¼šæ”¶åˆ°ä¸€æ¡æ–°æ¶ˆæ¯ã€‚éªŒè¯å®ƒä»¬çš„é¢œè‰²æ˜¯å¦ä¸ä½ é€‰æ‹©çš„ä¸»é¢˜ç›¸åŒ¹é…ã€‚\"}],[\"$r\",\"p\",null,{\"children\":\"åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæ¯æ¬¡ä½ å°è¯•æ›´æ”¹ä¸»é¢˜æ—¶èŠå¤©éƒ½ä¼šé‡æ–°è¿æ¥ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä¿®å¤åï¼Œæ›´æ”¹ä¸»é¢˜ä¸åº”é‡æ–°è¿æ¥èŠå¤©ï¼Œä½†åˆ‡æ¢åŠ å¯†è®¾ç½®æˆ–æ›´æ”¹æˆ¿é—´åº”é‡æ–°è¿æ¥ã€‚\"}],[\"$r\",\"p\",null,{\"children\":[\"ä¸è¦æ›´æ”¹ \",[\"$r\",\"code\",null,{\"children\":\"chat.js\"}],\" ä¸­çš„ä»»ä½•ä»£ç ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½ å¯ä»¥æ›´æ”¹ä»»ä½•ä»£ç ï¼Œåªè¦å®ƒå¼•èµ·ç›¸åŒçš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šå‘ç°æ›´æ”¹æ­£åœ¨ä¼ é€’çš„ props å¾ˆæœ‰å¸®åŠ©ã€‚\"]}],[\"$r\",\"Hint\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"ä½ ä¼ é€’äº†ä¸¤ä¸ªå‡½æ•°ï¼š\",[\"$r\",\"code\",null,{\"children\":\"onMessage\"}],\" å’Œ \",[\"$r\",\"code\",null,{\"children\":\"createConnection\"}],\"ã€‚æ¯æ¬¡ \",[\"$r\",\"code\",null,{\"children\":\"App\"}],\" é‡æ–°æ¸²æŸ“æ—¶ï¼Œå®ƒä»¬éƒ½æ˜¯ä»å¤´å¼€å§‹åˆ›å»ºçš„ã€‚å®ƒä»¬æ¯æ¬¡éƒ½è¢«è§†ä¸ºæ–°å€¼ï¼Œè¿™å°±æ˜¯å®ƒä»¬é‡æ–°è§¦å‘ Effect çš„åŸå› ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":\"å‰è€…æ˜¯äº‹ä»¶å¤„ç†ç¨‹åºã€‚ä½ çŸ¥é“åœ¨ä¸å¯¹æ–°çš„äº‹ä»¶å¤„ç†å‡½æ•°â€œåšå‡ºååº”â€çš„æƒ…å†µä¸‹è°ƒç”¨äº‹ä»¶å¤„ç†ç¨‹åº Effect çš„æ–¹æ³•å—ï¼Ÿè¿™ä¸ªé—®é¢˜ä½ è¿Ÿæ—©è¦é‡åˆ°ï¼\"}],[\"$r\",\"p\",null,{\"children\":[\"åè€…ä»…ç”¨äºå°†æŸäº›çŠ¶æ€ä¼ é€’ç»™å¯¼å…¥çš„ API æ–¹æ³•ã€‚è¿™ä¸ªå‡½æ•°çœŸçš„æœ‰å¿…è¦å—ï¼Ÿä¼ é€’çš„åŸºæœ¬ä¿¡æ¯æ˜¯ä»€ä¹ˆï¼Ÿä½ å¯èƒ½éœ€è¦å°†ä¸€äº›å¯¼å…¥ä» \",[\"$r\",\"code\",null,{\"children\":\"App.js\"}],\" ç§»è‡³ \",[\"$r\",\"code\",null,{\"children\":\"ChatRoom.js\"}],\"ã€‚\"]}]]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"experimental\\\",\\n    \\\"react-dom\\\": \\\"experimental\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\",\\n    \\\"toastify-js\\\": \\\"1.12.0\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js\",\"children\":\"import { useState } from 'react';\\nimport ChatRoom from './ChatRoom.js';\\nimport {\\n  createEncryptedConnection,\\n  createUnencryptedConnection,\\n} from './chat.js';\\nimport { showNotification } from './notifications.js';\\n\\nexport default function App() {\\n  const [isDark, setIsDark] = useState(false);\\n  const [roomId, setRoomId] = useState('æ‰€æœ‰');\\n  const [isEncrypted, setIsEncrypted] = useState(false);\\n\\n  return (\\n    <>\\n      <label>\\n        <input\\n          type=\\\"checkbox\\\"\\n          checked={isDark}\\n          onChange={e => setIsDark(e.target.checked)}\\n        />\\n        ä½¿ç”¨æš—é»‘ä¸»é¢˜\\n      </label>\\n      <label>\\n        <input\\n          type=\\\"checkbox\\\"\\n          checked={isEncrypted}\\n          onChange={e => setIsEncrypted(e.target.checked)}\\n        />\\n        å¼€å¯åŠ å¯†åŠŸèƒ½\\n      </label>\\n      <label>\\n        é€‰æ‹©èŠå¤©å®¤ï¼š\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"æ‰€æœ‰\\\">æ‰€æœ‰</option>\\n          <option value=\\\"æ—…æ¸¸\\\">æ—…æ¸¸</option>\\n          <option value=\\\"éŸ³ä¹\\\">éŸ³ä¹</option>\\n        </select>\\n      </label>\\n      <hr />\\n      <ChatRoom\\n        roomId={roomId}\\n        onMessage={msg => {\\n          showNotification('æ–°æ¶ˆæ¯ï¼š' + msg, isDark ? 'dark' : 'light');\\n        }}\\n        createConnection={() => {\\n          const options = {\\n            serverUrl: 'https://localhost:1234',\\n            roomId: roomId\\n          };\\n          if (isEncrypted) {\\n            return createEncryptedConnection(options);\\n          } else {\\n            return createUnencryptedConnection(options);\\n          }\\n        }}\\n      />\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/ChatRoom.js active\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { experimental_useEffectEvent as useEffectEvent } from 'react';\\n\\nexport default function ChatRoom({ roomId, createConnection, onMessage }) {\\n  useEffect(() => {\\n    const connection = createConnection();\\n    connection.on('message', (msg) => onMessage(msg));\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [createConnection, onMessage]);\\n\\n  return <h1>æ¬¢è¿æ¥åˆ° {roomId} æˆ¿é—´ï¼</h1>;\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createEncryptedConnection({ serverUrl, roomId }) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  if (typeof serverUrl !== 'string') {\\n    throw Error('æœŸæœ› serverUrl æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + serverUrl);\\n  }\\n  if (typeof roomId !== 'string') {\\n    throw Error('æœŸæœ› roomId æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + roomId);\\n  }\\n  let intervalId;\\n  let messageCallback;\\n  return {\\n    connect() {\\n      console.log('âœ… ğŸ” è¿æ¥åˆ°â€œ' + roomId + 'â€æˆ¿é—´...ï¼ˆå·²åŠ å¯†ï¼‰');\\n      clearInterval(intervalId);\\n      intervalId = setInterval(() => {\\n        if (messageCallback) {\\n          if (Math.random() > 0.5) {\\n            messageCallback('hey')\\n          } else {\\n            messageCallback('lol');\\n          }\\n        }\\n      }, 3000);\\n    },\\n    disconnect() {\\n      clearInterval(intervalId);\\n      messageCallback = null;\\n      console.log('âŒ ğŸ” æ–­å¼€â€œ' + roomId + 'â€æˆ¿é—´ï¼ˆå·²åŠ å¯†ï¼‰');\\n    },\\n    on(event, callback) {\\n      if (messageCallback) {\\n        throw Error('ä¸èƒ½æ·»åŠ  handler 2æ¬¡');\\n      }\\n      if (event !== 'message') {\\n        throw Error('ä»…æ”¯æŒ \\\"message\\\" äº‹ä»¶');\\n      }\\n      messageCallback = callback;\\n    },\\n  };\\n}\\n\\nexport function createUnencryptedConnection({ serverUrl, roomId }) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  if (typeof serverUrl !== 'string') {\\n    throw Error('æœŸæœ› serverUrl æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + serverUrl);\\n  }\\n  if (typeof roomId !== 'string') {\\n    throw Error('æœŸæœ› roomId æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + roomId);\\n  }\\n  let intervalId;\\n  let messageCallback;\\n  return {\\n    connect() {\\n      console.log('âœ… è¿æ¥åˆ°â€œ' + roomId + 'â€æˆ¿é—´ï¼ˆæœªåŠ å¯†ï¼‰...');\\n      clearInterval(intervalId);\\n      intervalId = setInterval(() => {\\n        if (messageCallback) {\\n          if (Math.random() > 0.5) {\\n            messageCallback('hey')\\n          } else {\\n            messageCallback('lol');\\n          }\\n        }\\n      }, 3000);\\n    },\\n    disconnect() {\\n      clearInterval(intervalId);\\n      messageCallback = null;\\n      console.log('âŒ æ–­å¼€â€œ' + roomId + 'â€æˆ¿é—´ï¼ˆæœªåŠ å¯†ï¼‰');\\n    },\\n    on(event, callback) {\\n      if (messageCallback) {\\n        throw Error('ä¸èƒ½æ·»åŠ  handler 2æ¬¡');\\n      }\\n      if (event !== 'message') {\\n        throw Error('ä»…æ”¯æŒ \\\"message\\\" äº‹ä»¶');\\n      }\\n      messageCallback = callback;\\n    },\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/notifications.js\",\"children\":\"import Toastify from 'toastify-js';\\nimport 'toastify-js/src/toastify.css';\\n\\nexport function showNotification(message, theme) {\\n  Toastify({\\n    text: message,\\n    duration: 2000,\\n    gravity: 'top',\\n    position: 'right',\\n    style: {\\n      background: theme === 'dark' ? 'black' : 'white',\\n      color: theme === 'dark' ? 'white' : 'black',\\n    },\\n  }).showToast();\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label, button { display: block; margin-bottom: 5px; }\\n\"}]}]]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":\"è§£å†³è¿™ä¸ªé—®é¢˜çš„æ­£ç¡®æ–¹æ³•ä¸æ­¢ä¸€ç§ï¼Œä¸‹é¢è¦ä»‹ç»çš„æ˜¯ä¸€ç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆã€‚\"}],[\"$r\",\"p\",null,{\"children\":[\"åœ¨åŸå§‹ç¤ºä¾‹ä¸­ï¼Œåˆ‡æ¢ä¸»é¢˜ä¼šå¯¼è‡´åˆ›å»ºå’Œä¼ é€’ä¸åŒçš„ \",[\"$r\",\"code\",null,{\"children\":\"onMessage\"}],\" å’Œ \",[\"$r\",\"code\",null,{\"children\":\"createConnection\"}],\" å‡½æ•°ã€‚ç”±äº Effect ä¾èµ–äºè¿™äº›åŠŸèƒ½ï¼Œå› æ­¤æ¯æ¬¡åˆ‡æ¢ä¸»é¢˜æ—¶èŠå¤©éƒ½ä¼šé‡æ–°è¿æ¥ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"è¦è§£å†³ \",[\"$r\",\"code\",null,{\"children\":\"onMessage\"}],\" çš„é—®é¢˜ï¼Œä½ éœ€è¦å°†å…¶åŒ…è£…åˆ° Effect Event ä¸­ï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1,2,6}\",\"children\":\"export default function ChatRoom({ roomId, createConnection, onMessage }) {\\n  const onReceiveMessage = useEffectEvent(onMessage);\\n\\n  useEffect(() => {\\n    const connection = createConnection();\\n    connection.on('message', (msg) => onReceiveMessage(msg));\\n    // ...\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"ä¸ \",[\"$r\",\"code\",null,{\"children\":\"onMessage\"}],\" props ä¸åŒï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"onReceiveMessage\"}],\" Effect Event ä¸æ˜¯å“åº”å¼çš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä¸éœ€è¦æˆä¸º Effect çš„ä¾èµ–ã€‚å› æ­¤ï¼Œå¯¹ \",[\"$r\",\"code\",null,{\"children\":\"onMessage\"}],\" çš„æ›´æ”¹ä¸ä¼šå¯¼è‡´èŠå¤©é‡æ–°è¿æ¥ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"ä½ ä¸èƒ½å¯¹ \",[\"$r\",\"code\",null,{\"children\":\"createConnection\"}],\" åšåŒæ ·çš„äº‹æƒ…ï¼Œå› ä¸ºå®ƒ \",[\"$r\",\"strong\",null,{\"children\":\"åº”è¯¥\"}],\" æ˜¯å“åº”å¼çš„ã€‚å¦‚æœç”¨æˆ·åœ¨åŠ å¯†å’ŒæœªåŠ å¯†è¿æ¥ä¹‹é—´åˆ‡æ¢ï¼Œæˆ–è€…å¦‚æœç”¨æˆ·åˆ‡æ¢å½“å‰æˆ¿é—´ï¼Œä½  \",[\"$r\",\"strong\",null,{\"children\":\"å¸Œæœ›\"}],\" é‡æ–°è§¦å‘ Effectã€‚ä½†æ˜¯ï¼Œå› ä¸º \",[\"$r\",\"code\",null,{\"children\":\"createConnection\"}],\" æ˜¯å‡½æ•°ï¼Œä½ æ— æ³•æ£€æŸ¥å®ƒè¯»å–çš„ä¿¡æ¯æ˜¯å¦ \",[\"$r\",\"strong\",null,{\"children\":\"å®é™…\"}],\" å‘ç”Ÿäº†å˜åŒ–ã€‚è¦è§£å†³æ­¤é—®é¢˜ï¼Œè¯·ä¼ é€’åŸå§‹çš„ \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" å’Œ \",[\"$r\",\"code\",null,{\"children\":\"isEncrypted\"}],\" å€¼ï¼Œè€Œä¸æ˜¯ä» App ç»„ä»¶å‘ä¸‹ä¼ é€’ \",[\"$r\",\"code\",null,{\"children\":\"createConnection\"}],\" ï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2-3}\",\"children\":\"      <ChatRoom\\n        roomId={roomId}\\n        isEncrypted={isEncrypted}\\n        onMessage={msg => {\\n          showNotification('æ–°æ¶ˆæ¯ï¼š' + msg, isDark ? 'dark' : 'light');\\n        }}\\n      />\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"ç°åœ¨ä½ å¯ä»¥å°† \",[\"$r\",\"code\",null,{\"children\":\"createConnection\"}],\" å‡½æ•°ç§»åˆ° Effect é‡Œé¢ï¼Œè€Œä¸æ˜¯ä» \",[\"$r\",\"code\",null,{\"children\":\"App\"}],\" å‘ä¸‹ä¼ é€’å®ƒï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1-4,6,10-20}\",\"children\":\"import {\\n  createEncryptedConnection,\\n  createUnencryptedConnection,\\n} from './chat.js';\\n\\nexport default function ChatRoom({ roomId, isEncrypted, onMessage }) {\\n  const onReceiveMessage = useEffectEvent(onMessage);\\n\\n  useEffect(() => {\\n    function createConnection() {\\n      const options = {\\n        serverUrl: 'https://localhost:1234',\\n        roomId: roomId\\n      };\\n      if (isEncrypted) {\\n        return createEncryptedConnection(options);\\n      } else {\\n        return createUnencryptedConnection(options);\\n      }\\n    }\\n    // ...\\n\"}]}],[\"$r\",\"p\",null,{\"children\":\"åœ¨è¿™ä¸¤ä¸ªæ›´æ”¹ä¹‹åï¼ŒEffect ä¸å†ä¾èµ–äºä»»ä½•å‡½æ•°å€¼ï¼š\"}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1,8,10,21}\",\"children\":\"export default function ChatRoom({ roomId, isEncrypted, onMessage }) { // Reactive values\\n  const onReceiveMessage = useEffectEvent(onMessage); // Not reactive\\n\\n  useEffect(() => {\\n    function createConnection() {\\n      const options = {\\n        serverUrl: 'https://localhost:1234',\\n        roomId: roomId // è¯»å–å“åº”å¼å€¼\\n      };\\n      if (isEncrypted) { // è¯»å–å“åº”å¼å€¼\\n        return createEncryptedConnection(options);\\n      } else {\\n        return createUnencryptedConnection(options);\\n      }\\n    }\\n\\n    const connection = createConnection();\\n    connection.on('message', (msg) => onReceiveMessage(msg));\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId, isEncrypted]); // âœ… æ‰€æœ‰ä¾èµ–å·²å£°æ˜\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"å› æ­¤ï¼Œä»…å½“æœ‰æ„ä¹‰çš„å†…å®¹ï¼ˆ\",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" æˆ– \",[\"$r\",\"code\",null,{\"children\":\"isEncrypted\"}],\"ï¼‰å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒèŠå¤©æ‰ä¼šé‡æ–°è¿æ¥ï¼š\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json hidden\",\"children\":\"{\\n  \\\"dependencies\\\": {\\n    \\\"react\\\": \\\"experimental\\\",\\n    \\\"react-dom\\\": \\\"experimental\\\",\\n    \\\"react-scripts\\\": \\\"latest\\\",\\n    \\\"toastify-js\\\": \\\"1.12.0\\\"\\n  },\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"react-scripts start\\\",\\n    \\\"build\\\": \\\"react-scripts build\\\",\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\n  }\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js\",\"children\":\"import { useState } from 'react';\\nimport ChatRoom from './ChatRoom.js';\\n\\nimport { showNotification } from './notifications.js';\\n\\nexport default function App() {\\n  const [isDark, setIsDark] = useState(false);\\n  const [roomId, setRoomId] = useState('æ‰€æœ‰');\\n  const [isEncrypted, setIsEncrypted] = useState(false);\\n\\n  return (\\n    <>\\n      <label>\\n        <input\\n          type=\\\"checkbox\\\"\\n          checked={isDark}\\n          onChange={e => setIsDark(e.target.checked)}\\n        />\\n        ä½¿ç”¨æš—é»‘ä¸»é¢˜\\n      </label>\\n      <label>\\n        <input\\n          type=\\\"checkbox\\\"\\n          checked={isEncrypted}\\n          onChange={e => setIsEncrypted(e.target.checked)}\\n        />\\n        å¼€å¯åŠ å¯†åŠŸèƒ½\\n      </label>\\n      <label>\\n        é€‰æ‹©èŠå¤©å®¤ï¼š\\n        <select\\n          value={roomId}\\n          onChange={e => setRoomId(e.target.value)}\\n        >\\n          <option value=\\\"æ‰€æœ‰\\\">æ‰€æœ‰</option>\\n          <option value=\\\"æ—…æ¸¸\\\">æ—…æ¸¸</option>\\n          <option value=\\\"éŸ³ä¹\\\">éŸ³ä¹</option>\\n        </select>\\n      </label>\\n      <hr />\\n      <ChatRoom\\n        roomId={roomId}\\n        isEncrypted={isEncrypted}\\n        onMessage={msg => {\\n          showNotification('æ–°æ¶ˆæ¯ï¼š' + msg, isDark ? 'dark' : 'light');\\n        }}\\n      />\\n    </>\\n  );\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/ChatRoom.js active\",\"children\":\"import { useState, useEffect } from 'react';\\nimport { experimental_useEffectEvent as useEffectEvent } from 'react';\\nimport {\\n  createEncryptedConnection,\\n  createUnencryptedConnection,\\n} from './chat.js';\\n\\nexport default function ChatRoom({ roomId, isEncrypted, onMessage }) {\\n  const onReceiveMessage = useEffectEvent(onMessage);\\n\\n  useEffect(() => {\\n    function createConnection() {\\n      const options = {\\n        serverUrl: 'https://localhost:1234',\\n        roomId: roomId\\n      };\\n      if (isEncrypted) {\\n        return createEncryptedConnection(options);\\n      } else {\\n        return createUnencryptedConnection(options);\\n      }\\n    }\\n\\n    const connection = createConnection();\\n    connection.on('message', (msg) => onReceiveMessage(msg));\\n    connection.connect();\\n    return () => connection.disconnect();\\n  }, [roomId, isEncrypted]);\\n\\n  return <h1>æ¬¢è¿æ¥åˆ° {roomId} æˆ¿é—´ï¼</h1>;\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createEncryptedConnection({ serverUrl, roomId }) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  if (typeof serverUrl !== 'string') {\\n    throw Error('æœŸæœ› serverUrl æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + serverUrl);\\n  }\\n  if (typeof roomId !== 'string') {\\n    throw Error('æœŸæœ› roomId æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + roomId);\\n  }\\n  let intervalId;\\n  let messageCallback;\\n  return {\\n    connect() {\\n      console.log('âœ… ğŸ” è¿æ¥åˆ°â€œ' + roomId + 'â€æˆ¿é—´...ï¼ˆå·²åŠ å¯†ï¼‰');\\n      clearInterval(intervalId);\\n      intervalId = setInterval(() => {\\n        if (messageCallback) {\\n          if (Math.random() > 0.5) {\\n            messageCallback('hey')\\n          } else {\\n            messageCallback('lol');\\n          }\\n        }\\n      }, 3000);\\n    },\\n    disconnect() {\\n      clearInterval(intervalId);\\n      messageCallback = null;\\n      console.log('âŒ ğŸ” æ–­å¼€â€œ' + roomId + 'â€æˆ¿é—´ï¼ˆå·²åŠ å¯†ï¼‰');\\n    },\\n    on(event, callback) {\\n      if (messageCallback) {\\n        throw Error('ä¸èƒ½æ·»åŠ  handler 2æ¬¡');\\n      }\\n      if (event !== 'message') {\\n        throw Error('ä»…æ”¯æŒ \\\"message\\\" äº‹ä»¶');\\n      }\\n      messageCallback = callback;\\n    },\\n  };\\n}\\n\\nexport function createUnencryptedConnection({ serverUrl, roomId }) {\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\n  if (typeof serverUrl !== 'string') {\\n    throw Error('æœŸæœ› serverUrl æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + serverUrl);\\n  }\\n  if (typeof roomId !== 'string') {\\n    throw Error('æœŸæœ› roomId æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ”¶åˆ°ï¼š' + roomId);\\n  }\\n  let intervalId;\\n  let messageCallback;\\n  return {\\n    connect() {\\n      console.log('âœ… è¿æ¥åˆ°â€œ' + roomId + 'â€æˆ¿é—´ï¼ˆæœªåŠ å¯†ï¼‰...');\\n      clearInterval(intervalId);\\n      intervalId = setInterval(() => {\\n        if (messageCallback) {\\n          if (Math.random() > 0.5) {\\n            messageCallback('hey')\\n          } else {\\n            messageCallback('lol');\\n          }\\n        }\\n      }, 3000);\\n    },\\n    disconnect() {\\n      clearInterval(intervalId);\\n      messageCallback = null;\\n      console.log('âŒ æ–­å¼€â€œ' + roomId + 'â€æˆ¿é—´ï¼ˆæœªåŠ å¯†ï¼‰');\\n    },\\n    on(event, callback) {\\n      if (messageCallback) {\\n        throw Error('ä¸èƒ½æ·»åŠ  handler 2æ¬¡');\\n      }\\n      if (event !== 'message') {\\n        throw Error('ä»…æ”¯æŒ \\\"message\\\" äº‹ä»¶');\\n      }\\n      messageCallback = callback;\\n    },\\n  };\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/notifications.js\",\"children\":\"import Toastify from 'toastify-js';\\nimport 'toastify-js/src/toastify.css';\\n\\nexport function showNotification(message, theme) {\\n  Toastify({\\n    text: message,\\n    duration: 2000,\\n    gravity: 'top',\\n    position: 'right',\\n    style: {\\n      background: theme === 'dark' ? 'black' : 'white',\\n      color: theme === 'dark' ? 'white' : 'black',\\n    },\\n  }).showToast();\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label, button { display: block; margin-bottom: 5px; }\\n\"}]}]]}]]}]]}],[\"$r\",\"MaxWidth\",\"last\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"è¯‘æ³¨\"}],\"ï¼š\\n\",[\"$r\",\"a\",null,{\"name\":\"note1\"}],\" åœ¨åˆ›å»º \",[\"$r\",\"code\",null,{\"children\":\"onTick\"}],\" å‡½æ•°æ—¶ï¼Œç”±äºé—­åŒ…çš„ç¼˜æ•…ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"setCount(count + increment)\"}],\" æ•è·çš„æ˜¯åˆ›å»ºæ—¶ \",[\"$r\",\"code\",null,{\"children\":\"count\"}],\" å’Œ \",[\"$r\",\"code\",null,{\"children\":\"increment\"}],\" å€¼ã€‚ç”±äºè¿™é‡Œçš„â€œè¯´è°â€ï¼Œæ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶æ–°åˆ›å»ºçš„ \",[\"$r\",\"code\",null,{\"children\":\"onTick\"}],\" å‡½æ•°ä¸èƒ½æ›¿æ¢æ‰ Effect é‡Œæ—§ \",[\"$r\",\"code\",null,{\"children\":\"onTick\"}],\" å‡½æ•°ï¼Œäºæ˜¯æœ€ç»ˆçš„æ•ˆæœå°±æ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"setCount(0 + 1)\"}],\" \",[\"$r\",\"br\",null,{}]]}]]}]]","meta":{"title":"ç§»é™¤ Effect ä¾èµ–"}},"__N_SSG":true}